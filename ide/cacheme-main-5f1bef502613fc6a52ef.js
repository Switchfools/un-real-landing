!function(e){function t(t){for(var i,a,r=t[0],c=t[1],l=t[2],h=0,p=[];h<r.length;h++)a=r[h],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&p.push(s[a][0]),s[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(d&&d(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},s={5:0},o=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(e){var t=[],n=s[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,i){n=s[e]=[t,i]}));t.push(n[2]=i);var o,r=document.createElement("script");r.charset="utf-8",r.timeout=120,a.nc&&r.setAttribute("nonce",a.nc),r.src=function(e){return a.p+"cacheme-"+{24:"06d8aa86aae89d0ac261"}[e]+".js"}(e);var c=new Error;o=function(t){r.onerror=r.onload=null,clearTimeout(l);var n=s[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",c.name="ChunkLoadError",c.type=i,c.request=o,n[1](c)}s[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:r})}),12e4);r.onerror=r.onload=o,document.head.appendChild(r)}return Promise.all(t)},a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/ide/",a.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=c;o.push([237,21,6,2,20,12,17,23,14,9,16,1,0,19,13,22,18,8,7,4,10,3,15,11]),n()}({11:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.routes=void 0;const i=n(568),s=n(569);t.routes={default:"/ide",menu:"/ide/menu",apps:"/ide/menu/apps",createApp:"/ide/menu/apps/new",updateApp:"/ide/menu/apps/:appId/update",deleteApp:"/ide/menu/apps/:appId/delete",profile:"/ide/menu/profile",changeEmail:"/ide/menu/profile/email",billing:"/ide/menu/billing",signup:"/ide/signup",confirmEmail:"/ide/confirm",confirmEmailUpdate:"/ide/"+s.UPDATE_EMAIL_PATH_SEGMENT,resetPassword:"/ide/"+i.RESET_PASSWORD_PATH_SEGMENT,infrastructure:"/ide/infrastructure",infrastructureDomains:"/ide/infrastructure/domains",infrastructureSQLDatabase:"/ide/infrastructure/sqldb",infrastructureMonitoring:"/ide/infrastructure/monitoring",infrastructureEnvironmentVariables:"/ide/infrastructure/env",infrastructureSQLite:"/ide/infrastructure/sqlite"}},120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateFileModal=void 0;const i=n(15),s=n(6),o=n(121),a=n(48);class r extends o.FileTreeModal{constructor(e,t){super("Create new file",t,async t=>!i.isEmpty(t)&&e.createFile({appId:await s.UserSession.getInstance().getActiveAppId(),isDirectory:!1,path:t}).then(a.alertIfError))}}t.CreateFileModal=r},121:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.FileTreeModal=void 0;const o=n(4),a=n(3),r=n(0),c=n(7);n(563);let l=class extends a.HtmlComponent{constructor(e,t,n){super(),this.classAttr="keybindable file-tree-modal",this.htmlContent=`\n           <div class="modal">\n                <div class='close'>${c.Icon.Close}</div>\n                <div class="file-tree-form">\n                    <input class="filename-input" type="text" required>\n                    <button class="ok-button" type="submit">${e}</button>\n                </div>\n           </div>\n        `,this.action=n,this.defaultPath=t}async destroy(e){r.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),r.has(this.clickListener)&&document.removeEventListener("click",this.clickListener),await super.destroy(e)}async afterEveryRender(){await super.afterEveryRender(),this.keyUpListener=e=>{"Enter"===e.key?(e.preventDefault(),this.findInScope(".ok-button").click()):"Escape"===e.key&&(e.preventDefault(),this.destroy(!0))},document.addEventListener("keyup",this.keyUpListener);const e=this.findInScope(".filename-input");e.focus(),e.value=this.defaultPath,this.findInScope(".ok-button").addEventListener("click",()=>{this.action(e.value),this.destroy(!0)}),this.findInScope(".close").addEventListener("click",()=>this.hide()),this.clickListener=e=>{this.findInScope(".file-tree-form").contains(e.target)||(e.stopPropagation(),this.destroy(!0))},document.addEventListener("click",this.clickListener)}};l=i([o.injectable(),s("design:paramtypes",[String,String,Function])],l),t.FileTreeModal=l},123:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateDirectoryModal=void 0;const i=n(15),s=n(6),o=n(121),a=n(48);class r extends o.FileTreeModal{constructor(e,t){super("Create new directory",t,async t=>!i.isEmpty(t)&&e.createFile({appId:await s.UserSession.getInstance().getActiveAppId(),isDirectory:!0,path:t}).then(a.alertIfError))}}t.CreateDirectoryModal=r},124:function(e,t,n){"use strict";var i,s,o,a=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuTopbar=void 0;const l=n(3),d=n(10),h=n(4),p=n(45),u=n(6),m=n(11),f=n(5);n(570);let v=class extends l.HtmlComponent{constructor(e,t,n){super(),this.htmlContent='\n        <h1 class="my-apps hidden">\n            <span class="title clickable-label">My Apps</span>\n            <span class="separator hidden">/</span>\n            <span class="second-path-item hidden"></span>\n        </h1>\n        <h1 class="my-profile hidden">\n            <span class="title clickable-label">My Profile</span>\n            <span class="separator hidden">/</span>\n            <span class="second-path-item hidden"></span>\n        </h1>\n        <div class="user-balance-container hidden" hidden>\n            <span id="user-balance-label">Your balance:</span>\n            <span id="user-balance"></span>\n        </div>\n        <div class="button-container hidden">\n            <div class="new-app-button-container">\n                <button class="button-medium button-light" id="new-app-button">\n                    New app +\n                </button>\n            </div>\n        </div>\n    ',this.classAttr="menu-topbar",this.router=e,this.routes=t,this.paymentService=n,this.hide(),this.loadData()}togglePath(e){const t=this.findInScope(".my-apps"),n=this.findInScope(".my-apps > .separator"),i=this.findInScope(".my-apps > .second-path-item"),s=this.findInScope(".my-profile"),o=this.findInScope(".my-profile > .separator"),a=this.findInScope(".my-profile > .second-path-item"),r=this.findInScope(".user-balance-container"),c=this.findInScope(".button-container");switch(this.setNewAppButtonDisabled(!1),e){case"new":this.setNewAppButtonDisabled(!0),t.classList.remove("hidden"),n.classList.remove("hidden"),i.classList.remove("hidden"),i.innerText="New",s.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),r.classList.remove("hidden"),c.classList.remove("hidden");break;case"update":t.classList.remove("hidden"),n.classList.remove("hidden"),i.classList.remove("hidden"),i.innerText="Update",s.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),r.classList.remove("hidden"),c.classList.remove("hidden");break;case"delete":t.classList.remove("hidden"),n.classList.remove("hidden"),i.classList.remove("hidden"),i.innerText="Delete",s.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),r.classList.remove("hidden"),c.classList.remove("hidden");break;case"profile":t.classList.add("hidden"),n.classList.add("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),r.classList.add("hidden"),c.classList.add("hidden");break;case"email":t.classList.add("hidden"),n.classList.add("hidden"),i.classList.add("hidden"),s.classList.remove("hidden"),o.classList.remove("hidden"),a.classList.remove("hidden"),a.innerText="Email",r.classList.add("hidden"),c.classList.add("hidden");break;case"apps":default:t.classList.remove("hidden"),n.classList.add("hidden"),i.classList.add("hidden"),s.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),r.classList.remove("hidden"),c.classList.remove("hidden")}}async afterEveryRender(){const e=this.findInScope("#new-app-button"),t=this.findInScope(".my-apps .title.clickable-label"),n=this.findInScope(".my-profile .title.clickable-label");e.onclick=async()=>this.router.setUrl(this.routes.createApp),t.onclick=()=>this.router.setUrl(this.routes.apps),n.onclick=()=>this.router.setUrl(this.routes.profile)}setNewAppButtonDisabled(e){this.findInScope("#new-app-button").disabled=e}async loadData(){await u.UserSession.getInstance().getAuthentication();const e=(await this.paymentService.getCustomer()).getValue();if(e.balance<0&&(this.creditBalance=-e.balance),this.creditBalance>0){this.findInScope("#user-balance").innerHTML="$"+this.creditBalance/100;this.findInScope(".user-balance-container").hidden=!1}}};v=a([h.injectable(),c(0,h.inject(f.injectableTypes.Router)),c(1,h.inject(f.injectableTypes.Routes)),c(2,h.inject(f.injectableTypes.PaymentServiceStub)),r("design:paramtypes",["function"==typeof(i=void 0!==d.Router&&d.Router)?i:Object,"function"==typeof(s=void 0!==m.Routes&&m.Routes)?s:Object,"function"==typeof(o=void 0!==p.PaymentServiceStub&&p.PaymentServiceStub)?o:Object])],v),t.MenuTopbar=v},125:function(e,t,n){"use strict";var i,s,o,a,r,c=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserProfileComponent=void 0;const h=n(3),p=n(4),u=n(0),m=n(10),f=n(23),v=n(16),b=n(572),y=n(6),g=n(11),S=n(126),w=n(129),C=n(5);n(581);const I={facebook:"Facebook",github:"GitHub",google:"Google"};let T=class extends h.HtmlComponent{constructor(e,t,n,i,s){super(),this.htmlContent='\n        <form class=\'input-form\'>\n            <div class="inner-container">\n                <div class="input-container">\n                    <div class="profile">\n                        <span class="profile-letter"></span>\n                    </div>\n                    <div>\n                        <label for="first-name">First Name</label><br>\n                        <input\n                            id="first-name"\n                            type="text"\n                            placeholder="John"\n                        />\n                    </div>\n                    <div>\n                        <label for="last-name">Last Name</label><br>\n                        <input\n                            id="last-name"\n                            type="text"\n                            placeholder="Smith"\n                        />\n                    </div>\n                    <div class="input-button-container email-container" hidden>\n                        <label for="change-email">Email</label><br>\n                        <div class="text-button-container">\n                            <div id="email" class="text">example@email.com</div>\n                            <button type="button" class="button-change-email">Change</button>\n                        </div>\n                    </div>\n                    <div class="oauth-email-container" hidden>\n                        <label for="oauth-email">OAuth email from <span id="oauth-provider"></span></label><br>\n                        <input\n                            id="oauth-email"\n                            type="email"\n                            placeholder="example@email.com"\n                            disabled\n                        />\n                    </div>\n                    <p class="error error-commit hidden"></p>\n                </div>\n                <div class="button-container">\n                    <button type="button" class="button-medium button-secondary button-reset" disabled>Reset</button>\n                    <button type="button" class="button-medium button-primary button-update" disabled>Update</button>\n                </div>\n            </div>\n        </form>\n        ',this.classAttr="user-profile-component",this.firstName="",this.lastName="",this.router=e,this.routes=t,this.ideService=n,this.authService=i,this.signinComponent=s,this.loadingAnimationComponent=new w.LoadingAnimationComponent,this.hide()}onProfileUpdated(e){this.profileUpdateListener=e}async onUpdate(){if(this.hideErrors(),this.loadingAnimationComponent.show(),this.firstName&&this.lastName){const e=await this.authService.updateProfile({firstName:this.firstName,lastName:this.lastName});e.notOk()?this.showError(e.getErrorMessage()):await this.syncForm()}this.loadingAnimationComponent.hide()}async afterEveryRender(){await this.loadingAnimationComponent.renderTo(this.getRootElement());const e=this.findInScope("#first-name"),t=this.findInScope("#last-name");e.oninput=async()=>this.updateForm({firstName:e.value}),t.oninput=async()=>this.updateForm({lastName:t.value}),this.findInScope(".button-update").addEventListener("click",e=>{e.stopPropagation(),this.onUpdate()}),this.findInScope(".button-reset").addEventListener("click",e=>{e.stopPropagation(),this.syncForm()}),this.findInScope(".button-change-email").addEventListener("click",e=>{e.stopPropagation(),this.router.setUrl(this.routes.changeEmail)}),this.signinComponent.onAuthenticated(async()=>{await this.syncForm(),this.loadingAnimationComponent.hide()}),await this.syncForm(),this.loadingAnimationComponent.hide()}async syncForm(){var e,t,n;this.loadingAnimationComponent.show(),await y.UserSession.getInstance().getAuthentication();const i=(await this.authService.getUser()).getValue(),s=(await this.ideService.getUserPreferences()).getValue();this.findInScope(".profile-letter").innerHTML=(null!==(e=i.firstName)&&void 0!==e?e:i.email)[0].toUpperCase();this.findInScope(".profile").style.backgroundColor=s.profileColor;if("password"===i.authenticationMethod){this.findInScope(".email-container").hidden=!1;this.findInScope("#email").innerText=i.email}if(b.ALL_OAUTH_PROVIDER_ID.includes(i.authenticationMethod)){this.findInScope(".oauth-email-container").hidden=!1;this.findInScope("#oauth-email").value=i.email;this.findInScope("#oauth-provider").innerText=I[i.authenticationMethod]}const o=this.findInScope("#first-name"),a=this.findInScope("#last-name");o.value=null!==(t=i.firstName)&&void 0!==t?t:"",a.value=null!==(n=i.lastName)&&void 0!==n?n:"",await this.updateForm(i),this.findInScope(".button-update").disabled=!0,this.findInScope(".button-reset").disabled=!0,u.has(this.profileUpdateListener)&&this.profileUpdateListener()}async updateForm({firstName:e,lastName:t}){u.has(e)&&(this.firstName=e.trim()),u.has(t)&&(this.lastName=t.trim());const n=!(this.firstName&&this.lastName);this.findInScope(".button-update").disabled=n,this.findInScope(".button-reset").disabled=n}showError(e){const t=this.findInScope(".error-commit");t.innerHTML="Error: "+e,t.classList.remove("hidden")}hideErrors(){this.findInScope(".error-commit").classList.add("hidden")}};T=c([p.injectable(),d(0,p.inject(C.injectableTypes.Router)),d(1,p.inject(C.injectableTypes.Routes)),d(2,p.inject(C.injectableTypes.IdeServiceStub)),d(3,p.inject(C.injectableTypes.AuthServiceStub)),d(4,p.inject(C.injectableTypes.SigninComponent)),l("design:paramtypes",["function"==typeof(i=void 0!==m.Router&&m.Router)?i:Object,"function"==typeof(s=void 0!==g.Routes&&g.Routes)?s:Object,"function"==typeof(o=void 0!==v.IdeServiceStub&&v.IdeServiceStub)?o:Object,"function"==typeof(a=void 0!==f.AuthServiceStub&&f.AuthServiceStub)?a:Object,"function"==typeof(r=void 0!==S.SigninComponent&&S.SigninComponent)?r:Object])],T),t.UserProfileComponent=T},128:function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserConfigProvider=void 0;const r=n(4),c=n(16),l=n(5);let d=class{constructor(e){this.browserConfig=e.getConfig().then(e=>e.getValue())}get(){return this.browserConfig}};d=s([r.injectable(),a(0,r.inject(l.injectableTypes.IdeServiceStub)),o("design:paramtypes",["function"==typeof(i=void 0!==c.IdeServiceStub&&c.IdeServiceStub)?i:Object])],d),t.BrowserConfigProvider=d},129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingAnimationComponent=void 0;const i=n(3),s=n(130);n(579);class o extends i.HtmlComponent{constructor(){super(),this.htmlContent=`<div>${s.Animation.Ripple}</div>`,this.classAttr="loading-animation",this.hide()}async renderTo(e,t){return e.style.position="relative",super.renderTo(e,t)}async afterEveryRender(){await super.afterEveryRender(),this.getRootElement().addEventListener("click",e=>{e.stopPropagation(),e.stopImmediatePropagation()})}}t.LoadingAnimationComponent=o},130:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Animation=void 0;const s=i(n(578));!function(e){e[e.Ripple=s.default]="Ripple"}(t.Animation||(t.Animation={}))},132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InnerDropdownMenu=t.DropdownMenu=t.removeAllChildrenFromNode=void 0;const i=n(3),s=n(0);function o(e){for(;e.lastChild;)e.removeChild(e.lastChild)}n(588),t.removeAllChildrenFromNode=o;class a extends i.HtmlComponent{constructor(e,t){super(),this.entries=[],this.innerDropdownMenus=[],this.enabled=!0,this.htmlContent=`\n            <div class="toggle-dropdown">\n                ${this.buildContent(e.icon,e.text,e.description)}\n            </div>\n            <div class="dropdown-menu"></div>\n        `,this.classAttr=s.has(t)?t:"dropdown"}addEntryGroup(...e){return this.entries=this.entries.concat(e),e.filter(e=>s.has(e.dropdownMenu)).forEach(e=>{this.innerDropdownMenus.push(e.dropdownMenu)}),this}async destroy(){await super.destroy(),document.removeEventListener("click",this.clickAwayListener.bind(this))}toggleExpandCollapse(e){e.stopPropagation();const t=!this.dropdownMenuElement.classList.contains("expanded"),n=document.getElementsByClassName("dropdown-menu");Array.from(n).forEach(e=>{e.classList.remove("expanded"),this.closeDropdownMenu(e)}),t&&this.enabled&&(this.entries.forEach(async e=>this.dropdownMenuElement.appendChild(await this.renderEntry(e))),this.dropdownMenuElement.classList.add("expanded"))}enable(){this.findInScope(".toggle-dropdown").classList.remove("disabled"),this.enabled=!0}disable(){this.findInScope(".toggle-dropdown").classList.add("disabled"),this.enabled=!1}async afterEveryRender(){await super.afterEveryRender(),this.dropdownMenuElement=this.findInScope(".dropdown-menu"),this.findInScope(".toggle-dropdown").onclick=e=>this.toggleExpandCollapse(e),document.addEventListener("click",this.clickAwayListener.bind(this))}buildContent(e="&nbsp",t="",n=""){return`<div class="icon-container">${e}</div>\n                <span class="text">${t}</span>\n                <span class="description">${n}</span>`}expand(e){e.stopPropagation(),this.dropdownMenuElement.classList.contains("expanded")||(this.entries.forEach(async e=>this.dropdownMenuElement.appendChild(await this.renderEntry(e))),this.dropdownMenuElement.classList.add("expanded"))}collapse(e){e.stopPropagation(),this.dropdownMenuElement.classList.contains("expanded")&&(this.closeDropdownMenu(this.dropdownMenuElement),this.dropdownMenuElement.classList.remove("expanded"))}async renderEntry(e){const t=document.createElement("li");return s.has(e.uiAction)?(t.innerHTML=this.buildContent(e.uiAction.icon,e.uiAction.text,e.uiAction.description),t.addEventListener("click",async t=>{t.stopPropagation(),await e.uiAction.performAction()}),t.onmouseenter=e=>{this.innerDropdownMenus.forEach(t=>t.collapse(e))},t):(t.onmouseenter=t=>{this.innerDropdownMenus.forEach(e=>e.collapse(t)),e.dropdownMenu.expand(t)},await e.dropdownMenu.renderTo(t),t)}closeDropdownMenu(e){this.innerDropdownMenus.forEach(e=>e.destroy()),o(e)}clickAwayListener(){this.dropdownMenuElement.classList.remove("expanded"),this.closeDropdownMenu(this.dropdownMenuElement)}}t.DropdownMenu=a;t.InnerDropdownMenu=class extends a{constructor(e){super(e),this.htmlContent=`\n            <div class="toggle-dropdown">\n                ${this.buildContent(e.icon,e.text,e.description)} \n                <span class="dropdown-direction">></span>\n            </div>\n            <div class="dropdown-menu"></div>\n        `,this.classAttr="inner-dropdown"}async afterEveryRender(){await super.afterEveryRender(),this.dropdownMenuElement=this.findInScope(".dropdown-menu")}}},133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearMenuSession=t.retrieveMenuSession=t.saveMenuSession=void 0;const i=n(0);t.saveMenuSession=function(e){const t={pathname:location.pathname,data:e};localStorage.setItem("menuSession",JSON.stringify(t))},t.retrieveMenuSession=function(){const e=localStorage.getItem("menuSession");return i.has(e)?JSON.parse(e):null},t.clearMenuSession=function(){localStorage.removeItem("menuSession")}},134:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.KeybindingModal=void 0;const s=n(4),o=n(3),a=n(0),r=n(7);n(641);let c=class extends o.HtmlComponent{constructor(){super(...arguments),this.htmlContent=`\n        <div class="modal keybinding-container">\n            <div class="close-button-container">\n                <div class="icon close">\n                    ${r.Icon.Close}\n                </div>\n            </div>\n            <h1>Keybindings</h1>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Shift</span> + <span>H</span>\n                </div>\n                <div class="column">\n                    <div class="description">Help</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Shift</span> + <span>S</span>\n                </div>\n                <div class="column">\n                    <div class="description">Open Settings</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Shift</span> + <span>K</span>\n                </div>\n                <div class="column">\n                    <div class="description">Open Keybindings</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>M</span>\n                </div>\n                <div class="column">\n                    <div class="description">New File</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>B</span>\n                </div>\n                <div class="column">\n                    <div class="description">New Directory</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Q</span>\n                </div>\n                <div class="column">\n                    <div class="description">Close Editor Tab</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Right Arrow</span>\n                </div>\n                <div class="column">\n                    <div class="description">Select next Tab</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>Left Arrow</span>\n                </div>\n                <div class="column">\n                    <div class="description">Select previous Tab</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Double Shift</span>\n                </div>\n                <div class="column">\n                    <div class="description">Search Everywhere</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Alt</span> + <span>T</span>\n                </div>\n                <div class="column">\n                    <div class="description">Open/Close Terminal</div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <span>Ctrl</span> + <span>/</span>\n                </div>\n                <div class="column">\n                    <div class="description">Comment/Uncomment Code</div>\n                </div>\n            </div>\n            <div class="button-container">\n                <button class="ok">Ok</button>\n            </div>\n        </div>\n    `,this.classAttr="keybindable keybinding-modal"}async destroy(e){a.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),a.has(this.clickListener)&&document.removeEventListener("click",this.clickListener),await super.destroy(e)}async afterEveryRender(){await super.afterEveryRender();const e=this.findInScope(".close"),t=this.findInScope(".ok");e.onclick=()=>this.destroy(),t.onclick=()=>this.destroy(),this.keyUpListener=e=>{"Escape"===e.key&&(e.stopPropagation(),this.destroy(!0))},document.addEventListener("keyup",this.keyUpListener),this.clickListener=e=>{this.findInScope(".keybinding-container").contains(e.target)||(e.stopPropagation(),this.destroy(!0))},document.addEventListener("click",this.clickListener)}};c=i([s.injectable()],c),t.KeybindingModal=c},137:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.formatPercentage=t.adjustTimestampToTimezone=t.ResourceChart=void 0;const s=i(n(136)),o=n(0),a=n(37),r=n(67),c=n(135),l=n(702),d=n(704),h=n(225);class p extends s.default.Chart{constructor(e,t){const n=d.baseOptions;Object.assign(n,{title:u(t)}),Object.assign(n,{yAxis:m(t)}),Object.assign(n,{tooltip:f(t)}),super(e,n)}updateSeries(e,t){this.showXAxis(!0),r.forEachProperty(e,t=>{const n=this.getSeriesByName(t);o.has(n)?n.setData(e[t]):this.addResourceSeries(t,e[t])}),this.update({xAxis:{min:t}}),this.zoomOut(),this.tooltip.destroy()}setZoomEventHandler(e){s.default.addEvent(this,"selection",t=>{if(!o.has(t.xAxis))return;const n=this.getZoomIntervalBounds(t);if(o.has(n))return e(n),!0;t.preventDefault()})}setLoadingMode(e){e?this.showLoading("Loading"):this.hideLoading(),this.enableInteraction(!e)}hideWholeContentExceptTitle(){this.removeAllSeries(),this.showXAxis(!1)}removeAllSeries(){for(;this.series.length>0;)this.series[0].remove()}addResourceSeries(e,t){this.addSeries({type:"line",data:t,name:e,visible:"limit"!==e,marker:{radius:0},animation:!1})}enableInteraction(e){this.update({chart:{zoomType:e?"x":void 0},tooltip:{enabled:e}})}getZoomIntervalBounds(e){if(!((e.xAxis[0].max-e.xAxis[0].min)/1e3>15))return;const t=Date.now(),n=e.xAxis[0].max,i=n>t?t:n;return{start:Math.floor(e.xAxis[0].min/1e3),end:Math.floor(i/1e3)}}showXAxis(e){this.update({xAxis:{visible:e}})}getSeriesByName(e){for(const t of this.series)if(t.name===e)return t}}t.ResourceChart=p;const u=e=>({text:h.RESOURCE_MAP[e].displayName}),m=e=>{const n={min:0,title:void 0};return h.RESOURCE_MAP[e].format===h.UnitFormat.Bytes?n.labels={formatter:function(){return c.formatBytes(this.value)}}:(n.labels={formatter:function(){return t.formatPercentage(this.value,0)}},n.minTickInterval=.01),n},f=e=>{const t={shared:!0,useHTML:!0,formatter:function(){if(!o.has(this.points))return"";const t=new l.MonitoringTooltip(this.x,e,.01);for(const e of this.points)t.addMetricEntry(e);return t.serialize()}};return t};t.adjustTimestampToTimezone=e=>e-new Date(e).getTimezoneOffset()*a.milliSecondsInAMinute,t.formatPercentage=(e,t=2,n)=>{const i=100*e;return o.has(n)&&i<=n?"0%":i.toFixed(t)+"%"}},138:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSearchInput=void 0;const o=n(3),a=n(0),r=n(4),c=n(15),l=n(718),d=n(7),h=l.toSet(["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","Escape","Enter","Shift","Control","Alt","Pause","CapsLock","End","Home","PageUp","PageDown"]);let p=class extends o.HtmlComponent{constructor(){super(),this.htmlContent=`\n        <input\n            id="code-search"\n            type="search"\n            placeholder="Search everywhere"\n            autocomplete="off"\n            readonly onfocus="this.removeAttribute('readonly');"\n        >\n        <div class="icon icon-search">\n            ${d.Icon.Search}\n        </div>\n    `,this.classAttr="search-input-container",this.searchQuery="",this.searchOnChange=!1}clear(){this.setQuery("",!1)}setQuery(e,t=!0){return this.searchQuery=e,a.has(this.searchInputElement)&&(this.searchInputElement.value=e,t&&this.searchInputElement.focus()),this}setSearchOnChange(e=!1){return this.searchOnChange=e,this}async afterEveryRender(){this.searchInputElement=this.findInScope("input"),this.searchInputElement.oninput=async()=>{this.searchQuery=this.searchInputElement.value},this.searchInputElement.onkeyup=async e=>{var t,n;return!c.isEmpty(null===(t=this.searchInputElement)||void 0===t?void 0:t.value)&&this.searchOnChange&&(n=e.key,!a.has(h[n]))&&a.has(this.showSearchResultListener)&&this.showSearchResultListener(this.searchQuery)}}setSearchListener(e){return this.showSearchResultListener=e,this}getSearchQuery(){return this.searchQuery}focusCodeSearchInputField(){this.findInScope("#code-search").focus()}};p=i([r.injectable(),s("design:paramtypes",[])],p),t.CodeSearchInput=p},139:function(e,t,n){"use strict";var i,s,o,a,r,c=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CodeSearchModal=void 0;const h=n(3),p=n(70),u=n(4),m=n(213),f=n(15),v=n(55),b=n(0),y=n(16),g=n(719),S=n(720),w=n(6),C=n(5),I=n(20),T=n(49),E=n(721),R=n(722),P=n(138);n(724);let j=class extends h.HtmlComponent{constructor(e,t,n,i,s){super(),this.htmlContent='\n        <div class="modal">\n            <div class="header">\n                <div class=\'row-modal\'></div>\n                <div class="checkboxes">\n                    <div class="selector">\n                       <input type="checkbox" id="file-name-checkbox" checked="checked"/>\n                       <label for="file-name-checkbox">Files</label>\n                    </div>\n                    <div class="selector">\n                        <input type="checkbox" id="file-content-checkbox" checked="checked"/>\n                        <label for="file-content-checkbox">Code</label>\n                    </div>\n                </div>\n                <div class="row-padding">\n                    <div>\n                        <span class="total-results"></span> Results in <span class="total-files"></span> files found for\n                        <span class="search-query"></span>\n                    </div>\n                    <div class="row-modal">\n                        <div class="ce-button collapse">Collapse All</div>\n                        <div class="ce-button expand">Expand All</div>\n                    </div>\n                </div>\n            </div>\n            <div class="content">\n                <div class="separator" id="file-name-separator">FILES</div>\n                <div class="search-results-container" id="file-name-container"></div>\n                <div class="separator" id="file-content-separator">FOUND IN FILES</div>\n                <div class="search-results-container" id="file-content-container"></div>\n            </div>\n        </div>\n    ',this.classAttr="search-everywhere-modal hidden",this.allResults=[],this.allFileContentGroups=[],this.firstIndexFileContentGroups=[],this.currentItemIndex=0,this.arrowKeyPressActions={arrowup:()=>this.selectSearchReply(Math.max(0,this.currentItemIndex-1)),arrowdown:()=>this.selectSearchReply(Math.min(this.allResults.length-1,this.currentItemIndex+1))},this.keyDownListener=e=>{["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),this.arrowKeyPressActions[e.key.toLowerCase()]())},this.keyUpListener=e=>{"Escape"===e.key&&(e.preventDefault(),this.hide())},this.ideService=e,this.editorPanel=n,this.codeSearchInput=t.setSearchOnChange(!0),this.userSession=i,this.mainMenu=s}hide(){!f.isEmpty(this.allResults)&&this.allResults[this.currentItemIndex].setActive(!1),super.hide()}show(){w.UserSession.logActivity(S.useSearch),super.show()}destroy(e){return document.removeEventListener("click",this.hide.bind(this)),document.removeEventListener("keyup",this.keyUpListener.bind(this)),document.removeEventListener("keydown",this.keyDownListener.bind(this)),super.destroy(e)}setQuery(e){return this.codeSearchInput.setQuery(e),this.isRendered()&&this.fetchResultsAndRenderDebounced(),this}async afterEveryRender(){this.findAllHtmlElements(),this.addEventListenersAfterRender(),this.codeSearchInput.setSearchListener(this.setQuery.bind(this)).renderTo(".row-modal",p.RenderLocation.IntoBeginning),this.fetchResultsAndRenderDebounced(),this.userSession.getAuthentication().then(()=>this.openSearchModalListener())}isMainMenuVisible(){return this.mainMenu.isVisible()}openSearchModalListener(){let e=0;document.addEventListener("keyup",t=>{if(!this.isMainMenuVisible()){if("Shift"===t.key&&e++,e>=2){const e=document.querySelector(".keybindable");b.has(e)&&e.remove(),this.show(),this.codeSearchInput.focusCodeSearchInputField()}setTimeout(()=>e=0,200)}})}findAllHtmlElements(){this.fileNameCheckbox=this.findInScope("#file-name-checkbox"),this.fileContentCheckbox=this.findInScope("#file-content-checkbox"),this.fileNameSeparator=this.findInScope("#file-name-separator"),this.fileContentSeparator=this.findInScope("#file-content-separator"),this.totalResults=this.findInScope(".total-results"),this.totalFiles=this.findInScope(".total-files"),this.searchQuery=this.findInScope(".search-query"),this.fileNameResultsContainer=this.findInScope("#file-name-container"),this.fileContentResultsContainer=this.findInScope("#file-content-container")}addEventListenersAfterRender(){this.findInScope(".modal").addEventListener("click",e=>e.stopPropagation()),document.addEventListener("keyup",this.keyUpListener.bind(this)),document.addEventListener("keydown",this.keyDownListener.bind(this)),document.addEventListener("click",this.hide.bind(this)),this.findInScope(".collapse").addEventListener("click",()=>this.allFileContentGroups.forEach(e=>e.collapse())),this.findInScope(".expand").addEventListener("click",()=>this.allFileContentGroups.forEach(e=>e.expand())),[this.fileContentCheckbox,this.fileNameCheckbox].forEach(e=>e.addEventListener("click",this.fetchResultsAndRenderDebounced.bind(this))),this.fileNameCheckbox.addEventListener("change",()=>{this.fileNameCheckbox.checked?this.fileNameSeparator.style.display="block":this.fileNameSeparator.style.display="none"}),this.fileContentCheckbox.addEventListener("change",()=>{this.fileContentCheckbox.checked?this.fileContentSeparator.style.display="block":this.fileContentSeparator.style.display="none"})}async fetchResultsAndRenderDebounced(){f.isEmpty(this.codeSearchInput.getSearchQuery())||(this.adjustHeight(),this.setLoading(),m.debounce(this.fetchResultsAndRender.bind(this),50)())}async fetchResultsAndRender(){const{fileContentResults:e,filePathResults:t}=await this.fetchResults();this.allResults.forEach(e=>e.destroy()),this.allResults=[],this.allFileContentGroups.forEach(e=>e.destroy()),this.allFileContentGroups=[],this.firstIndexFileContentGroups=[],this.fileNameResultsContainer.innerHTML="",await Promise.all(t.map(e=>R.SearchResult.createFileNameSearchResult(e,this.codeSearchInput.getSearchQuery(),this.editorPanel).setParent(this).renderTo(this.fileNameResultsContainer,p.RenderLocation.IntoEnd))).then(e=>{this.allResults.push(...e),this.firstIndexFileContentGroups.push(e.length)});const n=Object.keys(e);await Promise.all(n.map(async t=>{const n=await new E.FileContentGroup(t,e[t].length).renderTo(this.fileContentResultsContainer,p.RenderLocation.IntoEnd);return this.allFileContentGroups.push(n),this.firstIndexFileContentGroups.push(v.last(this.firstIndexFileContentGroups)+e[t].length),await Promise.all(e[t].map(e=>R.SearchResult.createFileContentSearchResult(e,this.codeSearchInput.getSearchQuery(),this.editorPanel).setParent(this).renderTo(n.findInScope(".file-content-replies"),p.RenderLocation.IntoEnd))).then(e=>{this.allResults=this.allResults.concat(e)})})),this.fileNameResultsContainer.style.height="",this.totalResults.innerText=this.allResults.length.toString(),this.totalFiles.innerText=(t.length+n.length).toString(),this.searchQuery.innerText=this.codeSearchInput.getSearchQuery(),this.currentItemIndex=0,!f.isEmpty(this.allResults)&&this.allResults[this.currentItemIndex].setActive(!0)}async fetchResults(){return this.ideService.searchEverywhere({searchFileNames:this.fileNameCheckbox.checked,searchFileContent:this.fileContentCheckbox.checked,search:this.codeSearchInput.getSearchQuery(),ignoreCase:!1,sort:!1,subFolder:"",appId:await this.userSession.getActiveAppId()}).then(e=>e.getValue())}selectSearchReply(e){f.isEmpty(this.allResults)||(this.checkIfFileContentResultIsCollapsed(e)?this.skipCollapsedResults(e):(this.allResults[this.currentItemIndex].setActive(!1),this.currentItemIndex=e,this.allResults[this.currentItemIndex].setActive(!0)))}skipCollapsedResults(e){this.currentItemIndex<e&&!g.isLast(e,this.allResults)?this.selectSearchReply(e+1):this.selectSearchReply(e-1)}checkIfFileContentResultIsCollapsed(e){if(e<this.firstIndexFileContentGroups[0])return!1;for(let t=1;t<this.firstIndexFileContentGroups.length;t++)if(e<this.firstIndexFileContentGroups[t])return this.allFileContentGroups[t-1].isCollapsed();return!0}adjustHeight(){this.fileNameResultsContainer.style.height=Math.max(100,this.fileNameResultsContainer.scrollHeight)+"px"}setLoading(){this.fileContentResultsContainer.innerHTML="",this.fileNameResultsContainer.innerHTML='<div class="spinner"></div>'}};j=c([u.injectable(),d(0,u.inject(C.injectableTypes.IdeServiceStub)),d(1,u.inject(C.injectableTypes.CodeSearchInput)),d(2,u.inject(C.injectableTypes.EditorPanel)),d(3,u.inject(C.injectableTypes.UserSession)),d(4,u.inject(C.injectableTypes.MainMenu)),l("design:paramtypes",["function"==typeof(i=void 0!==y.IdeServiceStub&&y.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==P.CodeSearchInput&&P.CodeSearchInput)?s:Object,"function"==typeof(o=void 0!==I.EditorPanel&&I.EditorPanel)?o:Object,"function"==typeof(a=void 0!==w.UserSession&&w.UserSession)?a:Object,"function"==typeof(r=void 0!==T.MainMenu&&T.MainMenu)?r:Object])],j),t.CodeSearchModal=j},159:function(e,t,n){"use strict";var i,s,o,a,r,c,l,d=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},h=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SQLiteInfrastructureComponent=void 0;const u=n(4),m=n(10),f=n(66),v=n(19),b=n(69),y=n(6),g=n(5),S=n(20),w=n(7),C=n(11),I=n(49),T=n(660),E=n(663);n(666);let R=class extends b.InfrastructureComponent{constructor(e,t,n,i,s,o,a){super(t,n,i),this.htmlContent='\n        <div class="top-row">\n            <h1>\n                <span class="title">SQLite Databases</span>\n            </h1>\n            <div class="button-container">\n                <button class="button-medium button-light" id="new-database-button">\n                    New Database +\n                </button>\n            </div>\n        </div>\n        <div class="sqlite-references-table"></div>\n        <div class="storage-information">\n            <p>Note that while SQLite Databases are free, they use the same storage your app does.\n            You can increase your storage in the <span class=\'apps-page-link\'>apps</span> menu.</p>\n        </div>\n    ',this.classAttr="sqlite-infrastructure-component",this.sqliteService=e,this.appService=s,this.userSession=o,this.mainMenu=a,this.editorPanel=i}getIcon(){return w.Icon.Database}getName(){return"SQLite (Free)"}getRoute(){return this.routes.infrastructureSQLite}async afterEveryRender(){await super.afterEveryRender(),this.sqliteReferencesTable=await new T.SQLiteReferencesTable(this.userSession,this.sqliteService,this.editorPanel).renderTo(this.findInScope(".sqlite-references-table")),this.findInScope("#new-database-button").addEventListener("click",async()=>{await new E.NewSQLiteDatabaseModal(this.userSession,this.sqliteService,this.appService).renderTo("body")}),this.findInScope(".apps-page-link").addEventListener("click",()=>this.mainMenu.navigateToApps())}};R=d([u.injectable(),p(0,u.inject(g.injectableTypes.SQLiteServiceStub)),p(1,u.inject(g.injectableTypes.Router)),p(2,u.inject(g.injectableTypes.Routes)),p(3,u.inject(g.injectableTypes.EditorPanel)),p(4,u.inject(g.injectableTypes.AppServiceStub)),p(5,u.inject(g.injectableTypes.UserSession)),p(6,u.inject(g.injectableTypes.MainMenu)),h("design:paramtypes",["function"==typeof(i=void 0!==f.SQLiteServiceStub&&f.SQLiteServiceStub)?i:Object,"function"==typeof(s=void 0!==m.Router&&m.Router)?s:Object,"function"==typeof(o=void 0!==C.Routes&&C.Routes)?o:Object,"function"==typeof(a=void 0!==S.EditorPanel&&S.EditorPanel)?a:Object,"function"==typeof(r=void 0!==v.AppServiceStub&&v.AppServiceStub)?r:Object,"function"==typeof(c=void 0!==y.UserSession&&y.UserSession)?c:Object,"function"==typeof(l=void 0!==I.MainMenu&&I.MainMenu)?l:Object])],R),t.SQLiteInfrastructureComponent=R},185:function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserPreferencesComponent=void 0;const r=n(4),c=n(3),l=n(12),d=n(0),h=n(16),p=n(490),u=n(5);n(491);let m=class extends c.HtmlComponent{constructor(e){super(),this.htmlContent=`\n        <h1>Settings</h1>\n        <form>\n            <table>\n                <tbody>\n                    <tr hidden>\n                        <td colspan="2"><h2>Appearance</h2></td>\n                    </tr>\n                    <tr hidden>\n                        <td>\n                            <label for="settings-theme">Theme</label>\n                        </td>\n                        <td>\n                            <select class="theme" name="theme" id="settings-theme">\n                                ${p.discreteUserPreferences.theme.map(e=>`<option value="${e}">${e}</option>`).join()}\n                            </select>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan="2"><h2>Editor</h2></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label for="settings-fontSize">Font Size</label>\n                        </td>\n                        <td>\n                            <input\n                                type="number"\n                                class="fontSize"\n                                id="settings-fontSize"\n                                name="fontSize"\n                                min="1"\n                                max="100"\n                                value="10"> pt\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label for="settings-lineHighlight">Line highlight</label>\n                        </td>\n                        <td>\n                            <input\n                                type="checkbox"\n                                class="lineHighlight"\n                                name="lineHighlight"\n                                id="settings-lineHighlight">\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label for="settings-indentWithTabs">Indent with tabs</label>\n                        </td>\n                        <td>\n                            <input\n                                type="checkbox"\n                                class="indentWithTabs"\n                                name="indentWithTabs"\n                                id="settings-indentWithTabs">\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label for="settings-tabSize">Tab size</label>\n                        </td>\n                        <td>\n                            <input\n                                type="number"\n                                class="tabSize"\n                                name="tabSize"\n                                id="settings-tabSize"\n                                min="2"\n                                max="16"\n                                value="4"> spaces\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <label for="settings-keymap">Keymap</label>\n                        </td>\n                        <td>\n                            <select class="keymap" name="keymap" id="settings-keymap">\n                                ${p.discreteUserPreferences.keymap.map(e=>`<option value="${e}">${e}</option>`).join()}\n                            </select>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </form>\n    `,this.classAttr="settings-component",this.lastValues={},this.ideService=e}destroy(e){return this.userPreferencesStream.complete(l.getOk()),super.destroy(e)}setUserPreferences(e){for(const t in p.discreteUserPreferences){this.findInScope("select."+t).value=e[t]}const t=this.findInScope("input.fontSize");!d.has(this.lastValues.fontSize)&&(t.value=e.fontSize.toString());const n=this.findInScope("input.tabSize");!d.has(this.lastValues.tabSize)&&(n.value=e.tabSize.toString());this.findInScope("input.lineHighlight").checked=e.lineHighlight;this.findInScope("input.indentWithTabs").checked=e.indentWithTabs}async afterEveryRender(){await super.afterEveryRender(),d.has(this.userPreferencesStream)&&this.userPreferencesStream.complete(l.getOk()),this.userPreferencesStream=this.ideService.createUserPreferencesStream(),this.findInScope("form").addEventListener("change",async e=>{if("number"===e.target.type){const t=e.target;this.lastValues[t.name]=t.valueAsNumber}const t={theme:this.findInScope(".theme").value,keymap:this.findInScope(".keymap").value,fontSize:this.findInScope(".fontSize").valueAsNumber,lineHighlight:this.findInScope(".lineHighlight").checked,indentWithTabs:this.findInScope(".indentWithTabs").checked},n=this.findInScope(".fontSize");n.checkValidity()&&(t.fontSize=n.valueAsNumber);const i=this.findInScope(".tabSize");i.checkValidity()&&(t.tabSize=i.valueAsNumber),await this.userPreferencesStream.send(t)}),this.userPreferencesStream.onMessage(async e=>{this.setUserPreferences(e)}),await this.userPreferencesStream.send("start")}};m=s([r.injectable(),a(0,r.inject(u.injectableTypes.IdeServiceStub)),o("design:paramtypes",["function"==typeof(i=void 0!==h.IdeServiceStub&&h.IdeServiceStub)?i:Object])],m),t.UserPreferencesComponent=m},186:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FirebaseAppProvider=void 0;const l=c(n(116));n(118);const d=n(4),h=n(0),p=n(16),u=n(5),m=n(6);let f=class{constructor(e,t){let n=0;const i=t=>e.getFirebaseConfig({appId:t}).then(e=>e.getValue()).then(e=>l.default.initializeApp(e,(n++).toString()));this.firebaseApp=t.getActiveAppId().then(i),t.onActiveAppIdChange(e=>{h.has(e)&&(this.firebaseApp=i(e))})}get(){return this.firebaseApp}};f=o([d.injectable(),r(0,d.inject(u.injectableTypes.IdeServiceStub)),r(1,d.inject(u.injectableTypes.UserSession)),a("design:paramtypes",["function"==typeof(i=void 0!==p.IdeServiceStub&&p.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==m.UserSession&&m.UserSession)?s:Object])],f),t.FirebaseAppProvider=f},190:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SplitPanel=void 0;const s=n(3),o=n(95),a=n(0),r=i(n(495));n(496);class c extends s.HtmlComponent{constructor(e,t,n="horizontal",i=50,s=200){super(),this.firstComponentId=o.randomString(),this.secondComponentId=o.randomString(),this.htmlContent=`<div class="first" id="id_${this.firstComponentId}"></div>\n                           <div class="second" id="id_${this.secondComponentId}"></div>`,this.classAttr=`split-panel ${n}-split-panel`,this.firstComponent=e,this.secondComponent=t,this.direction=n,this.initialSize=i,this.minimumSize=s,this.oldSizes=[this.initialSize,100-this.initialSize]}async afterEveryRenderSync(){await super.afterEveryRenderSync();const e=this.findInScope("#id_"+this.firstComponentId);await this.firstComponent.renderTo(e);const t=this.findInScope("#id_"+this.secondComponentId);await this.secondComponent.renderTo(t),this.splitInstance=r.default([e,t],{direction:this.direction,onDrag:e=>{a.has(this.firstComponent.onResize)&&this.firstComponent.onResize(),a.has(this.secondComponent.onResize)&&this.secondComponent.onResize(),this.oldSizes=e},sizes:[this.initialSize,100-this.initialSize],gutterSize:0,minSize:[this.minimumSize,this.minimumSize]}),a.has(this.firstComponent.onResize)&&this.firstComponent.onResize(),a.has(this.secondComponent.onResize)&&this.secondComponent.onResize(),this.firstComponent.onVisibilityChange(e=>{this.handleVisibilityChangeFirstComponent(e)}),this.firstComponent.isVisible()||this.handleVisibilityChangeFirstComponent(!1),this.secondComponent.onVisibilityChange(e=>{this.handleVisibilityChangeSecondComponent(e)}),this.secondComponent.isVisible()||this.handleVisibilityChangeSecondComponent(!1)}onResize(){a.has(this.firstComponent.onResize)&&this.firstComponent.onResize(),a.has(this.secondComponent.onResize)&&this.secondComponent.onResize()}handleVisibilityChangeSecondComponent(e){e?(this.findInScope(".gutter").classList.remove("hidden"),this.splitInstance.setSizes(this.oldSizes)):(this.findInScope("#id_"+this.firstComponentId).style.height="100%",this.findInScope("#id_"+this.secondComponentId).style.height="0",this.findInScope(".gutter").classList.add("hidden"))}handleVisibilityChangeFirstComponent(e){e?(this.findInScope(".gutter").classList.remove("hidden"),this.splitInstance.setSizes(this.oldSizes)):(this.findInScope("#id_"+this.firstComponentId).style.height="0",this.findInScope("#id_"+this.secondComponent).style.height="100%",this.findInScope(".gutter").classList.add("hidden"))}}t.SplitPanel=c},191:function(e,t,n){"use strict";(function(e){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;const s=i(n(9)),o=i(n(501)),a=n(3),r=n(0),c=n(502),l=n(503),d=n(6),h=n(504);n(193),n(194),n(522),n(524),n(526),n(528),n(195),n(530),n(531),n(532),n(534),n(535),n(536),n(537),n(538),n(539),n(77),n(540),n(78),n(541),n(119),n(542),n(544),n(545),n(546),n(547),e.CodeMirror=s.default;class p extends a.HtmlComponent{constructor(e,t,n){super(),this.classAttr="editor",this.ideService=e,this.userSession=t,this.initialPreferences=n}onResize(){this.codeMirror.refresh()}undo(){this.codeMirror.getDoc().undo()}redo(){this.codeMirror.getDoc().redo()}openSearch(){this.codeMirror.execCommand("findPersistent")}openSearchAndReplace(){this.codeMirror.execCommand("replace")}handleTab(){this.codeMirror.somethingSelected()?this.codeMirror.indentSelection("add"):this.codeMirror.getOption("indentWithTabs")?this.codeMirror.execCommand("insertTab"):this.codeMirror.execCommand("insertSoftTab")}setTabSize(e){return this.codeMirror.setOption("indentUnit",e),this.codeMirror.setOption("tabSize",e),this}setIndentWithTabs(e){return this.codeMirror.setOption("indentWithTabs",e),this}setLineHighlight(e){return this.codeMirror.setOption("styleActiveLine",e),this}setKeymap(e){switch("default"!==e&&d.UserSession.logActivity(l.setCustomKeymap),this.codeMirror.setOption("keyMap",e),this.codeMirror.setOption("extraKeys",{"Ctrl-F":"findPersistent","Ctrl-Alt-L":()=>this.autoFormat(),"Ctrl-Z":()=>this.undo(),"Shift-Ctrl-Z":()=>this.redo(),Tab:()=>this.handleTab(),"Shift-Tab":()=>this.codeMirror.indentSelection("subtract")}),e){case"vim":s.default.Vim.map("jk","<Esc>","insert")}return this}autoFormat(){if(d.UserSession.logActivity(c.formatCode),!r.has(this.fileTypeId))return;const e=h.prettierParsers[this.fileTypeId];r.has(e)&&this.codeMirror.setValue(o.default.format(this.codeMirror.getValue(),{parser:e.parserName,plugins:e.plugins}))}focus(){this.codeMirror.refresh(),this.codeMirror.focus()}async afterEveryRender(){await super.afterEveryRender();const e=r.has(this.initialPreferences)?this.initialPreferences.tabSize:4,t=r.has(this.initialPreferences)&&this.initialPreferences.indentWithTabs,n=r.has(this.initialPreferences)&&this.initialPreferences.lineHighlight;this.codeMirror=s.default(this.getRootElement(),{mode:this.getMode(),theme:"codesphere",lineNumbers:!0,matchBrackets:!0,matchTags:!0,indentUnit:e,tabSize:e,indentWithTabs:t,styleActiveLine:n,styleActiveSelected:n,gutters:["CodeMirror-linenumbers","CodeMirror-lsp"]}),this.setKeymap(r.has(this.initialPreferences)?this.initialPreferences.keymap:"default").focus()}}t.Editor=p}).call(this,n(17))},197:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyTheme=void 0;const i=n(67);t.applyTheme=e=>{const t=document.documentElement.style;i.forEachProperty(s[e],(e,n)=>t.setProperty(e,n))};const s={dark:{"--color-background-dark":"#13121AFF","--color-on-background":"#CDC8E4FF"}}},198:function(e,t,n){"use strict";var i,s,o,a=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorPanelEmptySpaceHint=void 0;const l=n(4),d=n(3),h=n(0),p=n(16),u=n(7),m=n(5),f=n(56),v=n(120),b=n(123),y=n(49),g=n(79),S=n(134);n(643);let w=class extends d.HtmlComponent{constructor(e,t,n){super(),this.htmlContent=`\n        <div class="empty-space-hint">\n            <div class="row">\n                <div class="column title">\n                    <div>\n                        <h1>Codesphere</h1>\n                        <p>Next Level Cloud Programming</p>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="column">\n                    <div class="content start">\n                        <strong>Start</strong>\n                        <div class="entry" id="new-file">\n                            <div class="icon">${u.Icon.NewFile}</div>\n                            <span class="text">New File</span>\n                        </div >\n                        <div class="entry" id="new-directory">\n                            <div class="icon">${u.Icon.NewFolder}</div>\n                            <span class="text">New Directory</span>\n                        </div>\n                        <div class="entry apps">\n                            <div class="icon">${u.Icon.Apps}</div>\n                            <span class="text">My Apps</span>\n                        </div>\n                        <div class="entry" id="open-terminal">\n                            <div class="icon">${u.Icon.Terminal}</div>\n                            <span class="text">Open Terminal</span>\n                        </div>\n                    </div>\n                </div>\n                <div class="column">\n                     <div class="content">\n                        <strong>Let's get you started!</strong>\n                        <div class="entry">\n                            <a href="https://www.youtube.com/watch?v=W_D15Gu9Rsk&t=8s" target="_blank">\n                                YouTube Tutorial\n                            </a>\n                        </div>\n                        <div class="entry">\n                            <a href="https://codesphere.com/faq" target="_blank">\n                                FAQ\n                            </a>\n                        </div>\n                        <div class="entry" id="settings">\n                            <span class="text">Settings</span>\n                        </div>\n                        <div class="entry" id="keybindings">\n                            <span class="text">Keybindings</span>\n                        </div>\n                    </div>\n                </div>\n                <div class="column">\n                    <div class="content">\n                        <strong>Trending</strong>\n                        <div class="entry">\n                            <a href="https://codesphere.com/blog" target="_blank">\n                                Blog Articles\n                            </a>\n                        </div>\n                        <div class="entry">\n                            <a href="https://feedback.codesphere.com/" target="_blank">\n                                Feedback\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            </div>                 \n        </div> \n    `,this.classAttr="editor-panel-empty-space-hint",this.ideService=e,this.terminalPanel=t,this.mainMenu=n}onResize(){this.editorPanel.offsetHeight<this.emptySpaceHint.offsetHeight?this.editorPanelEmptySpace.classList.add("outer-empty-space-hint"):this.editorPanelEmptySpace.classList.remove("outer-empty-space-hint")}onOpenSettings(e){this.openSettingsListener=e}async afterEveryRender(){await super.afterEveryRender(),this.findInScope("#new-file").addEventListener("click",()=>this.openNewFileModal()),this.findInScope("#new-directory").addEventListener("click",()=>this.openNewDirectoryModal()),this.findInScope("#open-terminal").addEventListener("click",()=>this.terminalPanel.show()),this.findInScope("#settings").addEventListener("click",()=>this.openSettings()),this.findInScope("#keybindings").addEventListener("click",()=>this.openKeybindings()),this.findInScope(".apps").addEventListener("click",e=>{e.stopPropagation(),this.mainMenu.navigateToApps()}),this.editorPanel=document.querySelector(".editor-panel"),this.editorPanelEmptySpace=document.querySelector(".editor-panel-empty-space-hint"),this.emptySpaceHint=this.findInScope(".empty-space-hint"),this.emptySpaceHint.classList.add("empty-space-height")}openNewFileModal(){g.showModal(new v.CreateFileModal(this.ideService,""))}openNewDirectoryModal(){g.showModal(new b.CreateDirectoryModal(this.ideService,""))}openKeybindings(){g.showModal(new S.KeybindingModal)}openSettings(){h.has(this.openSettingsListener)&&this.openSettingsListener()}};w=a([l.injectable(),c(0,l.inject(m.injectableTypes.IdeServiceStub)),c(1,l.inject(m.injectableTypes.TerminalPanel)),c(2,l.inject(m.injectableTypes.MainMenu)),r("design:paramtypes",["function"==typeof(i=void 0!==p.IdeServiceStub&&p.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==f.TerminalPanel&&f.TerminalPanel)?s:Object,"function"==typeof(o=void 0!==y.MainMenu&&y.MainMenu)?o:Object])],w),t.EditorPanelEmptySpaceHint=w},20:function(e,t,n){"use strict";var i,s,o,a,r,c,l,d,h,p=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},m=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EditorPanel=t.CACHED_ACTIVE_EDITOR_TAB_ID=void 0;const f=n(4),v=n(0),b=n(12),y=n(65),g=n(152),S=n(36),w=n(16),C=n(92),I=n(23),T=n(28),E=n(319),R=n(66),P=n(96),j=n(185),L=n(6),M=n(5),A=n(186),k=n(494),x=n(197),_=n(198),O=n(645);n(658);t.CACHED_ACTIVE_EDITOR_TAB_ID="active-editor-tab-identifier";let D=class extends P.TabLayout{constructor(e,t,n,i,s,o,a,r,c){super([],void 0,!1,s,!0),this.classAttr="tab-layout editor-panel",this.editorTabReferences={},this.queryEditorTabReferences={},this.fileEditorListeners=[],this.showInEditorListeners=[],this.closeTabListeners=[],this.ideService=e,this.sqliteService=c,this.languageServer=t,this.workspaceService=i,this.authService=n,this.userPreferencesComponent=o,this.firebaseAppProvider=a,this.userSession=r,this.editorPanelEmptySpaceHint=s,L.UserSession.getInstance().onActiveAppIdChange(this.closeAllTabs.bind(this))}setEditorPreferences(e){this.getRootElement().style.setProperty("--editor-font-size",e.fontSize+"pt"),this.renderedComponents.forEach(({tab:t})=>{if(this.isAFileEditor(t.component)){t.component.setKeymap(e.keymap).setTabSize(e.tabSize).setIndentWithTabs(e.indentWithTabs).setLineHighlight(e.lineHighlight)}})}getActiveFileEditor(){var e;const t=null===(e=this.getSelectedTab())||void 0===e?void 0:e.tab;if(v.has(t))return this.isAFileEditor(t.component)?t.component:void 0}onTabOpenOrCloseEvent(e){this.closeTabListeners.push(e)}onShowInEditor(e){this.showInEditorListeners.push(e)}async showInFileEditor(e,t,n){t=t.replace(/^\//,""),v.has(n)&&v.has(this.editorTabReferences[n])?this.editorTabReferences[n].then(e=>this.showTab(e)):v.has(t)&&v.has(this.editorTabReferences[t])?this.editorTabReferences[t].then(e=>this.showTab(e)):this.addTabReference(e,t,n).then(e=>this.showTab(e))}onFileEditor(e){this.fileEditorListeners.push(e)}onResize(){this.editorPanelEmptySpaceHint.onResize(),Object.values(this.renderedComponents).forEach(e=>{const t=e.tab.component;"onResize"in t&&t.onResize()})}async showSettings(){var e;let t=!1;this.renderedComponents.forEach(e=>{"Settings"===e.tab.name&&(t=!0,this.showTab(e.tab))}),t||(await this.addTab({name:"Settings",component:this.userPreferencesComponent},!0),null===(e=this.userPreferencesStream)||void 0===e||e.onMessage(async e=>this.userPreferencesComponent.setUserPreferences(e)))}async showInQueryEditor(e,t){v.has(this.queryEditorTabReferences[t])?this.showTab(this.queryEditorTabReferences[t]):this.queryEditorTabReferences[t]=await this.addTab({name:"Query Editor "+e,component:new k.SQLQueryEditorLayout(this.userSession,this.sqliteService,this.ideService,t,e)},!0)}async showInfrastructureComponent(e){await this.showTabByName(e.getName())||await this.addTab({name:e.getName(),component:e},!0)}async showTabByPathOrFileId(e){const t=(await Promise.all(y.values(this.editorTabReferences))).find(t=>t.path===e);return!!v.has(t)&&(await this.showTab(t),!0)}async closeTabByPathOrFileId(e){const t=(await Promise.all(y.values(this.editorTabReferences))).find(t=>t.path===e),n=this.renderedComponents.find(e=>e.tab===t);return!(!v.has(t)||!v.has(n))&&(await this.closeTab(n),!0)}destroy(e){var t;return null===(t=this.userPreferencesStream)||void 0===t||t.complete(b.getOk()),super.destroy(e)}async showTab(e){if(await super.showTab(e),"path"in e)return this.saveActiveFileEditorTabIdentifierToLocalStorage(e.path),this.showInEditorListeners.forEach(t=>t(e.path)),void e.component.focus();this.saveActiveFileEditorTabIdentifierToLocalStorage(e.name),this.showInEditorListeners.forEach(t=>t(e.name))}async afterEveryRender(){this.userPreferencesStream=this.ideService.createUserPreferencesStream(),this.userPreferencesStream.onMessage(async e=>{this.setEditorPreferences(e),x.applyTheme(e.theme);const t=v.has(this.lastUserPreferences);this.lastUserPreferences=e,!t&&this.restoreFileTabsFromLocalStorage()}),this.userPreferencesStream.send("start"),this.editorPanelEmptySpaceHint.onOpenSettings(()=>this.showSettings())}async closeTab({tab:e,tabBarButton:t}){await super.closeTab({tab:e,tabBarButton:t}),g.keys(this.editorTabReferences).forEach(t=>this.editorTabReferences[t].then(n=>{n.id===e.id&&delete this.editorTabReferences[t]&&this.closeTabListeners.forEach(e=>e(t))})),this.removeTabFromLocalStorage(e.id),g.keys(this.editorTabReferences).forEach(e=>this.editorTabReferences[e].then(t=>{const n=this.getSelectedTab();v.has(n)&&n.tab.id===t.id&&this.showInEditorListeners.forEach(t=>t(e))})),g.keys(this.queryEditorTabReferences).filter(t=>this.queryEditorTabReferences[t].id===e.id).forEach(e=>delete this.queryEditorTabReferences[e])}isAFileEditor(e){return"setKeymap"in e}addTabReference(e,t,n){const i=this.authService.getUser().then(e=>e.getValue()).then(async e=>new O.FileEditor({fileId:n,userId:e.userId,appId:await this.userSession.getActiveAppId(),filePath:t},this.ideService,this.firebaseAppProvider,this.userSession,await this.createLspStreamIfNotExists(),this.lastUserPreferences)).then(n=>this.addTab({name:e,component:n,path:t},!0)),s=null!=n?n:t;return this.editorTabReferences[s]=i,Promise.all(y.values(this.editorTabReferences)).then(e=>this.fileEditorListeners.forEach(t=>t(e.map(e=>e.component)))),this.saveFileTabToLocalStorage(e,t,n),L.UserSession.logActivity(E.openFile(t)),i}async restoreFileTabsFromLocalStorage(){const e=S.safeLocalStorage.getItem("editor-tabs");if(!v.has(e))return;S.safeLocalStorage.removeItem("editor-tabs");const t=JSON.parse(e);for(const e of t)v.has(e)&&await this.addTabReference(e.fileName,e.filePath,e.fileId)}async createLspStreamIfNotExists(){if(v.has(this.lspStream))return this.lspStream;const e=await this.userSession.getActiveAppId(),t=(await this.workspaceService.getContainerInfo({appId:e})).getValue();if(!v.has(t.storageMountPath))throw new Error(`App ${e} has no storage mount path.`);return this.lspStream=this.languageServer.createLspStream(t.storageMountPath),this.userSession.onActiveAppIdChange(()=>{var e;null===(e=this.lspStream)||void 0===e||e.complete(b.getOk()),delete this.lspStream}),this.lspStream}saveFileTabToLocalStorage(e,t,n){const i=S.safeLocalStorage.getItem("editor-tabs"),s=v.has(i)?JSON.parse(i):[];s.push({fileName:e,filePath:t,fileId:n}),S.safeLocalStorage.setItem("editor-tabs",JSON.stringify(s))}saveActiveFileEditorTabIdentifierToLocalStorage(e){S.safeLocalStorage.setItem(t.CACHED_ACTIVE_EDITOR_TAB_ID,e)}removeTabFromLocalStorage(e){const t=S.safeLocalStorage.getItem("editor-tabs");if(!v.has(t))return;const n=JSON.parse(t);delete n[e-1],S.safeLocalStorage.setItem("editor-tabs",JSON.stringify(n))}};D=p([f.injectable(),m(0,f.inject(M.injectableTypes.IdeServiceStub)),m(1,f.inject(M.injectableTypes.LanguageServerStub)),m(2,f.inject(M.injectableTypes.AuthServiceStub)),m(3,f.inject(M.injectableTypes.WorkspaceServiceStub)),m(4,f.inject(M.injectableTypes.EditorPanelEmptySpaceHint)),m(5,f.inject(M.injectableTypes.UserPreferencesComponent)),m(6,f.inject(M.injectableTypes.FirebaseAppProvider)),m(7,f.inject(M.injectableTypes.UserSession)),m(8,f.inject(M.injectableTypes.SQLiteServiceStub)),u("design:paramtypes",["function"==typeof(i=void 0!==w.IdeServiceStub&&w.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==C.LanguageServerStub&&C.LanguageServerStub)?s:Object,"function"==typeof(o=void 0!==I.AuthServiceStub&&I.AuthServiceStub)?o:Object,"function"==typeof(a=void 0!==T.WorkspaceServiceStub&&T.WorkspaceServiceStub)?a:Object,"function"==typeof(r=void 0!==_.EditorPanelEmptySpaceHint&&_.EditorPanelEmptySpaceHint)?r:Object,"function"==typeof(c=void 0!==j.UserPreferencesComponent&&j.UserPreferencesComponent)?c:Object,"function"==typeof(l=void 0!==A.FirebaseAppProvider&&A.FirebaseAppProvider)?l:Object,"function"==typeof(d=void 0!==L.UserSession&&L.UserSession)?d:Object,"function"==typeof(h=void 0!==R.SQLiteServiceStub&&R.SQLiteServiceStub)?h:Object])],D),t.EditorPanel=D},202:function(e,t,n){"use strict";var i,s,o,a=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProfilePanel=void 0;const l=n(4),d=n(3),h=n(5),p=n(124),u=n(125),m=n(204);let f=class extends d.HtmlComponent{constructor(e,t,n){super(),this.htmlContent='\n        <div class="topbar-container"></div>\n        <div class="content-container"></div>\n    ',this.classAttr="profile-page panel",this.menuTopbar=e,this.userProfileComponent=t,this.changeEmailComponent=n,this.hide()}show(){this.menuTopbar.show(),super.show()}async showProfile(){this.show(),this.menuTopbar.togglePath("profile"),this.changeEmailComponent.hide(),this.userProfileComponent.show()}async showChangeEmail(){this.show(),this.menuTopbar.togglePath("email"),this.userProfileComponent.hide(),this.changeEmailComponent.show()}async afterEveryRenderSync(){await this.menuTopbar.renderTo(this.findInScope(".topbar-container")),await this.userProfileComponent.renderTo(this.findInScope(".content-container")),await this.changeEmailComponent.renderTo(this.findInScope(".content-container"))}};f=a([l.injectable(),c(0,l.inject(h.injectableTypes.MenuTopbar)),c(1,l.inject(h.injectableTypes.UserProfileComponent)),c(2,l.inject(h.injectableTypes.ChangeEmailComponent)),r("design:paramtypes",["function"==typeof(i=void 0!==p.MenuTopbar&&p.MenuTopbar)?i:Object,"function"==typeof(s=void 0!==u.UserProfileComponent&&u.UserProfileComponent)?s:Object,"function"==typeof(o=void 0!==m.ChangeEmailComponent&&m.ChangeEmailComponent)?o:Object])],f),t.ProfilePanel=f},204:function(e,t,n){"use strict";var i,s,o,a=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeEmailComponent=void 0;const l=n(3),d=n(4),h=n(0),p=n(10),u=n(15),m=n(23),f=n(11),v=n(6),b=n(129),y=n(5);n(583);let g=class extends l.HtmlComponent{constructor(e,t,n){super(),this.htmlContent='\n        <form class=\'input-form\'>\n            <div class="inner-container">\n                <div class="main-form">\n                    <div class="input-container">\n                        <div>\n                            <label for="current-email">Current Email</label><br>\n                            <input\n                                id="current-email"\n                                type="email"\n                                disabled\n                            />\n                        </div>\n                        <div>\n                            <label for="new-email">New Email</label><br>\n                            <input\n                                id="new-email"\n                                type="email"\n                                placeholder="example@email.com"\n                                autofocus\n                            />\n                        </div>\n                        <div>\n                            <label for="password">Password</label><br>\n                            <input\n                                id="password"\n                                type="password"\n                                placeholder="password"\n                            />\n                        </div>\n                        <div><p class="error error-commit hidden"></p></div>\n                    </div>\n                    <div class="button-container">\n                        <button type="button" class="button-medium button-secondary button-cancel">Cancel</button>\n                        <button type="submit" class="button-medium button-primary button-update" disabled>Update</button>\n                    </div>\n                </div>\n                <div class="success-message" hidden>\n                    <p>We sent you a confirmation link to <span class="current-email"></span></p>\n                    <div class="button-container">\n                        <div></div>\n                        <button type="submit" class="button-medium button-primary button-ok">Ok</button>\n                    </div>\n                </div>\n            </div>\n        </form>\n        ',this.classAttr="change-email-component",this.email="",this.newEmail="",this.password="",this.router=e,this.routes=t,this.authService=n,this.loadingAnimationComponent=new b.LoadingAnimationComponent,this.hide()}show(){super.show(),this.syncForm().then(()=>this.loadingAnimationComponent.hide()),this.findInScope("#new-email").focus()}async onChangeEmail(){if(this.hideErrors(),u.isEmpty(this.newEmail)||u.isEmpty(this.password))return;this.loadingAnimationComponent.show();const e=await this.authService.updateEmail({email:this.email,newEmail:this.newEmail,password:this.password});if(e.notOk())return this.showError(e.getErrorMessage()),void this.loadingAnimationComponent.hide();this.findInScope(".main-form").hidden=!0,this.findInScope(".success-message").hidden=!1,this.loadingAnimationComponent.hide()}async afterEveryRender(){await this.loadingAnimationComponent.renderTo(this.getRootElement());const e=this.findInScope("#new-email"),t=this.findInScope("#password");e.oninput=async()=>this.updateForm({newEmail:e.value}),t.oninput=async()=>this.updateForm({password:t.value}),this.findInScope(".button-update").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.onChangeEmail()}),this.findInScope(".button-cancel").addEventListener("click",e=>{e.stopPropagation(),this.navigateToProfile()}),this.findInScope(".button-ok").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.navigateToProfile()}),await this.syncForm()}navigateToProfile(){this.router.setUrl(this.routes.profile)}async syncForm(){this.findInScope(".main-form").hidden=!1,this.findInScope(".success-message").hidden=!0,this.findInScope("#new-email").value="",this.findInScope("#password").value="",this.loadingAnimationComponent.show(),await v.UserSession.getInstance().getAuthentication();const e=(await this.authService.getUser()).getValue();if(!("password"===e.authenticationMethod)&&this.isVisible())return void this.navigateToProfile();this.email=e.email;this.findInScope("#current-email").value=e.email,this.findInScope("span.current-email").textContent=this.email,this.findInScope(".button-update").disabled=!0}async updateForm({newEmail:e,password:t}){h.has(e)&&(this.newEmail=e.trim()),h.has(t)&&(this.password=t);const n=!(this.newEmail&&this.password);this.findInScope(".button-update").disabled=n}showError(e){const t=this.findInScope(".error-commit");t.innerHTML="Error: "+e,t.classList.remove("hidden")}hideErrors(){this.findInScope(".error-commit").classList.add("hidden")}};g=a([d.injectable(),c(0,d.inject(y.injectableTypes.Router)),c(1,d.inject(y.injectableTypes.Routes)),c(2,d.inject(y.injectableTypes.AuthServiceStub)),r("design:paramtypes",["function"==typeof(i=void 0!==p.Router&&p.Router)?i:Object,"function"==typeof(s=void 0!==f.Routes&&f.Routes)?s:Object,"function"==typeof(o=void 0!==m.AuthServiceStub&&m.AuthServiceStub)?o:Object])],g),t.ChangeEmailComponent=g},206:function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.StripeProvider=void 0;const r=n(4),c=n(585),l=n(5),d=n(128);let h=class{constructor(e){this.stripe=e.get().then(e=>c.loadStripe(e.stripePublishableKey))}get(){return this.stripe}};h=s([r.injectable(),a(0,r.inject(l.injectableTypes.BrowserConfigProvider)),o("design:paramtypes",["function"==typeof(i=void 0!==d.BrowserConfigProvider&&d.BrowserConfigProvider)?i:Object])],h),t.StripeProvider=h},214:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorStatusFooter=void 0;const c=n(3),l=n(0),d=n(12),h=n(4),p=n(28),u=n(6),m=n(7),f=n(5),v=n(215);n(669);let b=class extends c.HtmlComponent{constructor(e,t){super(),this.classAttr="navigator-footer",this.openTerminalListeners=[],this.firstStart=!0,this.workspaceService=e,this.startupTimeTracker=t}onOpenTerminal(e){return this.openTerminalListeners.push(e),this}async afterEveryRender(){let e;await super.afterEveryRender(),this.terminalIcon=await new y(m.Icon.Terminal).renderTo(this.getRootElement()),this.terminalIcon.onClick(()=>this.openTerminalListeners.forEach(e=>e()));const t=u.UserSession.getInstance().getActiveAppIdIfSet();l.has(t)&&(e=this.workspaceService.createContainerInfoStream(),this.bindContainerInfoStream(e),e.start({appId:t})),u.UserSession.getInstance().onActiveAppIdChange(async t=>{l.has(e)&&e.complete(d.okReply()),l.has(t)&&(e=this.workspaceService.createContainerInfoStream(),this.bindContainerInfoStream(e),e.start({appId:t}))})}bindContainerInfoStream(e){e.onMessage(async({containerInfo:e})=>{if(!l.has(e))return;const t=e.status;"running"===t?(this.trackFirstStart(),this.terminalIcon.alert(!1)):"pending"!==t&&this.terminalIcon.alert(!0,"Container status: "+t)})}trackFirstStart(){this.firstStart&&(this.startupTimeTracker.stop(),this.firstStart=!1)}};b=o([h.injectable(),r(0,h.inject(f.injectableTypes.WorkspaceServiceStub)),r(1,h.inject(f.injectableTypes.StartupTimeTracker)),a("design:paramtypes",["function"==typeof(i=void 0!==p.WorkspaceServiceStub&&p.WorkspaceServiceStub)?i:Object,"function"==typeof(s=void 0!==v.StartupTimeTracker&&v.StartupTimeTracker)?s:Object])],b),t.NavigatorStatusFooter=b;class y extends c.HtmlComponent{constructor(e){super(),this.classAttr="with-tooltip",this.clickListeners=[],this.htmlContent=`\n            <span class="tooltiptext hidden" style="margin-left: 50px; margin-top: 10px"></span>\n            <span class="alert-circle hidden">!</span>\n            <div class="main-circle">\n                ${e}\n            </div>\n        `}setMarked(e){e?this.mainElement.classList.add("marked"):this.mainElement.classList.remove("marked")}alert(e,t){e?(this.alertElement.classList.remove("hidden"),l.has(t)?(this.findInScope(".tooltiptext").innerHTML=t,this.findInScope(".tooltiptext").classList.remove("hidden")):(this.findInScope(".tooltiptext").innerHTML="",this.findInScope(".tooltiptext").classList.add("hidden"))):(this.alertElement.classList.add("hidden"),this.findInScope(".tooltiptext").innerHTML="",this.findInScope(".tooltiptext").classList.add("hidden"))}onClick(e){this.clickListeners.push(e)}async afterEveryRenderSync(){await super.afterEveryRenderSync(),this.alertElement=this.findInScope(".alert-circle"),this.mainElement=this.findInScope(".main-circle"),[this.alertElement,this.mainElement].forEach(e=>e.addEventListener("click",()=>this.clickListeners.forEach(e=>e())))}}},215:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.StartupTimeTracker=void 0;const o=n(4),a=n(668),r=n(6);let c=class{constructor(e){this.startTimeMillis=e}stop(){r.UserSession.logActivity(a.createIdeStartupEvent(Date.now()-this.startTimeMillis))}};c=i([o.injectable(),s("design:paramtypes",[Number])],c),t.StartupTimeTracker=c},216:function(e,t,n){"use strict";var i,s,o,a,r=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.HoveringMenu=void 0;const d=n(4),h=n(0),p=n(3),u=n(23),m=n(16),f=n(7),v=n(673),b=n(6),y=n(20),g=n(56),S=n(59),w=n(5),C=n(79),I=n(134),T=n(132),E=n(217);n(678);let R=class extends p.HtmlComponent{constructor(e,t,n,i){super(),this.htmlContent=`\n        <div class="left-menu">\n            <span class="menu-entry edit-button"></span>\n            <div class="separator"></div>\n            <div class="menu-entry icon terminal-icon with-tooltip with-tooltip-bottom">\n                <span class="tooltiptext" style="right: 72.5px; top: 52px">Terminal</span>\n                ${f.Icon.Terminal}\n            </div>\n            <div class="separator"></div>\n            <div class="menu-entry icon open-app-icon with-tooltip with-tooltip-bottom">\n                <span class="tooltiptext" style="right: 19.5px; top: 52px">Open app</span>\n                ${f.Icon.Monitor}\n            </div>\n        </div>\n        <div class="profile">\n            <span class="profile-letter"></span>\n        </div>\n    `,this.classAttr="hovering-menu",this.authService=e,this.ideService=t,this.editorPanel=n,this.terminalPanel=i}onShowApps(e){this.showAppsListener=e}onShowProfile(e){this.showProfileListener=e}onShowBilling(e){this.showBillingListener=e}async syncAvatar(){var e;await b.UserSession.getInstance().getAuthentication();const t=(await this.authService.getUser()).getValue(),n=(await this.ideService.getUserPreferences()).getValue();this.findInScope(".profile").style.backgroundColor=n.profileColor,h.has(this.profileDropdownMenu)&&(this.profileDropdownMenu.findInScope(".text").innerText=(null!==(e=t.firstName)&&void 0!==e?e:t.email)[0].toUpperCase())}async afterEveryRender(){await super.afterEveryRender(),this.editorPanel.addTabChangeListener(e=>{e.length>=1?this.getRootElement().classList.add("hovering-menu-down"):this.getRootElement().classList.remove("hovering-menu-down")}),await this.bindEditMenu(),this.findInScope(".terminal-icon").addEventListener("click",()=>this.terminalPanel.openNewTerminal()),this.findInScope(".open-app-icon").addEventListener("click",async()=>{const e=await b.UserSession.getInstance().getActiveAppId();e&&window.open(`https://${e}-3000.codesphere.com/`,"_blank")}),this.bindProfileMenu()}async bindEditMenu(){this.editDropdownMenu=new T.DropdownMenu({text:"Edit"},"edit-dropdown");const e={icon:""+f.Icon.Undo,text:"Undo",description:"Ctrl+Z",performAction:async()=>{var e;null===(e=this.editorPanel.getActiveFileEditor())||void 0===e||e.undo()}},t={icon:""+f.Icon.Redo,text:"Redo",description:"Ctrl+Shift+Z",performAction:async()=>{var e;null===(e=this.editorPanel.getActiveFileEditor())||void 0===e||e.redo()}},n={icon:""+f.Icon.Format,text:"Format",description:"Ctrl+Alt+L",performAction:async()=>{var e;null===(e=this.editorPanel.getActiveFileEditor())||void 0===e||e.autoFormat()}},i={icon:""+f.Icon.Search,text:"Search",description:"Ctrl+F",performAction:async()=>{var e;null===(e=this.editorPanel.getActiveFileEditor())||void 0===e||e.openSearch()}},s={icon:""+f.Icon.Replace,text:"Replace",description:"Ctrl+Shift+F",performAction:async()=>{var e;null===(e=this.editorPanel.getActiveFileEditor())||void 0===e||e.openSearchAndReplace()}},o=this.findInScope(".edit-button");await this.editDropdownMenu.addEntryGroup({uiAction:e},{uiAction:t},{uiAction:n},{uiAction:i},{uiAction:s}).renderTo(o),o.addEventListener("click",e=>this.editDropdownMenu.toggleExpandCollapse(e)),h.has(this.editorPanel.getActiveFileEditor())||this.disableEditButton(),this.editorPanel.onTabOpenOrCloseEvent(this.disableEditButton.bind(this)),this.editorPanel.onShowInEditor(this.enableEditButton.bind(this))}enableEditButton(){this.findInScope(".edit-button").classList.remove("disabled"),this.editDropdownMenu.enable()}disableEditButton(){this.findInScope(".edit-button").classList.add("disabled"),this.editDropdownMenu.disable()}async bindProfileMenu(){const e=this.findInScope(".profile");this.profileDropdownMenu=new T.DropdownMenu({text:"A"},"profile-dropdown");const t={icon:""+f.Icon.Apps,text:"My Apps",performAction:async()=>{h.has(this.showAppsListener)&&this.showAppsListener()}},n={icon:""+f.Icon.User,text:"My Profile",performAction:async()=>{h.has(this.showProfileListener)&&this.showProfileListener()}},i={icon:""+f.Icon.Billing,text:"Billing",performAction:async()=>{h.has(this.showBillingListener)&&this.showBillingListener()}},s={icon:""+f.Icon.Keybinding,text:"Keybindings",performAction:async()=>{C.showModal(new I.KeybindingModal)}},o={icon:""+f.Icon.Invite,text:"Invite Friends",performAction:async()=>{C.showModal(new v.InviteModal(this.authService))}},a={icon:""+f.Icon.Feedback,text:"Feedback",performAction:async()=>{window.open("https://feedback.codesphere.com","_blank")}},r={icon:""+f.Icon.Help,text:"Help",performAction:async()=>{C.showModal(new E.HelpModal)}},c={icon:""+f.Icon.Signout,text:"Signout",performAction:async()=>{S.signOut()}};e.innerHTML="",await this.profileDropdownMenu.addEntryGroup({uiAction:t},{uiAction:n},{uiAction:i},{uiAction:s},{uiAction:o},{uiAction:a},{uiAction:r},{uiAction:c}).renderTo(e),e.addEventListener("click",e=>this.profileDropdownMenu.toggleExpandCollapse(e)),this.syncAvatar()}};R=r([d.injectable(),l(0,d.inject(w.injectableTypes.AuthServiceStub)),l(1,d.inject(w.injectableTypes.IdeServiceStub)),l(2,d.inject(w.injectableTypes.EditorPanel)),l(3,d.inject(w.injectableTypes.TerminalPanel)),c("design:paramtypes",["function"==typeof(i=void 0!==u.AuthServiceStub&&u.AuthServiceStub)?i:Object,"function"==typeof(s=void 0!==m.IdeServiceStub&&m.IdeServiceStub)?s:Object,"function"==typeof(o=void 0!==y.EditorPanel&&y.EditorPanel)?o:Object,"function"==typeof(a=void 0!==g.TerminalPanel&&g.TerminalPanel)?a:Object])],R),t.HoveringMenu=R},217:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.HelpModal=void 0;const s=n(4),o=n(3),a=n(0),r=n(7);n(676);let c=class extends o.HtmlComponent{constructor(){super(...arguments),this.htmlContent=`\n<div class="modal help-container">\n    <div class="close-button-container">\n        <div class="icon close">\n            ${r.Icon.Close}\n        </div>\n    </div>\n    <h1>How can we help?</h1>\n    <p>\n        Have questions, feedback, or want to let us know which features are missing? Feel free to reach out to us via:\n    </p>\n    <p class="email-container">\n        <span class="email">support@codesphere.com</span><span class="copy">${r.Icon.Copy}</span>\n    </p>\n    <div class="button-container">\n        <button class="ok">Ok</button>\n    </div>\n</div>\n`,this.classAttr="keybindable help-modal"}async destroy(e){a.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),a.has(this.clickListener)&&document.removeEventListener("click",this.clickListener),await super.destroy(e)}async afterEveryRender(){await super.afterEveryRender();const e=this.findInScope(".close"),t=this.findInScope(".ok"),n=this.findInScope(".copy");e.onclick=()=>this.destroy(),t.onclick=()=>this.destroy(),n.onclick=()=>function(e){const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}("support@codesphere.com"),this.keyUpListener=e=>{"Escape"===e.key&&(e.stopPropagation(),this.destroy(!0))},document.addEventListener("keyup",this.keyUpListener),this.clickListener=e=>{this.findInScope(".help-container").contains(e.target)||(e.stopPropagation(),this.destroy(!0))},document.addEventListener("click",this.clickListener)}};c=i([s.injectable()],c),t.HelpModal=c},218:function(e,t,n){"use strict";var i,s,o,a,r,c,l=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorComponent=void 0;const p=n(4),u=n(3),m=n(219),f=n(5),v=n(222),b=n(11),y=n(56),g=n(6),S=n(96),w=n(227),C=n(214);n(728);let I=class extends u.HtmlComponent{constructor(e,t,n,i,s,o){super(),this.classAttr="navigator-component",this.infrastructureMenu=i,this.fileTree=e,this.menuBar=t,this.terminalPanel=n,this.footer=s,this.routes=o}async afterEveryRender(){await super.afterEveryRender(),await this.menuBar.renderTo(this.getRootElement());const e=await new S.TabLayout([{name:"Code",component:this.fileTree},{name:"Infrastructure",component:this.infrastructureMenu}],void 0,!1,void 0,!0,location.pathname.startsWith(this.routes.infrastructure)?"Infrastructure":"Code").renderTo(this.getRootElement());location.pathname.startsWith(this.routes.infrastructure)?e.showTabByName("Infrastructure"):e.showTabByName("Code"),this.footer.onOpenTerminal(()=>this.terminalPanel.show()).renderTo(this.getRootElement()),g.UserSession.getInstance().onActiveAppIdChange(()=>e.showTabByName("Code"))}};I=l([p.injectable(),h(0,p.inject(f.injectableTypes.FileTree)),h(1,p.inject(f.injectableTypes.NavigatorMenuBar)),h(2,p.inject(f.injectableTypes.TerminalPanel)),h(3,p.inject(f.injectableTypes.InfrastructureMenu)),h(4,p.inject(f.injectableTypes.NavigatorStatusFooter)),h(5,p.inject(f.injectableTypes.Routes)),d("design:paramtypes",["function"==typeof(i=void 0!==m.FileTree&&m.FileTree)?i:Object,"function"==typeof(s=void 0!==w.NavigatorMenuBar&&w.NavigatorMenuBar)?s:Object,"function"==typeof(o=void 0!==y.TerminalPanel&&y.TerminalPanel)?o:Object,"function"==typeof(a=void 0!==v.InfrastructureMenu&&v.InfrastructureMenu)?a:Object,"function"==typeof(r=void 0!==C.NavigatorStatusFooter&&C.NavigatorStatusFooter)?r:Object,"function"==typeof(c=void 0!==b.Routes&&b.Routes)?c:Object])],I),t.NavigatorComponent=I},219:function(e,t,n){"use strict";var i,s,o,a,r,c,l,d=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},h=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileTree=void 0;const u=n(3),m=n(67),f=n(0),v=n(4),b=n(12),y=n(16),g=n(683),S=n(19),w=n(28),C=n(36),I=n(5),T=n(20),E=n(6),R=n(684),P=n(48),j=n(221);n(690);let L=class extends u.HtmlComponent{constructor(e,t,n,i,s,o,a){super(),this.classAttr="file-tree",this.fileIdToNode={},this.pathToFileId={},this.pathToNodeWithoutFileId={},this.inapplicableFileTreeDelete={},this.initialized=!1,this.ideService=e,this.appService=t,this.workspaceService=s,this.containerInfoStream=s.createContainerInfoStream(),this.userSession=n,this.editorPanel=i,this.contextMenu=o,this.directoryNodeFactory=a,this.rootNode=this.directoryNodeFactory.create("",!0),this.subscribeForSelectedFileUpdates()}async afterEveryRender(){const e=await this.userSession.getActiveAppId();this.rootNode.renderTo(this),this.setProjectName(e),this.subscribeForServerUpdates(e),await this.contextMenu.renderTo(".main-content");const t=this;this.getRootElement().addEventListener("contextmenu",(function(e){e.preventDefault(),e.target===this&&t.contextMenu.open(t.rootNode.path,e)}))}async subscribeForServerUpdates(e){await this.userSession.getAuthentication();let t=this.ideService.createFileTreeUpdateStream();this.bindFileTreeUpdateStream(t,e),E.UserSession.getInstance().onActiveAppIdChange(e=>{t.complete(b.getOk()),this.clear(),this.hide(),f.has(e)&&(t=this.ideService.createFileTreeUpdateStream(),this.bindFileTreeUpdateStream(t,e),this.setProjectName(e),this.show())})}bindFileTreeUpdateStream(e,t){this.containerRunning(t).then(()=>e.start({appId:t})),e.onMessage(async e=>{this.applyUpdate(e),e.replace&&this.selectFileFromLastActiveTab()}),e.onCompleted(async n=>{n.notOk()&&e.start({appId:t})})}getNodeByFileIdOrPath(e){return f.has(this.fileIdToNode[e])?this.fileIdToNode[e]:this.fileIdToNode[this.pathToFileId[e]]}selectFileFromLastActiveTab(){const e=C.safeLocalStorage.getItem(T.CACHED_ACTIVE_EDITOR_TAB_ID);f.has(e)&&this.editorPanel.showTabByPathOrFileId(e)}subscribeForSelectedFileUpdates(){this.editorPanel.onShowInEditor(e=>{f.has(this.selectedFile)&&this.selectedFile.toggleSelect(),this.selectedFile=this.getNodeByFileIdOrPath(e),f.has(this.selectedFile)&&this.selectedFile.toggleSelect(this.initialized),this.initialized||(this.initialized=!0)}),this.editorPanel.onTabOpenOrCloseEvent(e=>{const t=this.getNodeByFileIdOrPath(e);f.has(this.selectedFile)&&t===this.selectedFile&&(this.selectedFile.toggleSelect(),this.selectedFile=void 0)})}async containerRunning(e){return this.containerInfoStream.complete(b.getOk()),this.containerInfoStream=this.workspaceService.createContainerInfoStream(),this.containerInfoStream.start({appId:e}),new Promise(e=>{this.containerInfoStream.onMessage(async t=>{var n;"running"===(null===(n=null==t?void 0:t.containerInfo)||void 0===n?void 0:n.status)&&e()})})}async setProjectName(e){const t=(await this.appService.getApp({id:e})).getValue().name;this.rootNode.setDescription(t)}async applyUpdate(e){e.replace&&this.clear(),m.forEachProperty(e.indexes,(e,t)=>{f.has(t)?(f.has(this.fileIdToNode[e])&&this.deleteRecursively(e),this.insertNode(e,t)):this.deleteRecursively(e)})}clear(){this.derefAndDestroyChildren(this.rootNode),this.rootNode.unrefAllChildren(),this.inapplicableFileTreeDelete={}}deleteRecursively(e){const t=this.fileIdToNode[e];f.has(t)?this.derefAndDestroyRecursively(t):this.inapplicableFileTreeDelete[e]=1}derefAndDestroyRecursively(e){e.destroy(),delete this.pathToFileId[e.path],delete this.pathToNodeWithoutFileId[e.path],f.has(e.fileId)&&delete this.fileIdToNode[e.fileId],e.isDirectory()&&this.derefAndDestroyChildren(e)}derefAndDestroyChildren(e){e.getChildrenRecursively().forEach(this.derefAndDestroyRecursively.bind(this))}refNode(e){f.has(e.fileId)?(this.fileIdToNode[e.fileId]=e,this.pathToFileId[e.path]=e.fileId):this.pathToNodeWithoutFileId[e.path]=e}insertNode(e,t){var n;if(this.maybeUpgradePlaceholderDirectory(e,t))return;const i=t.path.split("/");if(f.has(this.inapplicableFileTreeDelete[e]))return;let s=t.isDirectory?this.directoryNodeFactory.create(t.path,!1,e):new R.FileNode(t.path,e,this.editorPanel,this.contextMenu);for(let e=i.length-1;e>=0;e--){if(this.refNode(s),0===e)return void this.rootNode.insertChild(s);const t=i.slice(0,e).join("/"),o=null!==(n=g.getIfDefined(this.pathToFileId[t],this.fileIdToNode))&&void 0!==n?n:this.pathToNodeWithoutFileId[t];if(f.has(o))return void o.insertChild(s);s=this.directoryNodeFactory.create(t,!1).insertChild(s)}}maybeUpgradePlaceholderDirectory(e,t){if(!t.isDirectory)return!1;const n=this.pathToNodeWithoutFileId[t.path];return!!f.has(n)&&(f.has(this.inapplicableFileTreeDelete[e])?(delete this.inapplicableFileTreeDelete[e],this.derefAndDestroyRecursively(n),!0):(n.setFileId(e),delete this.pathToNodeWithoutFileId[t.path],this.pathToFileId[t.path]=e,this.fileIdToNode[e]=n,!0))}};L=d([v.injectable(),p(0,v.inject(I.injectableTypes.IdeServiceStub)),p(1,v.inject(I.injectableTypes.AppServiceStub)),p(2,v.inject(I.injectableTypes.UserSession)),p(3,v.inject(I.injectableTypes.EditorPanel)),p(4,v.inject(I.injectableTypes.WorkspaceServiceStub)),p(5,v.inject(I.injectableTypes.FileTreeContextMenu)),p(6,v.inject(I.injectableTypes.NodeFactory)),h("design:paramtypes",["function"==typeof(i=void 0!==y.IdeServiceStub&&y.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==S.AppServiceStub&&S.AppServiceStub)?s:Object,"function"==typeof(o=void 0!==E.UserSession&&E.UserSession)?o:Object,"function"==typeof(a=void 0!==T.EditorPanel&&T.EditorPanel)?a:Object,"function"==typeof(r=void 0!==w.WorkspaceServiceStub&&w.WorkspaceServiceStub)?r:Object,"function"==typeof(c=void 0!==P.FileTreeContextMenu&&P.FileTreeContextMenu)?c:Object,"function"==typeof(l=void 0!==j.DirectoryNodeFactory&&j.DirectoryNodeFactory)?l:Object])],L),t.FileTree=L},220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractNode=t.PATH_DATA_TRANSFER_TYPE=void 0;const i=n(3),s=n(0),o=n(122);n(686);t.PATH_DATA_TRANSFER_TYPE=navigator.userAgent.includes("Firefox")?"text/x-file-path":"text";class a extends i.HtmlComponent{constructor(e,t,n){super(),this.classAttr="tree-node",this.isDirectory_=e,this.path=t,this.name=o.fileName(t),this.contextMenu=n,this.level=""===t?0:t.split("/").length}get fileId(){return this._fileId}setFileId(e){return this._fileId=e,this}isFile(){return!this.isDirectory_}isDirectory(){return this.isDirectory_}async destroy(){super.destroy(),s.has(this.parentDirectory)&&this.parentDirectory.unrefChild(this)}setDescription(e){return this.description=e,this.isRendered()&&s.has(this.descriptionElement)&&(this.descriptionElement.innerText=this.description),this}setParentDirectory(e){return this.parentDirectory=e,this}openParentDirectories(){s.has(this.parentDirectory)&&(this.parentDirectory.isOpen||this.parentDirectory.open(),this.parentDirectory.openParentDirectories())}getIndentInPixels(){return 16*this.level+(this.isDirectory()?0:16)+"px"}async afterEveryRender(){this.descriptionElement=this.findInScope(".description"),s.has(this.description)&&(this.descriptionElement.innerText=this.description),this.iconElement=this.findInScope(".icon"),this.renderIcon();const e=this.findInScope(".entry");e.addEventListener("contextmenu",e=>{e.preventDefault(),this.contextMenu.open(this.path,e)}),this.setUpDragAndDrop(e)}setIcon(e){return this.icon=e,this.renderIcon()}renderIcon(){var e;return null===(e=this.icon)||void 0===e||e.then(e=>{this.isRendered()&&s.has(this.iconElement)&&(this.iconElement.innerHTML=e.default)}),this}setUpDragAndDrop(e){e.addEventListener("dragstart",n=>{s.has(this._fileId)&&s.has(n.dataTransfer)?(n.dataTransfer.items.clear(),n.dataTransfer.items.add(this.path,t.PATH_DATA_TRANSFER_TYPE),e.classList.add("drag")):n.preventDefault()}),e.addEventListener("dragend",()=>e.classList.remove("drag"))}}t.AbstractNode=a},221:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DirectoryNodeFactory=void 0;const c=n(4),l=n(0),d=n(16),h=n(5),p=n(688),u=n(48);let m=class{constructor(e,t){this.contextMenu=e,this.ideService=t}create(e,t,n){const i=new p.DirectoryNode(e,this.contextMenu,this.ideService,t);return l.has(n)&&i.setFileId(n),i}};m=o([c.injectable(),r(0,c.inject(h.injectableTypes.FileTreeContextMenu)),r(1,c.inject(h.injectableTypes.IdeServiceStub)),a("design:paramtypes",["function"==typeof(i=void 0!==u.FileTreeContextMenu&&u.FileTreeContextMenu)?i:Object,"function"==typeof(s=void 0!==d.IdeServiceStub&&d.IdeServiceStub)?s:Object])],m),t.DirectoryNodeFactory=m},222:function(e,t,n){"use strict";var i,s,o,a,r,c=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InfrastructureMenu=void 0;const h=n(4),p=n(3),u=n(10),m=n(5),f=n(81),v=n(223),b=n(226),y=n(159);n(716);let g=class extends p.HtmlComponent{constructor(e,t,n,i,s){super(),this.classAttr="infrastructure-menu",this.router=e,this.domainComponent=t,this.monitoringComponent=n,this.environmentVariableComponent=i,this.databasesComponent=s}async destroy(e){return await this.domainComponent.destroy(),await this.monitoringComponent.destroy(),await this.environmentVariableComponent.destroy(),super.destroy(e)}async afterEveryRender(){await super.afterEveryRender(),await this.addInfrastructureComponent(this.domainComponent),await this.addInfrastructureComponent(this.monitoringComponent),await this.addInfrastructureComponent(this.environmentVariableComponent),await this.addInfrastructureComponent(this.databasesComponent)}async addInfrastructureComponent(e){(await new S(e).renderTo(this.getRootElement())).onShow(()=>this.router.setUrl(e.getRoute(),!1))}};g=c([h.injectable(),d(0,h.inject(m.injectableTypes.Router)),d(1,h.inject(m.injectableTypes.DomainInfrastructureComponent)),d(2,h.inject(m.injectableTypes.MonitoringInfrastructureComponent)),d(3,h.inject(m.injectableTypes.EnvironmentVariablesInfrastructureComponent)),d(4,h.inject(m.injectableTypes.SQLiteInfrastructureComponent)),l("design:paramtypes",["function"==typeof(i=void 0!==u.Router&&u.Router)?i:Object,"function"==typeof(s=void 0!==f.DomainInfrastructureComponent&&f.DomainInfrastructureComponent)?s:Object,"function"==typeof(o=void 0!==v.MonitoringInfrastructureComponent&&v.MonitoringInfrastructureComponent)?o:Object,"function"==typeof(a=void 0!==b.EnvironmentVariablesInfrastructureComponent&&b.EnvironmentVariablesInfrastructureComponent)?a:Object,"function"==typeof(r=void 0!==y.SQLiteInfrastructureComponent&&y.SQLiteInfrastructureComponent)?r:Object])],g),t.InfrastructureMenu=g;class S extends p.HtmlComponent{constructor(e){super(),this.classAttr="entry",this.showListeners=[],this.htmlContent=`\n            <div class="icon">${e.getIcon()}</div>\n            <span>${e.getName()}</span>\n        `}async renderTo(e,t){return await super.renderTo(e,t),this.getRootElement().addEventListener("click",()=>{this.showListeners.forEach(e=>e())}),this}onShow(e){this.showListeners.push(e)}}},223:function(e,t,n){"use strict";var i,s,o,a,r=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MonitoringInfrastructureComponent=void 0;const h=n(4),p=d(n(136)),u=n(10),m=n(37),f=n(0),v=n(224),b=n(698),y=n(28),g=n(699),S=n(7),w=n(11),C=n(5),I=n(69),T=n(20),E=n(700),R=n(137);n(709);const P={lastHour:{displayName:"1 hour",durationInSeconds:g.secondsInAnHour},lastSixHours:{displayName:"6 hours",durationInSeconds:6*g.secondsInAnHour},lastDay:{displayName:"1 day",durationInSeconds:m.secondsInADay},lastWeek:{displayName:"7 days",durationInSeconds:m.secondsInAWeek},lastTwoWeeks:{displayName:"14 days",durationInSeconds:2*m.secondsInAWeek}};let j=class extends I.InfrastructureComponent{constructor(e,t,n,i){super(t,n,i),this.synchronizedChartsElements=[],this.interval=P.lastHour.durationInSeconds,this.customIntervalSelected=!1,this.htmlContent=`\n        <div class="top-row">\n            <h1>\n                <span class="title">Monitoring</span>\n            </h1>\n        </div>\n        <div class="monitoring-container hidden">\n            <div class="interval-interactors">\n                <select class="monitoring-interval" name="monitoring-interval">\n                    ${L()}\n                </select>\n                <button class="update-charts">${S.Icon.Reload}</button>\n            </div>\n            <div class="charts-container">\n                <div class="cpu-chart-container"></div>\n                <div class="memory-chart-container"></div>\n                <div class="disk-chart-container"></div>\n            </div>\n        </div>\n        <div class="spinner-container">\n            <div class="spinner-wrapper">\n                <div class="spinner-animation"></div>\n                <div class="chart-loading-message">Loading Data...</div>\n            </div>\n        </div>\n        `,this.classAttr="monitoring-infrastructure-component",this.workspaceService=e,this.cpuSeriesChart=this.createSynchronizedChartElement(b.ResourceType.CPU),this.memorySeriesChart=this.createSynchronizedChartElement(b.ResourceType.Memory),this.diskSeriesChart=this.createSynchronizedChartElement(b.ResourceType.DiskUsage)}onResize(){this.synchronizedChartsElements.forEach(e=>e.getChart().reflow())}getName(){return"Monitoring"}getIcon(){return S.Icon.Monitoring}getRoute(){return this.routes.infrastructureMonitoring}async destroy(e){for(const t of this.synchronizedChartsElements)await t.destroy(e);await super.destroy(e)}async afterEveryRender(){await super.afterEveryRender(),Promise.all([this.cpuSeriesChart.renderTo(".cpu-chart-container"),this.memorySeriesChart.renderTo(".memory-chart-container"),this.diskSeriesChart.renderTo(".disk-chart-container")]).then(()=>{this.findInScope(".monitoring-container").classList.remove("hidden"),this.findInScope(".spinner-container").classList.add("hidden"),this.synchronizeCharts()}),this.findInScope(".monitoring-interval").addEventListener("change",this.onDefaultIntervalChange.bind(this)),this.findInScope(".update-charts").addEventListener("click",this.refreshInterval.bind(this))}createSynchronizedChartElement(e){const t=new E.LiveMonitoringChart(this.workspaceService,e,this.calcIntervalBounds(this.interval));return t.setZoomListener(this.synchronizeOnZoom.bind(this)),this.synchronizedChartsElements.push(t),t}async onDefaultIntervalChange(e){this.resetZoomedInterval(),this.showRefreshButton(!0),this.findInScope(".update-charts").classList.remove("hidden");const t=e.target.value;this.interval=P[t].durationInSeconds,await this.updateCharts(this.calcIntervalBounds(this.interval))}async updateCharts(e){this.findInScope(".update-charts").disabled=!0;const t=[],n=[];for(const i of this.synchronizedChartsElements){t.push(i.updateSeriesData(e));const s=i.getChart();s.setLoadingMode(!0),n.push(s)}return Promise.all(t).then(()=>{for(const e of n)e.setLoadingMode(!1),this.findInScope(".update-charts").disabled=!1})}synchronizeCharts(){const e=this.findInScope(".charts-container");["mousemove","touchmove","touchstart"].forEach(t=>{e.addEventListener(t,this.synchronizeBehaviorInsideContainer.bind(this))}),e.addEventListener("mouseleave",this.synchronizeMouseOutBehavior.bind(this))}synchronizeBehaviorInsideContainer(e){this.synchronizedChartsElements.forEach(t=>{const n=t.getChart(),i=n.pointer.normalize(e),s=[];n.series.forEach(e=>{const t=e.searchPoint(i,!0);f.has(t)&&s.push(t)});let o=0;s.forEach((e,t)=>{e.series.visible||(s.splice(t-o,1),o++)}),s.length&&(n.tooltip.refresh(s),n.xAxis[0].drawCrosshair(i,s[0]))})}synchronizeMouseOutBehavior(e){this.synchronizedChartsElements.forEach(t=>{const n=t.getChart(),i=n.pointer.normalize(e);n.series.forEach(e=>{const t=e.searchPoint(i,!0);f.has(t)&&(t.onMouseOut(),t.setState(""))}),n.tooltip.hide(),n.xAxis[0].hideCrosshair()})}synchronizeOnZoom(e){this.updateCharts(e).then(()=>this.showZoomedIntervalInSelectElement(e))}showZoomedIntervalInSelectElement(e){const{start:t,end:n}=e;this.resetZoomedInterval();const i=p.default.dateFormat("%Y-%m-%d %H:%M:%S",R.adjustTimestampToTimezone(1e3*t)),s=p.default.dateFormat("%Y-%m-%d %H:%M:%S",R.adjustTimestampToTimezone(1e3*n)),o=this.findInScope(".monitoring-interval"),a=document.createElement("option");a.text=`${i} to ${s}`,a.selected=!0,a.hidden=!0,a.id="custom-interval",o.add(a,o[0]),this.showRefreshButton(!1),this.customIntervalSelected=!0}resetZoomedInterval(){this.customIntervalSelected&&(this.findInScope("#custom-interval").remove(),this.customIntervalSelected=!1)}showRefreshButton(e){const t=this.findInScope(".update-charts").classList;e?t.remove("hidden"):t.add("hidden")}async refreshInterval(){this.updateCharts(this.calcIntervalBounds(this.interval))}calcIntervalBounds(e){const t=Date.now()/1e3;return{start:Math.floor(t-e),end:Math.floor(t)}}};j=r([h.injectable(),l(0,h.inject(C.injectableTypes.WorkspaceServiceStub)),l(1,h.inject(C.injectableTypes.Router)),l(2,h.inject(C.injectableTypes.Routes)),l(3,h.inject(C.injectableTypes.EditorPanel)),c("design:paramtypes",["function"==typeof(i=void 0!==y.WorkspaceServiceStub&&y.WorkspaceServiceStub)?i:Object,"function"==typeof(s=void 0!==u.Router&&u.Router)?s:Object,"function"==typeof(o=void 0!==w.Routes&&w.Routes)?o:Object,"function"==typeof(a=void 0!==T.EditorPanel&&T.EditorPanel)?a:Object])],j),t.MonitoringInfrastructureComponent=j;const L=()=>v.mapEachProperty(P,(e,t)=>`<option value="${e}">Last ${t.displayName}</option>`)},225:function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.RESOURCE_MAP=t.UnitFormat=void 0,function(e){e[e.Bytes=0]="Bytes",e[e.Percentage=1]="Percentage"}(i=t.UnitFormat||(t.UnitFormat={})),t.RESOURCE_MAP={cpu:{displayName:"CPU",format:i.Percentage},memory:{displayName:"Memory",format:i.Bytes},disk:{displayName:"Disk",format:i.Bytes}}},226:function(e,t,n){"use strict";var i,s,o,a,r,c=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariablesInfrastructureComponent=void 0;const h=n(4),p=n(10),u=n(19),m=n(69),f=n(7),v=n(11),b=n(5),y=n(20),g=n(6),S=n(711);n(714);let w=class extends m.InfrastructureComponent{constructor(e,t,n,i,s){super(t,n,i),this.htmlContent='\n        <div class="top-row">\n            <h1>\n                <span class="title">Environment Variables</span>\n            </h1>\n            <div class="button-container">\n                <button class="button-medium button-light" id="new-variable-button">\n                    New Variable +\n                </button>\n            </div>\n        </div>\n        <div class="environment-variables-table"></div>\n    ',this.classAttr="environment-variables-infrastructure-component",this.appService=e,this.userSession=s}getIcon(){return f.Icon.Key}getName(){return"Environment Variables"}getRoute(){return this.routes.infrastructureEnvironmentVariables}async afterEveryRender(){await super.afterEveryRender(),this.environmentVariablesTable=await new S.EnvironmentVariablesTable(this.appService,this.userSession).renderTo(this.findInScope(".environment-variables-table")),this.findInScope("#new-variable-button").addEventListener("click",()=>{this.environmentVariablesTable.createNewEnvVariable()})}};w=c([h.injectable(),d(0,h.inject(b.injectableTypes.AppServiceStub)),d(1,h.inject(b.injectableTypes.Router)),d(2,h.inject(b.injectableTypes.Routes)),d(3,h.inject(b.injectableTypes.EditorPanel)),d(4,h.inject(b.injectableTypes.UserSession)),l("design:paramtypes",["function"==typeof(i=void 0!==u.AppServiceStub&&u.AppServiceStub)?i:Object,"function"==typeof(s=void 0!==p.Router&&p.Router)?s:Object,"function"==typeof(o=void 0!==v.Routes&&v.Routes)?o:Object,"function"==typeof(a=void 0!==y.EditorPanel&&y.EditorPanel)?a:Object,"function"==typeof(r=void 0!==g.UserSession&&g.UserSession)?r:Object])],w),t.EnvironmentVariablesInfrastructureComponent=w},227:function(e,t,n){"use strict";var i,s,o,a,r=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},c=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.NavigatorMenuBar=void 0;const d=n(4),h=n(3),p=n(70),u=n(49),m=n(7),f=n(59),v=n(5),b=n(20),y=n(138),g=n(139);n(726);let S=class extends h.HtmlComponent{constructor(e,t,n,i){super(),this.htmlContent=`\n        <div class="menu">\n            <div class="inner-circle"></div>\n            <div class="outer-circle">\n                <div class="icon apps with-tooltip">\n                    <span class="tooltiptext" style="margin-left: 30px; margin-top: -3px">My apps</span>\n                    ${m.Icon.Apps}\n                </div>\n                <div class="icon settings with-tooltip">\n                    <span class="tooltiptext" style="margin-left: 30px; margin-top: -3px">Settings</span>\n                    ${m.Icon.Settings}\n                </div>\n                <div class="icon signout with-tooltip">\n                    <span class="tooltiptext" style="margin-left: 30px; margin-top: -3px">Signout</span>\n                    ${m.Icon.Signout}\n                </div>\n            </div>\n        </div>\n        <div class='row'>\n            <div class="menu-icons">\n                <div class="icon icon-open">\n                    ${m.Icon.HamburgerMenu}\n                </div>\n                <div class="icon icon-close">\n                    ${m.Icon.Close}\n                </div>\n            </div>\n        </div>\n    `,this.classAttr="menu-bar",this.mainMenu=e,this.editorPanel=t,this.codeSearchModal=n,this.codeSearchInput=i,this.codeSearchInput.setSearchOnChange(!0)}async afterEveryRender(){await super.afterEveryRender(),this.findInScope(".menu-icons").addEventListener("click",e=>{e.stopPropagation(),this.getRootElement().classList.toggle("active")}),this.findInScope(".icon.apps").addEventListener("click",e=>{var t;e.stopPropagation(),null===(t=document.querySelector(".editor-tooltip"))||void 0===t||t.remove(),this.mainMenu.navigateToApps(),this.getRootElement().classList.remove("active")}),this.findInScope(".icon.settings").addEventListener("click",e=>{e.stopPropagation(),this.editorPanel.showSettings(),this.getRootElement().classList.remove("active")}),this.findInScope(".icon.signout").addEventListener("click",e=>{e.stopPropagation(),f.signOut()}),document.addEventListener("click",e=>{this.findInScope(".menu").contains(e.target)||(e.stopPropagation(),this.getRootElement().classList.remove("active"))})}async afterEveryRenderSync(){await super.afterEveryRenderSync(),this.codeSearchInput.renderTo(this.findInScope(".row"),p.RenderLocation.IntoEnd).then(),this.codeSearchInput.setSearchListener(e=>{this.codeSearchModal.show(),this.codeSearchModal.setQuery(e),this.codeSearchInput.clear()})}};S=r([d.injectable(),l(0,d.inject(v.injectableTypes.MainMenu)),l(1,d.inject(v.injectableTypes.EditorPanel)),l(2,d.inject(v.injectableTypes.CodeSearchModal)),l(3,d.inject(v.injectableTypes.CodeSearchInput)),c("design:paramtypes",["function"==typeof(i=void 0!==u.MainMenu&&u.MainMenu)?i:Object,"function"==typeof(s=void 0!==b.EditorPanel&&b.EditorPanel)?s:Object,"function"==typeof(o=void 0!==g.CodeSearchModal&&g.CodeSearchModal)?o:Object,"function"==typeof(a=void 0!==y.CodeSearchInput&&y.CodeSearchInput)?a:Object])],S),t.NavigatorMenuBar=S},237:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=Date.now();n(143);const o=n(4),a=i(n(61)),r=n(10),c=n(15),l=n(89),d=n(65),h=n(154),p=n(0),u=n(308),m=n(16),f=n(23),v=n(92),b=n(45),y=n(19),g=n(66),S=n(311),w=n(94),C=n(157),I=n(312),T=n(313),E=n(314),R=n(159),P=n(214),j=n(215),L=n(160),M=n(56),A=n(671),k=n(59),x=n(216),_=n(680),O=n(20),D=n(218),F=n(49),U=n(227),N=n(228),H=n(229),B=n(126),V=n(738),q=n(140),z=n(230),$=n(127),Q=n(5),W=n(6),K=n(232),G=n(233),Y=n(206),Z=n(747),J=n(124),X=n(205),ee=n(57),te=n(58),ne=n(208),ie=n(210),se=n(211),oe=n(202),ae=n(125),re=n(204),ce=n(198),le=n(751),de=n(222),he=n(81),pe=n(219),ue=n(185),me=n(11),fe=n(128),ve=n(223),be=n(226),ye=n(186),ge=n(138),Se=n(139),we=n(48),Ce=n(221);n(752);const Ie=new o.Container({skipBaseClassChecks:!0}),Te=[],Ee=e=>{const t=new h.ReconnectingWebSocket(e,void 0,L.config.reconnectConfig);return Te.push(t),t.connect(),new l.WebSocketEndpoint(t)},Re={authService:new f.AuthServiceStub(new l.HttpEndpoint(L.config.authServiceUrl)),ideService:new m.IdeServiceStub(Ee(L.config.ideServiceWsUrl)),workspaceService:new I.WorkspaceServiceBrowserStub(Ee(L.config.workspaceServiceUrl)),languageServer:new v.LanguageServerStub(Ee(L.config.languageServerUrl)),paymentService:new b.PaymentServiceStub(Ee(L.config.paymentServiceUrl)),appService:new y.AppServiceStub(Ee(L.config.appServiceUrl)),userActivity:new w.UserActivityBrowserStub(new l.HttpEndpoint(L.config.userActivityUrl)),sqliteService:new g.SQLiteServiceStub(Ee(L.config.sqliteServiceUrl))};(async()=>{T.hasUserConsentCookie()&&(le.enableGoogleAnalytics(),E.enableUxTracking()),Ie.bind(Q.injectableTypes.IdeServiceStub).toConstantValue(Re.ideService),Ie.bind(Q.injectableTypes.LanguageServerStub).toConstantValue(Re.languageServer),Ie.bind(Q.injectableTypes.PaymentServiceStub).toConstantValue(Re.paymentService),Ie.bind(Q.injectableTypes.AppServiceStub).toConstantValue(Re.appService),Ie.bind(Q.injectableTypes.WorkspaceServiceStub).toConstantValue(Re.workspaceService),Ie.bind(Q.injectableTypes.AuthServiceStub).toConstantValue(Re.authService),Ie.bind(Q.injectableTypes.UserActivityStub).toConstantValue(Re.userActivity),Ie.bind(Q.injectableTypes.SQLiteServiceStub).toConstantValue(Re.sqliteService),Ie.bind(Q.injectableTypes.BrowserConfigProvider).to(fe.BrowserConfigProvider).inSingletonScope(),Ie.bind(Q.injectableTypes.FirebaseAppProvider).to(ye.FirebaseAppProvider).inSingletonScope(),Ie.bind(Q.injectableTypes.StartupTimeTracker).toConstantValue(new j.StartupTimeTracker(s)),Ie.bind(Q.injectableTypes.AppTasksQueue).toConstantValue(new a.default({concurrency:1})),Ie.bind(Q.injectableTypes.Routes).toConstantValue(me.routes),Ie.bind(Q.injectableTypes.Router).toConstantValue(r.Router.create()),Ie.bind(Q.injectableTypes.StripeProvider).to(Y.StripeProvider).inSingletonScope(),Ie.bind(Q.injectableTypes.TerminalPanel).to(M.TerminalPanel).inSingletonScope(),Ie.bind(Q.injectableTypes.SignupComponent).to(N.SignupComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.SigninComponent).to(B.SigninComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.AuthIllustrationComponent).to(H.AuthIllustrationComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.AuthModal).to(V.AuthModal).inSingletonScope(),Ie.bind(Q.injectableTypes.ConfirmEmailModal).to(q.ConfirmEmailModal).inSingletonScope(),Ie.bind(Q.injectableTypes.UpdateEmailConfirmationModal).to(z.UpdateEmailConfirmationModal).inSingletonScope(),Ie.bind(Q.injectableTypes.OAuthComponent).to($.OAuthComponent),Ie.bind(Q.injectableTypes.PerformPasswordResetModal).to(G.PerformPasswordResetModal).inSingletonScope(),Ie.bind(Q.injectableTypes.MainMenu).to(F.MainMenu).inSingletonScope(),Ie.bind(Q.injectableTypes.NavigatorMenuBar).to(U.NavigatorMenuBar).inSingletonScope(),Ie.bind(Q.injectableTypes.EditorPanel).to(O.EditorPanel).inSingletonScope(),Ie.bind(Q.injectableTypes.NavigatorComponent).to(D.NavigatorComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.HoveringMenu).to(x.HoveringMenu).inSingletonScope(),Ie.bind(Q.injectableTypes.EmailConfirmationModal).to(K.EmailConfirmationModal).inSingletonScope(),Ie.bind(Q.injectableTypes.MainLayout).to(Z.MainLayout).inSingletonScope(),Ie.bind(Q.injectableTypes.MenuTopbar).to(J.MenuTopbar).whenInjectedInto(X.AppsPanel),Ie.bind(Q.injectableTypes.AppsPanel).to(X.AppsPanel).inSingletonScope(),Ie.bind(Q.injectableTypes.MenuTopbar).to(J.MenuTopbar).whenInjectedInto(oe.ProfilePanel),Ie.bind(Q.injectableTypes.ProfilePanel).to(oe.ProfilePanel).inSingletonScope(),Ie.bind(Q.injectableTypes.AppsHelper).to(ee.AppsHelper).inSingletonScope(),Ie.bind(Q.injectableTypes.AppsTable).to(te.AppsTable).inSingletonScope(),Ie.bind(Q.injectableTypes.UserProfileComponent).to(ae.UserProfileComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.ChangeEmailComponent).to(re.ChangeEmailComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.CreateAppComponent).to(ne.CreateAppComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.UpdateAppComponent).to(ie.UpdateAppComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.DeleteAppComponent).to(se.DeleteAppComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.EditorPanelEmptySpaceHint).to(ce.EditorPanelEmptySpaceHint).inSingletonScope(),Ie.bind(Q.injectableTypes.UserSession).toConstantValue(W.UserSession.getInstance()),Ie.bind(Q.injectableTypes.InfrastructureMenu).to(de.InfrastructureMenu).inSingletonScope(),Ie.bind(Q.injectableTypes.DomainInfrastructureComponent).to(he.DomainInfrastructureComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.MonitoringInfrastructureComponent).to(ve.MonitoringInfrastructureComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.EnvironmentVariablesInfrastructureComponent).to(be.EnvironmentVariablesInfrastructureComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.SQLiteInfrastructureComponent).to(R.SQLiteInfrastructureComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.FileTree).to(pe.FileTree).inSingletonScope(),Ie.bind(Q.injectableTypes.FileTreeContextMenu).to(we.FileTreeContextMenu).inSingletonScope(),Ie.bind(Q.injectableTypes.UserPreferencesComponent).to(ue.UserPreferencesComponent).inSingletonScope(),Ie.bind(Q.injectableTypes.CodeSearchInput).to(ge.CodeSearchInput),Ie.bind(Q.injectableTypes.CodeSearchModal).to(Se.CodeSearchModal).inSingletonScope(),Ie.bind(Q.injectableTypes.NavigatorStatusFooter).to(P.NavigatorStatusFooter).inSingletonScope(),Ie.bind(Q.injectableTypes.NodeFactory).to(Ce.DirectoryNodeFactory).inSingletonScope(),(()=>{const e=Ie.get(Q.injectableTypes.Router);e.onUrlChange(()=>W.UserSession.logActivity(S.pageView)),e.onUrlChange(async e=>{const t=new URLSearchParams(e.search).get("code");if(p.has(t)){const e=Ie.get(Q.injectableTypes.SigninComponent);e.setLoading(!0);const n=await Ie.get(Q.injectableTypes.AuthServiceStub).authorizeWithOAuth({code:t});if(n.notOk())return void e.setLoading(!1);const i=n.getValue();if(await e.setAuthentication(i),await e.destroy(),i.isNewUser){const e=Ie.get(Q.injectableTypes.MainMenu);e.rendered().then(()=>e.navigateToApps()),W.UserSession.logActivity(C.createSignUpEvent(i.provider))}}},r.path(me.routes.default))})(),await A.authenticateServices("body",location,Ie.get(Q.injectableTypes.SigninComponent),Ie.get(Q.injectableTypes.AuthModal),Re.authService,...d.values(u.without(Re,"authService"))),(async()=>{var e;await W.UserSession.getInstance().getAuthentication();const t=await Re.appService.listApps();t.notOk()&&t.getErrorMessage().includes("JsonWebTokenError")&&k.signOut();const n=t.getValue();if(c.isEmpty(n))await W.UserSession.getInstance().setActiveAppId(null);else{const t=await W.UserSession.getInstance().getLastActiveAppIdBySameUser(),i=null!==(e=n.find(e=>e.id===t))&&void 0!==e?e:n[0];await W.UserSession.getInstance().setActiveAppId(i.id)}})(),W.UserSession.getInstance().onAuthenticated(async()=>{await Re.workspaceService.rescaleContainer({appId:await W.UserSession.getInstance().getActiveAppId()}),W.UserSession.getInstance().onActiveAppIdChange(async e=>{p.has(e)&&await Re.workspaceService.rescaleContainer({appId:e})})}),(async()=>{await Ie.get(Q.injectableTypes.MainLayout).renderTo("body"),await new _.OfflineBanner(...Te).renderTo("body")})()})()},48:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileTreeContextMenu=t.alertIfError=void 0;const c=n(4),l=n(0),d=n(15),h=n(16),p=n(122),u=n(565),m=n(6),f=n(5),v=n(20),b=n(79),y=n(121),g=n(120),S=n(123);class w extends u.ContextMenuItem{constructor(e){super("Rename",e)}}class C extends u.ContextMenuItem{constructor(e){super("Move",e)}}class I extends u.ContextMenuItem{constructor(e){super("Duplicate",e)}}class T extends u.ContextMenuItem{constructor(e){super("Delete",e)}}class E extends u.ContextMenuItem{constructor(e){super("New Directory",e)}}class R extends u.ContextMenuItem{constructor(e){super("New File",e)}}t.alertIfError=e=>(e.notOk()&&alert(e.getErrorMessage()),e.notOk());let P=class extends u.ContextMenu{constructor(e,n){super(new R(()=>b.showModal(new g.CreateFileModal(e,this.filePath))),new E(()=>b.showModal(new S.CreateDirectoryModal(e,this.filePath))),new T(async()=>!d.isEmpty(this.filePath)&&e.deleteFile({appId:await m.UserSession.getInstance().getActiveAppId(),path:this.filePath}).then(e=>{t.alertIfError(e)||this.editorPanel.closeTabByPathOrFileId(this.filePath)})),new I(async()=>{const n="Copy of "+p.fileName(this.filePath),i=this.filePath.replace(new RegExp(p.fileName(this.filePath)+"$"),n);setTimeout(()=>{!d.isEmpty(this.filePath)&&new y.FileTreeModal("Copy file to path",i,async n=>!d.isEmpty(n)&&e.copyFile({appId:await m.UserSession.getInstance().getActiveAppId(),path:this.filePath,newPath:n}).then(t.alertIfError)).renderTo(".main-content")},0)}),new C(async()=>{setTimeout(()=>{!d.isEmpty(this.filePath)&&new y.FileTreeModal("Move file to path",this.filePath,async n=>!d.isEmpty(n)&&e.moveFile({appId:await m.UserSession.getInstance().getActiveAppId(),path:this.filePath,newPath:n}).then(t.alertIfError)).renderTo(".main-content")},0)}),new w(async()=>{setTimeout(()=>{!d.isEmpty(this.filePath)&&new y.FileTreeModal("Rename file",this.filePath,async n=>!d.isEmpty(n)&&e.moveFile({appId:await m.UserSession.getInstance().getActiveAppId(),path:this.filePath,newPath:n}).then(t.alertIfError)).renderTo(".main-content")},0)})),this.editorPanel=n}open(e,t){this.show(),l.has(t)&&this.move(t.pageX,t.pageY),this.filePath=e}};P=o([c.injectable(),r(0,c.inject(f.injectableTypes.IdeServiceStub)),r(1,c.inject(f.injectableTypes.EditorPanel)),a("design:paramtypes",["function"==typeof(i=void 0!==h.IdeServiceStub&&h.IdeServiceStub)?i:Object,"function"==typeof(s=void 0!==v.EditorPanel&&v.EditorPanel)?s:Object])],P),t.FileTreeContextMenu=P},49:function(e,t,n){"use strict";var i,s,o,a,r,c,l=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MainMenu=void 0;const p=n(4),u=n(10),m=n(3),f=n(0),v=n(45),b=n(19),y=n(202),g=n(11),S=n(205),w=n(5),C=n(634),I=n(635),T=n(6),E=n(636),R=n(133);n(639);const P=/^https:\/\/github\.com\/.+\/.+$/;let j=class extends m.HtmlComponent{constructor(e,t,n,i,s,o){super(),this.htmlContent='<div class="modal"></div>',this.classAttr="main-menu",this.closable=!1,this.paymentService=i,this.appService=n,this.router=s,this.routes=o,this.leftbar=new E.MainMenuLeftbar(this.navigateToApps.bind(this),this.navigateToProfile.bind(this),this.showBilling.bind(this),this.closeMenu.bind(this)),this.appsPanel=e,this.profilePanel=t,this.keyUpListener=this.handleKeyUp.bind(this),document.addEventListener("keyup",this.keyUpListener),this.clickListener=this.handleClick.bind(this),document.addEventListener("click",this.clickListener),this.hide()}async destroy(e){f.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),f.has(this.clickListener)&&document.removeEventListener("click",this.clickListener),await super.destroy(e)}async navigateToMainMenu(){await this.navigateToApps()}async navigateToApps(){super.show(),this.leftbar.activateAppsItem(),this.router.setUrl(this.routes.apps,!0),this.profilePanel.hide(),await this.appsPanel.showAppsTable()}async navigateToProfile(){super.show(),this.leftbar.activateProfileItem(),this.router.setUrl(this.routes.profile,!0),this.appsPanel.hide(),await this.profilePanel.showProfile()}async navigateToChangeEmail(){super.show(),this.leftbar.activateProfileItem(),this.router.setUrl(this.routes.changeEmail,!0),this.appsPanel.hide(),await this.profilePanel.showChangeEmail()}async showCreateApp(){super.show(),this.leftbar.activateAppsItem(),this.profilePanel.hide(),await this.appsPanel.showCreateApp()}async showUpdateApp(e){super.show(),this.leftbar.activateAppsItem(),this.profilePanel.hide(),await this.appsPanel.showUpdateApp(e)}async showDeleteApp(e){super.show(),this.leftbar.activateAppsItem(),this.profilePanel.hide(),await this.appsPanel.showDeleteApp(e)}async showBilling(e=!1){return this.paymentService.createBillingPortalSession().then(t=>{const n=t.getValue();e?location.href=n.url:window.open(n.url)})}async afterEveryRenderSync(){this.bindRouting(),await this.leftbar.renderTo(this.findInScope(".modal")),await this.appsPanel.renderTo(this.findInScope(".modal")),await this.profilePanel.renderTo(this.findInScope(".modal"))}async afterEveryRender(){await T.UserSession.getInstance().getAuthentication(),T.UserSession.getInstance().onActiveAppIdChange(e=>{f.has(e)?(this.leftbar.showCloseButton(),this.closable=!0):(this.leftbar.hideCloseButton(),this.closable=!1,location.pathname.includes(this.routes.menu)||this.navigateToMainMenu())})}handleKeyUp(e){"Escape"===e.key&&(e.stopPropagation(),this.closeMenu())}handleClick(e){this.isBackgroundClick(e.target)&&(e.stopPropagation(),this.closeMenu())}isBackgroundClick(e){return this.getRootElement().contains(e)&&!this.findInScope(".modal").contains(e)}bindRouting(){this.router.onUrlChange(this.handleExternalRoute.bind(this),u.glob(`!${this.routes.menu}/**`)),this.router.onUrlChange(this.handleInternalRoute.bind(this),u.glob(this.routes.menu+"/**")),this.router.onUrlChange(this.navigateToMainMenu.bind(this),u.path(this.routes.menu)),this.router.onUrlChange(this.navigateToApps.bind(this),u.path(this.routes.apps)),this.router.onUrlChange(this.navigateToProfile.bind(this),u.path(this.routes.profile)),this.router.onUrlChange(this.navigateToChangeEmail.bind(this),u.path(this.routes.changeEmail)),this.router.onUrlChange(this.showCreateApp.bind(this),u.path(this.routes.createApp)),this.router.onUrlChange(this.handleUpdateAppRoute.bind(this),u.glob(I.replaceRouteParams(this.routes.updateApp,"*"))),this.router.onUrlChange(this.handleDeleteAppRoute.bind(this),u.glob(I.replaceRouteParams(this.routes.deleteApp,"*"))),this.router.onUrlChange(async e=>this.handleHash(e.hash),u.glob(this.routes.default+"*")),this.router.onUrlChange(()=>this.showBilling(!0),u.path(this.routes.billing))}async handleExternalRoute(){const e=T.UserSession.getInstance().getActiveAppIdIfSet();f.has(e)&&this.closeMenu()}async handleInternalRoute(){super.show(),this.maybeRecoverMenuSession()}async handleUpdateAppRoute(e){const t=parseInt(C.parseRouteParams(e.pathname,this.routes.updateApp).appId);(await this.appService.getApp({id:t})).ok()?await this.showUpdateApp(t):await this.navigateToApps()}async handleDeleteAppRoute(e){const t=parseInt(C.parseRouteParams(e.pathname,this.routes.deleteApp).appId);(await this.appService.getApp({id:t})).ok()?await this.showDeleteApp(t):await this.navigateToApps()}closeMenu(){this.isVisible()&&this.closable&&(this.router.setUrl(this.routes.default,!0),this.hide())}async handleHash(e){const t=e.replace("#","").replace(".git","");P.test(t)&&(this.navigateToApps(),await this.createAppFromGitUrl(t))}maybeRecoverMenuSession(){const e=R.retrieveMenuSession(),t=f.has(e)?e.pathname:null;if(!f.has(t))return;R.clearMenuSession(),this.navigateToApps(),t===this.routes.createApp&&this.appsPanel.executeAppCreation();const n=I.replaceRouteParams(this.routes.updateApp,"*");if(u.glob(n)({pathname:t})){const{appId:t,appName:n,hostingLookupKey:i}=e.data;this.appsPanel.executeAppUpdate(t,n,i)}}async createAppFromGitUrl(e){await this.appsPanel.createAppFromGitUrl(e)}};j=l([p.injectable(),h(0,p.inject(w.injectableTypes.AppsPanel)),h(1,p.inject(w.injectableTypes.ProfilePanel)),h(2,p.inject(w.injectableTypes.AppServiceStub)),h(3,p.inject(w.injectableTypes.PaymentServiceStub)),h(4,p.inject(w.injectableTypes.Router)),h(5,p.inject(w.injectableTypes.Routes)),d("design:paramtypes",["function"==typeof(i=void 0!==S.AppsPanel&&S.AppsPanel)?i:Object,"function"==typeof(s=void 0!==y.ProfilePanel&&y.ProfilePanel)?s:Object,"function"==typeof(o=void 0!==b.AppServiceStub&&b.AppServiceStub)?o:Object,"function"==typeof(a=void 0!==v.PaymentServiceStub&&v.PaymentServiceStub)?a:Object,"function"==typeof(r=void 0!==u.Router&&u.Router)?r:Object,"function"==typeof(c=void 0!==g.Routes&&g.Routes)?c:Object])],j),t.MainMenu=j},494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SQLQueryEditorLayout=void 0;const i=n(3),s=n(190),o=n(498),a=n(499),r=n(548);n(549),n(551);class c extends i.HtmlComponent{constructor(e,t,n,i,s){super(),this.classAttr="sqlite-query-editor-layout",this.queryEditorResultPanel=null,this.queryEditorEditorPanel=null,this.queryEditorDatabasePanel=null,this.sqliteService=t,this.userSession=e,this.ideService=n,this.path=i,this.name=s}async afterEveryRender(){const e=await this.userSession.getActiveAppId();this.queryEditorDatabasePanel=new r.QueryEditorDatabasePanel(this.sqliteService,this.path,this.name).setAppId(e),this.queryEditorEditorPanel=new a.QueryEditorEditorPanel(this.userSession,this.sqliteService,this.ideService,this.path).setAppId(e).setQueryResultListener(this.queryResultListener.bind(this)).setStopQueryListener(this.stopQueryListener.bind(this)),this.queryEditorResultPanel=new o.QueryEditorResultPanel,await new s.SplitPanel(this.queryEditorDatabasePanel,new s.SplitPanel(this.queryEditorEditorPanel,this.queryEditorResultPanel,"vertical",40),"horizontal",15).renderTo(this.getRootElement())}async queryResultListener(e){var t,n,i,s,o,a;null===(t=this.queryEditorResultPanel)||void 0===t||t.showSpinner();const r=(new Date).getTime(),c=await e;if(c.notOk())return void(null===(n=this.queryEditorResultPanel)||void 0===n||n.setMessage(c.getErrorMessage()).selectMessageTab());const l=c.getValue();null===(i=this.queryEditorResultPanel)||void 0===i||i.querySucceeded((new Date).getTime()-r),Array.isArray(l)?null===(s=this.queryEditorResultPanel)||void 0===s||s.renderResults(l).selectResultTab():(null===(o=this.queryEditorResultPanel)||void 0===o||o.setMessage("Total affected rows: "+l.changes).selectMessageTab(),null===(a=this.queryEditorDatabasePanel)||void 0===a||a.loadTableList())}async stopQueryListener(e){var t;(await e).notOk()||null===(t=this.queryEditorResultPanel)||void 0===t||t.setMessage("Query cancelled").selectMessageTab()}}t.SQLQueryEditorLayout=c},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryEditorResultPanel=void 0;const i=n(3),s=n(0),{DataTable:o}=n(767);class a extends i.HtmlComponent{constructor(){super(),this.htmlContent='\n        <div class="tab-selection">\n            <div class="tab-selector" id="result-tab">Results</div>\n            <div class="tab-selector selected" id="message-tab">Messages</div>\n        </div>\n        <div class="content-container">\n            <div class="spinner hidden"></div>\n            <div class="message-container">\n                You are connected to your database. Click "Run" to execute your first query.  \n            </div>\n            <div class="result-table-container hidden"></div>\n        </div>\n        <div class="quick-message-container">\n            Ready\n        </div>\n    ',this.classAttr="query-editor-result-panel",this.messageTab=null,this.resultTab=null,this.resultContainer=null,this.messageContainer=null,this.dataTable=null}querySucceeded(e){this.findInScope(".quick-message-container").innerText=`Query successful | ${e/1e3} seconds`}renderResults(e){this.hideSpinner(),s.has(this.dataTable)&&this.dataTable.destroy();const t=document.createElement("table");this.resultContainer.appendChild(t);const n=Object.keys(e[0]);let i={headings:n,data:e.map(e=>Object.values(e))};1===e.length&&Object.values(e[0]).every(e=>null===e)&&(i={headings:n,data:[]}),this.dataTable=new o(t,{data:i,paging:!1,layout:{top:"{search}",bottom:""},scrollY:"auto"});const a=this.findInScope(".dataTable-input");return a.readOnly=!0,a.onfocus=()=>a.readOnly=!1,this}setMessage(e){return this.hideSpinner(),this.messageContainer.innerText=e,this}selectMessageTab(){var e,t,n,i;this.messageTab.classList.contains("selected")||(null===(e=this.messageTab)||void 0===e||e.classList.add("selected"),null===(t=this.resultTab)||void 0===t||t.classList.remove("selected"),null===(n=this.messageContainer)||void 0===n||n.classList.remove("hidden"),null===(i=this.resultContainer)||void 0===i||i.classList.add("hidden"))}selectResultTab(){var e,t,n,i;this.resultTab.classList.contains("selected")||(null===(e=this.resultTab)||void 0===e||e.classList.add("selected"),null===(t=this.messageTab)||void 0===t||t.classList.remove("selected"),null===(n=this.resultContainer)||void 0===n||n.classList.remove("hidden"),null===(i=this.messageContainer)||void 0===i||i.classList.add("hidden"))}showSpinner(){this.findInScope(".spinner").classList.remove("hidden")}hideSpinner(){this.findInScope(".spinner").classList.add("hidden")}async afterEveryRender(){this.resultContainer=this.findInScope(".result-table-container"),this.messageContainer=this.findInScope(".message-container"),this.messageTab=this.findInScope("#message-tab"),this.messageTab.addEventListener("click",this.selectMessageTab.bind(this)),this.resultTab=this.findInScope("#result-tab"),this.resultTab.addEventListener("click",this.selectResultTab.bind(this))}}t.QueryEditorResultPanel=a},499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryEditorEditorPanel=void 0;const i=n(3),s=n(0),o=n(500),a=n(7);class r extends i.HtmlComponent{constructor(e,t,n,i){super(),this.htmlContent=`\n        <div class="button-container">\n            <div class="execute-cancel-button" id="execute">\n                <div class="icon icon-run">\n                    ${a.Icon.Run}\n                </div>\n                <span>Run</span>\n            </div>\n            <div class="execute-cancel-button" id="cancel">\n                <div class="icon icon-stop">\n                    ${a.Icon.Stop}\n                </div>\n                <span>Cancel Query</span>\n            </div>\n        </div>\n        <div class="editor-container">\n        </div>\n    `,this.classAttr="query-editor-editor-panel",this.appId=null,this.sqlEditor=null,this.userSession=e,this.sqliteService=t,this.ideService=n,this.databasePath=i}setAppId(e){return this.appId=e,this}setQueryResultListener(e){return this.queryResultListener=e,this}setStopQueryListener(e){return this.stopQueryListener=e,this}async afterEveryRender(){this.sqlEditor=await new o.SQLEditor(this.ideService,this.userSession).renderTo(this.findInScope(".editor-container"));const e=this.findInScope("#execute"),t=this.findInScope("#cancel");e.onclick=this.queryConnectedDatabase.bind(this),t.onclick=this.stopQuery.bind(this)}async queryConnectedDatabase(){s.has(this.queryResultListener)&&this.queryResultListener(this.sqliteService.querySQLiteDatabase({appId:this.appId,databasePath:this.databasePath,sqlQuery:this.sqlEditor.getEditorContent(),sqlParams:{}}))}async stopQuery(){s.has(this.stopQueryListener)&&this.stopQueryListener(await this.sqliteService.stopSQLiteQuery({appId:this.appId}))}}t.QueryEditorEditorPanel=r},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.injectableTypes=void 0,t.injectableTypes={IdeServiceStub:Symbol.for("IdeServiceStub"),WorkspaceServiceStub:Symbol.for("WorkspaceServiceStub"),AuthServiceStub:Symbol.for("AuthServiceStub"),LanguageServerStub:Symbol.for("LanguageServerStub"),PaymentServiceStub:Symbol.for("PaymentServiceStub"),AppServiceStub:Symbol.for("AppServiceStub"),UserActivityStub:Symbol.for("UserActivityStub"),Router:Symbol.for("Router"),EditorPanel:Symbol.for("EditorPanel"),TerminalPanel:Symbol.for("TerminalPanel"),EditorPanelEmptySpaceHint:Symbol.for("EditorPanelEmptySpaceHint"),SignupComponent:Symbol.for("SignupComponent"),SigninComponent:Symbol.for("SigninComponent"),AuthIllustrationComponent:Symbol.for("AuthIllustrationComponent"),AuthModal:Symbol.for("AuthModal"),ConfirmEmailModal:Symbol.for("ConfirmEmailModal"),UpdateEmailConfirmationModal:Symbol.for("UpdateEmailConfirmationModal"),OAuthComponent:Symbol.for("OAuthComponent"),PerformPasswordResetModal:Symbol.for("PerformPasswordResetModal"),StripeProvider:Symbol.for("StripeProvider"),MainMenu:Symbol.for("MainMenu"),NavigatorMenuBar:Symbol.for("NavigatorMenuBar"),NavigatorComponent:Symbol.for("NavigatorComponent"),HoveringMenu:Symbol.for("HoveringMenu"),EmailConfirmationModal:Symbol.for("EmailConfirmationModal"),MainLayout:Symbol.for("MainLayout"),MenuTopbar:Symbol.for("MenuTopbar"),AppsPanel:Symbol.for("AppsPanel"),AppsHelper:Symbol.for("AppsHelper"),AppsTable:Symbol.for("AppsTable"),CreateAppComponent:Symbol.for("CreateAppComponent"),UpdateAppComponent:Symbol.for("UpdateAppComponent"),DeleteAppComponent:Symbol.for("DeleteAppComponent"),ProfilePanel:Symbol.for("ProfilePanel"),UserProfileComponent:Symbol.for("UserProfileComponent"),ChangeEmailComponent:Symbol.for("ChangeEmailComponent"),UserSession:Symbol.for("UserSession"),DomainInfrastructureComponent:Symbol.for("DomainInfrastructureComponent"),MonitoringInfrastructureComponent:Symbol.for("MonitoringInfrastructureComponent"),EnvironmentVariablesInfrastructureComponent:Symbol.for("EnvironmentVariablesInfrastructureComponent"),SQLiteInfrastructureComponent:Symbol.for("SQLiteInfrastructureComponent"),InfrastructureMenu:Symbol.for("InfrastructureMenu"),FileTree:Symbol.for("FileTree"),FileTreeContextMenu:Symbol.for("FileTreeContextMenu"),UserPreferencesComponent:Symbol.for("UserPreferencesComponent"),BrowserConfigProvider:Symbol.for("BrowserConfigProvider"),FirebaseAppProvider:Symbol.for("FirebaseAppProvider"),CodeSearchInput:Symbol.for("CodeSearchInput"),CodeSearchModal:Symbol.for("CodeSearchModal"),StartupTimeTracker:Symbol.for("StartupTimeTracker"),NavigatorStatusFooter:Symbol.for("NavigatorStatusFooter"),SQLiteServiceStub:Symbol.for("SQLiteServiceStub"),AppTasksQueue:Symbol.for("AppTasksQueue"),Routes:Symbol.for("Routes"),NodeFactory:Symbol.for("NodeFactory")}},500:function(e,t,n){"use strict";(function(e){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SQLEditor=void 0;const s=i(n(9)),o=n(191);e.CodeMirror=s.default;class a extends o.Editor{constructor(e,t){super(e,t),this.classAttr="editor"}getEditorContent(){return this.codeMirror.getValue()}async afterEveryRender(){await super.afterEveryRender(),this.fileTypeId="sql"}getMode(){return"text/x-sql"}}t.SQLEditor=a}).call(this,n(17))},504:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.prettierParsers=void 0;const s=i(n(505)),o=i(n(506)),a=i(n(192)),r=i(n(507)),c=i(n(508)),l=i(n(513)),d=n(514);t.prettierParsers={typescript:{parserName:"typescript",plugins:[s.default,o.default]},javascript:{parserName:"babel",plugins:[a.default,o.default]},html:{parserName:"html",plugins:[o.default]},markdown:{parserName:"markdown",plugins:[r.default]},css:{parserName:"css",plugins:[c.default]},scss:{parserName:"scss",plugins:[c.default]},json:{parserName:"json",plugins:[a.default]},packagejson:{parserName:"json-stringify",plugins:[d]},yaml:{parserName:"yaml",plugins:[l.default]}}},548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryEditorDatabasePanel=void 0;const i=n(3),s=n(7);class o extends i.HtmlComponent{constructor(e,t,n){super(),this.htmlContent=`\n        <div class="database-name-container"></div>\n        <div class="table-header">\n            <div class="icon">\n                    ${s.Icon.FolderOpen}\n            </div>\n           Tables\n       </div>\n        <div class="table-list-container">\n        </div>\n    `,this.classAttr="query-editor-database-panel",this.appId=null,this.databaseNameContainer=null,this.tableListContainer=null,this.sqliteService=e,this.path=t,this.name=n}setAppId(e){return this.appId=e,this}async loadTableList(){const e=document.createElement("ul");this.tableListContainer.innerHTML="",this.tableListContainer.appendChild(e);(await this.sqliteService.listDatabaseTables({appId:this.appId,path:this.path,name:this.name})).getValue().forEach(t=>{const n=document.createElement("li");e.appendChild(n),n.innerText=`${t.name} (${t.count} records)`})}async afterEveryRender(){this.databaseNameContainer=this.findInScope(".database-name-container"),this.databaseNameContainer.innerText=this.name,this.tableListContainer=this.findInScope(".table-list-container"),this.loadTableList()}}t.QueryEditorDatabasePanel=o},554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const i=n(199),s=n(555),o=n(3),a=n(200),r=n(12),c=n(158),l=n(556),d=n(6);n(199),n(557),n(559);class h extends o.HtmlComponent{constructor(e,t){super(),this.htmlContent='\n        <div class="loading-screen">\n            <div class="spinner"></div>\n            <span>Attaching to container. Please wait...</span>\n            <span class="status-container hidden">Container status: <span class="status"></span></span>\n        </div>\n    ',this.classAttr="terminal",this.workspaceService=e,this.tmuxSessionIdPromise=t}onResize(){this.isVisible()&&this.fitAddon.fit()}async destroy(e){var t;await super.destroy(e),null===(t=this.terminalStream)||void 0===t||t.complete(r.okReply())}async afterEveryRender(){await super.afterEveryRender();const e=document.documentElement.style,t=new i.Terminal({fontFamily:"monospace",rendererType:"dom",theme:{background:""+e.getPropertyValue("--color-background-dark"),foreground:""+e.getPropertyValue("--color-on-background")},cursorBlink:!0});this.fitAddon=new s.FitAddon,t.loadAddon(this.fitAddon),t.open(this.getRootElement());let n=!1;t.onData(e=>{var t;null===(t=this.terminalStream)||void 0===t||t.sendData(e),n||(d.UserSession.logActivity(l.useTerminal),n=!0)}),t.onResize(e=>{var t;if(e.rows>1&&e.cols>0){const n=a.deepCopy(e);null===(t=this.terminalStream)||void 0===t||t.sendNewSize({rows:n.rows-1,cols:n.cols})}}),"webkitLineBreak"in document.documentElement.style||(this.findInScope(".xterm-viewport").style.overflow="hidden"),this.terminalStream=this.workspaceService.createTerminalStream(),this.bindTerminalStream(t)}bindTerminalStream(e){var t,n;e.clear(),null===(t=this.terminalStream)||void 0===t||t.onCompleted(async t=>{if(t.notOk())return t.getErrorMessage()===c.CHILD_PROCESS_STREAM_CLOSED?void this.destroy():(this.findInScope(".loading-screen").classList.remove("hidden"),this.findInScope(".status").innerHTML=t.getErrorMessage(),this.findInScope(".status-container").classList.remove("hidden"),delete this.terminalStream,this.terminalStream=this.workspaceService.createTerminalStream(),void this.bindTerminalStream(e))});let i=!0;null===(n=this.terminalStream)||void 0===n||n.onData(async t=>{i&&(this.isRendered()&&this.findInScope(".loading-screen").classList.add("hidden"),i=!1),e.write(t)}),(async()=>{var e;null===(e=this.terminalStream)||void 0===e||e.initialize({appId:await d.UserSession.getInstance().getActiveAppId(),tmuxSession:await this.tmuxSessionIdPromise}),this.isVisible()&&this.fitAddon.fit()})()}}t.Terminal=h},56:function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TerminalPanel=void 0;const r=n(4),c=n(0),l=n(3),d=n(12),h=n(28),p=n(553),u=n(96),m=n(7),f=n(6),v=n(5),b=n(554);n(561);let y=class extends u.TabLayout{constructor(e){super([],async()=>this.generateTabWithoutTmuxSession(),!1,new S,!1),this.terminals={},this.createTmuxSessionPromises=[],this.workspaceService=e}async destroy(){c.has(this.keyUpListener)&&document.removeEventListener("keydown",this.keyUpListener),await super.destroy()}async openNewTerminal(){this.show(),this.isEmpty()&&await this.addTab(this.generateTabFromTmuxSession(0),!0)}onResize(){for(const e of Object.values(this.terminals))e.onResize()}async afterEveryRender(){let e;await super.afterEveryRender(),this.getRootElement().classList.add("terminal-panel"),(await(new g).renderTo(this.findInScope(".bar"))).onClick(()=>this.hide()),f.UserSession.getInstance().onActiveAppIdChange(async t=>{c.has(e)&&(this.closeAllTabs(),this.resetLoadingScreen(),e.complete(d.okReply())),c.has(t)&&(e=this.workspaceService.createContainerInfoStream(),this.bindContainerInfoStream(e),e.start({appId:t}))}),f.UserSession.getInstance().getActiveAppId().then(this.show.bind(this)),this.keyUpListener=e=>{e.altKey&&"t"===e.key&&(this.isVisible()?this.hide():this.show())},document.addEventListener("keyup",this.keyUpListener)}async generateTabWithoutTmuxSession(){const e=await f.UserSession.getInstance().getActiveAppId();let t;const n=new Promise(e=>t=e),i=new b.Terminal(this.workspaceService,n);return this.createTmuxSessionPromises.push(this.workspaceService.createTmuxSession({appId:e}).then(e=>{const n=this.renderedComponents.find(e=>e.tab.component===i);if(!c.has(n))return;if(e.logIfError().notOk())return void this.closeTab(n);const s=e.getValue().id;this.terminals[s]=i,n.tabBarButton.rename("Terminal "+s),t(s)})),{name:"loading...",component:i}}bindContainerInfoStream(e){e.onMessage(async({tmuxSession:e,containerInfo:t})=>{c.has(e)&&this.handleTmuxSessionMessage(e),c.has(t)&&this.handleContainerInfoMessage(t)})}async handleTmuxSessionMessage(e){await Promise.all(this.createTmuxSessionPromises),c.has(this.terminals[e.id])&&e.killed?await this.killTmuxSessionTab(e.id):c.has(this.terminals[e.id])||e.killed||await this.addTab(this.generateTabFromTmuxSession(e.id),!0)}async killTmuxSessionTab(e){const t=this.renderedComponents.find(t=>t.tab.component===this.terminals[e]);c.has(t)&&await this.closeTab(t),delete this.terminals[e]}resetTerminals(){this.terminals={},this.closeAllTabs()}async handleContainerInfoMessage(e){"unknown"!==e.name&&c.has(this.currentContainerName)&&this.currentContainerName!==e.name&&this.resetTerminals(),this.currentContainerStatus!==e.status&&(this.currentContainerName=e.name,this.findInScope(".status-container .status").innerHTML=this.currentContainerStatus=e.status,"running"===e.status?(this.findInScope(".spinner").classList.add("hidden"),this.findInScope(".please-wait").classList.add("hidden"),this.findInScope(".explanation").classList.remove("hidden"),this.findInScope(".warning").classList.add("hidden"),this.findInScope(".status-container").classList.add("hidden"),this.findInScope(".plus").classList.remove("disabled")):(this.findInScope(".spinner").classList.remove("hidden"),this.findInScope(".please-wait").classList.remove("hidden"),this.findInScope(".explanation").classList.add("hidden"),this.findInScope(".status-container").classList.remove("hidden"),this.findInScope(".plus").classList.add("disabled"),"pending"!==e.status||e.schedulable||this.findInScope(".warning").classList.remove("hidden")))}resetLoadingScreen(){this.findInScope(".spinner").classList.add("hidden"),this.findInScope(".please-wait").classList.add("hidden"),this.findInScope(".explanation").classList.add("hidden"),this.findInScope(".warning").classList.add("hidden")}generateTabFromTmuxSession(e){const t=new b.Terminal(this.workspaceService,new Promise(t=>t(e))),n="Terminal "+e;return f.UserSession.logActivity(p.newTerminal),this.terminals[e]=t,{name:n,component:t}}};y=s([r.injectable(),a(0,r.inject(v.injectableTypes.WorkspaceServiceStub)),o("design:paramtypes",["function"==typeof(i=void 0!==h.WorkspaceServiceStub&&h.WorkspaceServiceStub)?i:Object])],y),t.TerminalPanel=y;class g extends l.HtmlComponent{constructor(){super(...arguments),this.htmlContent=m.Icon.Minus,this.classAttr="minus",this.clickListeners=[]}onClick(e){this.clickListeners.push(e)}async afterEveryRender(){await super.afterEveryRender(),this.getRootElement().addEventListener("click",()=>this.clickListeners.forEach(e=>e()))}}class S extends l.HtmlComponent{constructor(){super(...arguments),this.htmlContent='\n        <div class="loading-screen">\n            <div class="spinner hidden"></div>\n            <span class="please-wait hidden">Attaching to container. Please wait...</span>\n            <p class="explanation hidden">Click + to create a new terminal tab</p>\n            <span class="status-container hidden">Container status: <span class="status"></span></span>\n            <span class="warning hidden">You are in the queue for free compute resources. Choose a paid plan if you want dedicated resources instantly.</span>\n        </div>\n    '}}},565:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=t.ContextMenuItem=void 0;const o=n(4),a=n(3),r=n(0);n(566);class c extends a.HtmlComponent{constructor(e,t){super(),this.htmlContent=`<li><a href="#">${e}</a></li>`,this.clickListener=t}afterEveryRenderSync(){super.afterEveryRenderSync(),this.findInScope("li").addEventListener("click",()=>this.clickListener())}}t.ContextMenuItem=c;let l=class extends a.HtmlComponent{constructor(...e){super(),this.htmlContent='<div class="context-menu"><ul></ul></div>',this.items=e}move(e,t){r.has(this.contextMenuElement)&&(this.contextMenuElement.style.left=e+"px",this.contextMenuElement.style.top=t+"px")}add(e){return this.items.push(e),this.isRendered()&&e.renderTo(this.listElement),this}async afterEveryRender(){var e;await super.afterEveryRender(),this.hide(),this.contextMenuElement=this.findInScope(".context-menu"),this.listElement=null===(e=this.contextMenuElement)||void 0===e?void 0:e.querySelector("ul"),this.items.forEach(e=>e.renderTo(this.listElement)),document.addEventListener("click",()=>this.hide())}};l=i([o.injectable(),s("design:paramtypes",[c])],l),t.ContextMenu=l},634:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRouteParams=void 0,t.parseRouteParams=(e,t)=>{const n={},i=t.split("/"),s=e.split("/");for(let e=0;e<i.length;e++){const t=i[e];if(":"===t[0]){n[t.slice(1)]=s[e]}}return n}},635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceRouteParams=void 0,t.replaceRouteParams=(e,t)=>{const n=e.split("/"),i=[];for(const e of n)i.push(":"===e[0]?t:e);return i.join("/")}},636:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.MainMenuLeftbar=void 0;const o=n(4),a=n(3),r=n(7),c=n(59);n(637);let l=class extends a.HtmlComponent{constructor(e,t,n,i){super(),this.htmlContent=`\n        <div class="inner-container">\n            <li class="icon close hidden">${r.Icon.Close}<span>Close</span></li>\n            <li class="icon apps">${r.Icon.Apps}<span>My Apps</span></li>\n            <li class="icon profile">${r.Icon.User}<span>My Profile</span></li>\n            <li class="icon billing">${r.Icon.Billing}<span>Billing</span></li>\n            <li class="icon signout">${r.Icon.Signout}<span>Signout</span></li>\n        </div>\n    `,this.classAttr="main-menu-leftbar",this.showApps=e,this.showProfile=t,this.showBilling=n,this.closeMenu=i}activateAppsItem(){this.deactivateAllItems();this.findInScope(".icon.apps").classList.add("active")}activateProfileItem(){this.deactivateAllItems();this.findInScope(".icon.profile").classList.add("active")}showCloseButton(){this.findInScope(".icon.close").classList.remove("hidden")}hideCloseButton(){this.findInScope(".icon.close").classList.add("hidden")}async afterEveryRender(){await super.afterEveryRender();const e=this.findInScope(".icon.apps"),t=this.findInScope(".icon.profile"),n=this.findInScope(".icon.billing"),i=this.findInScope(".icon.close"),s=this.findInScope(".icon.signout");i.onclick=()=>this.closeMenu(),e.onclick=()=>this.showApps(),t.onclick=()=>this.showProfile(),n.onclick=()=>this.showBilling(),s.onclick=()=>c.signOut()}deactivateAllItems(){this.findAllInScope(".icon").forEach(e=>e.classList.remove("active"))}};l=i([o.injectable(),s("design:paramtypes",[Function,Function,Function,Function])],l),t.MainMenuLeftbar=l},645:function(e,t,n){"use strict";(function(e){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileEditor=void 0;const r=a(n(9)),c=n(0),l=n(12),d=n(55),h=n(646),p=n(155),u=n(647),m=n(6),f=n(129),v=n(648),b=n(649),y=n(191);n(193),n(194),e.CodeMirror=r.default;const g=Promise.resolve().then(()=>o(n(655))),S=["#9E0059","#390099","#4B3F72","#1F2041","#EA526F","#5863F8","#222222","#136F63","#FF0054","#19647E","#29BF12","#8FC93A","#000000","#353531","#FF6B35","#76B041"];class w extends y.Editor{constructor(e,t,n,i,s,o){super(t,i,o),this.classAttr="editor",this.loading=!0,this.config=e,this.firebaseAppProvider=n,this.lspStream=s}destroy(){return c.has(this.lspAdapter)&&this.lspAdapter.remove(),c.has(this.keyDownListener)&&document.removeEventListener("keydown",this.keyDownListener),super.destroy()}focus(){return this.loading||super.focus(),this}async afterEveryRender(){await super.afterEveryRender();const e=await(new f.LoadingAnimationComponent).renderTo(this.getRootElement());e.show(),await this.userSession.getAuthentication();const[t,n]=await Promise.all([this.ideService.getUserPreferences(),this.ideService.getFileContent({appId:this.config.appId,fileId:this.config.fileId,path:this.config.filePath})]);if(t.ok()&&this.setKeymap(t.getValue().keymap),this.config.fileId=n.getValue().metadata.fileId,n.notOk())return void alert("This file was moved or deleted.");this.fileTypeId=h.getCodesphereFileTypeId(n.getValue().metadata.name);const i=await this.firebaseAppProvider.get(),s=(await g).fromCodeMirror(i.database().ref(await this.getFirebaseFileRef(this.config.appId)),this.codeMirror,{defaultText:n.getValue().content,userId:"user"+this.config.userId,userColor:S[this.config.userId%S.length]});s.on("ready",()=>{this.bindLanguageServer(n.getValue().metadata),this.codeMirror.getDoc().clearHistory(),e.hide(),this.loading=!1,this.focus()});let o=!1;s.on("synced",()=>{o||(m.UserSession.logActivity(u.editFile),o=!0)}),this.keyDownListener=e=>{e.ctrlKey&&"/"===e.key&&this.codeMirror.toggleComment()},document.addEventListener("keydown",this.keyDownListener)}getMode(){var e,t;const n=null!==(e=d.last(this.config.filePath.split(".")))&&void 0!==e?e:"txt";return null!==(t=v.fileExtensionToCodeMirrorMode[n])&&void 0!==t?t:"jsx"}async getFirebaseFileRef(e){return`${(await this.ideService.getFirebaseConfig({appId:e})).getValue().appRef}/${this.config.fileId}`}async bindLanguageServer(e){if(!c.has(e.absolutePath))return void l.errStatus("Can't bind file to language server because the file is missing path metadata.").log();if(!c.has(this.fileTypeId))return;const t=h.getLspLanguageId(this.fileTypeId);c.has(t)&&"html"!==t&&(this.lspAdapter=new b.LspCodeMirrorAdapter({languageId:t,documentUri:p.pathToLspUri(e.absolutePath)},this.lspStream,{},this.codeMirror))}}t.FileEditor=w}).call(this,n(17))},648:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileExtensionToCodeMirrorMode=void 0,t.fileExtensionToCodeMirrorMode={ts:{name:"javascript",typescript:!0},tsx:"jsx",js:"jsx",py:"python",md:"markdown",sh:"shell",txt:"txt/plain"}},649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LspCodeMirrorAdapter=void 0;const i=n(212),s=n(15),o=n(213),a=n(0),r=n(3),c=n(97),l=n(201),d=n(200),h=n(650),p=n(651),u=n(654);var m;!function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(m||(m={}));t.LspCodeMirrorAdapter=class{constructor(e,t,n,i){this.highlightMarkers=[],this.editorListeners={},this.documentListeners={},this.isShowingContextMenu=!1,this.completions=[],this.documentVersion=0,this.lastEditorContent=[],this.eslintDiagnostics=[],this.typescriptDiagnostics=[],this.gutters={},this.diagnosticsMarker={},this.hoverTooltips=[],this.documentInfo=e,this.lspStream=t,this.options=u.getFilledDefaults(n),this.editor=i,this.lastEditorContent=this.editor.getValue().split("\n"),this.debouncedGetHoverTooltip=o.debounce(e=>{this.getHoverTooltip(e)},this.options.hoverSignatureDelay),this.addEditorListeners(),this.lspStream.onNotification("textDocument/publishDiagnostics",e=>this.handleDiagnostic(e)),this.lspStream.openDocument(this.documentInfo,()=>this.editor.getValue())}handleHover(e){if(this.isShowingContextMenu||!this.isEventInsideVisible(e)||!this.isEventOnCharacter(e))return void this.removeContextMenu();const t=this.editor.coordsChar({left:e.clientX,top:e.clientY},"window");this.hoverCharacter&&t.line===this.hoverCharacter.line&&t.ch===this.hoverCharacter.ch||(this.hoverCharacter=t,this.debouncedGetHoverTooltip(t))}async handleHoverTooltip(e,t,n){var i,s,o;if(this.removeHoverMarker(),this.removeContextMenu(),!e[0]||Array.isArray(null===(i=e[0])||void 0===i?void 0:i.contents)&&0===(null===(s=e[0])||void 0===s?void 0:s.contents.length))return;let r=this.hoverCharacter,c=this.hoverCharacter;if(null===(o=e[0])||void 0===o?void 0:o.range){r={line:e[0].range.start.line,ch:e[0].range.start.character},c={line:e[0].range.end.line,ch:e[0].range.end.character};const t=a.has(n)?"":"text-decoration: underline";this.hoverMarker=this.editor.getDoc().markText(r,c,{css:t})}const l=[];e.forEach(e=>{const t={definition:e.contents[0].value,docu:e.contents[1]};l.push(t)});const d="hover-tooltip "+t,h=this.editor.charCoords(r,"page");this.contextMenu=await new p.CodeDocTooltip(l,d,h.top,h.left,this.editor.defaultTextHeight(),n).renderTo("body"),this.hoverTooltips=[]}handleHighlight(e){this.highlightRanges((e||[]).map(e=>e.range))}handleCompletion(e){this.completions=e,a.has(this.editor.state.completionActive)&&this.editor.state.completionActive.active()&&this.editor.state.completionActive.update()}handleDiagnostic(e){const t=e.params,n=e.source,i=[];if(c.equal(t.uri,this.documentInfo.documentUri)){"eslint"===n?this.eslintDiagnostics=[]:"typescript"===n&&(this.typescriptDiagnostics=[]);for(const[e,t]of Object.entries(this.gutters))if(Object.keys(t)[0]===n){const t=parseInt(e);delete this.gutters[t]}for(const[e,t]of Object.entries(this.diagnosticsMarker))e===n&&t.forEach(({marker:e})=>{e.clear()});t.diagnostics.forEach(e=>{this.addOrUpdateGutterEntry(e);let t="";switch(e.severity){case m.Warning:t="cm-warning";break;case m.Information:case m.Hint:t="cm-hint";break;default:t="cm-error"}const s={line:e.range.start.line,ch:e.range.start.character},o={line:e.range.end.line,ch:e.range.end.character},a={marker:this.editor.getDoc().markText(s,o,{className:t}),message:e.message};i.push(a),"eslint"===n?this.eslintDiagnostics.push(e):"typescript"===n&&this.typescriptDiagnostics.push(e)}),this.diagnosticsMarker[n]=i,this.drawGutters()}}handleSignature(e){this.removeSignatureWidget(),this.removeContextMenu(),e&&e.signatures.length&&this.lastChangedWord}handleGoTo(e){if(this.removeContextMenu(),!e)return;const t=this.getDocumentUri();let n;if(i.Location.is(e)){if(e.uri!==t)return;this.highlightRanges([e.range]),n={line:e.range.start.line,ch:e.range.start.character}}else if(e.every(e=>i.Location.is(e))){const i=e.filter(e=>e.uri===t);this.highlightRanges(i.map(e=>e.range)),n={line:i[0].range.start.line,ch:i[0].range.start.character}}else if(e.every(e=>i.LocationLink.is(e))){const i=e.filter(e=>e.targetUri===t);this.highlightRanges(i.map(e=>e.targetRange)),n={line:i[0].targetRange.start.line,ch:i[0].targetRange.start.character}}this.editor.scrollIntoView(n)}remove(){this.lspStream.closeDocument(this.documentInfo),this.removeSignatureWidget(),this.removeHoverMarker(),this.removeContextMenu(),document.querySelectorAll(".CodeMirror-hints").forEach(e=>e.remove()),this.editor.off("change",this.editorListeners.change),this.editor.off("debouncedChange",this.editorListeners.debouncedChange),this.editor.off("cursorActivity",this.editorListeners.cursorActivity),this.editor.getWrapperElement().removeEventListener("mousemove",this.editorListeners.mouseover),this.editor.getWrapperElement().removeEventListener("contextmenu",this.editorListeners.contextmenu)}getSignatureHelp(e){if(!this.lspStream.isSignatureHelpSupported())return;const t=this.getEditorContent()[e.line][e.ch];let n=!1;this.lspStream.serverCapabilities.forEach(e=>{var i;(null===(i=e.signatureHelpProvider)||void 0===i?void 0:i.triggerCharacters.indexOf(t))&&(n=!0)}),a.has(this.lspStream.serverCapabilities)&&n||this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/signatureHelp",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>this.handleSignature(e.result))}getDocumentHighlights(e){this.lspStream.isDocumentHighlightSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/documentHighlight",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>this.handleHighlight(e.result))}getDefinition(e){this.lspStream.isDefinitionSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/definition",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>this.handleHoverTooltip(e.result,"code-doc"))}getTypeDefinition(e){this.lspStream.isTypeDefinitionSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/typeDefinition",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>this.handleGoTo(e.result))}getImplementation(e){this.lspStream.isImplementationSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/implementation",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>this.handleGoTo(e.result))}getReferences(e){this.lspStream.isReferencesSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/references",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch},context:{includeDeclaration:!0}},source:"client"},e=>this.handleGoTo(e.result))}addOrUpdateGutterEntry(e){if(e.source&&e.severity)if(a.has(this.gutters[e.range.start.line]&&this.gutters[e.range.start.line][e.source])){const t=this.gutters[e.range.start.line][e.source];t.push({message:e.message,severity:e.severity}),this.gutters[e.range.start.line][e.source]=t}else this.gutters[e.range.start.line]={[e.source]:[{message:e.message,severity:e.severity}]}}drawGutters(){this.editor.clearGutter("CodeMirror-lsp");for(const[e,t]of Object.entries(this.gutters)){let n=!1,i=!1,s=!1;const o=[];for(const e of Object.values(t))for(const t of e)Object.values(t).includes(m.Hint)?s=!0:(Object.values(t).includes(m.Warning)&&(i=!0),Object.values(t).includes(m.Error)&&(n=!0),o.push(t.message));if(s&&!n&&!i)continue;const r=document.createElement("div"),c=n?["tooltip-red","lsp-error"]:["tooltip-orange","lsp-warning"];r.classList.add(c[0],c[1],"with-tooltip","CodeMirror-lsp-guttermarker");const l=`${c[0]} ${c[1]}`;r.addEventListener("mouseenter",()=>{this.drawGutterTooltipIfExists(o,parseInt(e),l)}),r.addEventListener("mouseleave",()=>{var e;a.has(this.gutterTooltip)&&(null===(e=this.gutterTooltip)||void 0===e||e.destroy(!0),this.gutterTooltip=void 0)}),this.editor.setGutterMarker(parseInt(e),"CodeMirror-lsp",r)}}async drawGutterTooltipIfExists(e,t,n){if(a.has(this.gutterTooltip))return;const i={line:t,ch:0},s=this.editor.charCoords(i,"page");this.gutterTooltip=await new p.GutterTooltip(e,`with-tooltip ${n} CodeMirror-lsp-guttermarker`,s.top+5,s.left-20,this.editor.defaultTextHeight()).renderTo("body")}async handleChangeSlow(e){const t=l.copy(e),n=this.getEditorContent()[e.to.line];if(!a.has(n))return;const i=n[t.to.ch];/\W/.test(i)?this.getLanguageSignatureCharacters().includes(i)&&this.getSignatureHelp(t.to):this.getCompletions(t.to,1)}showCompletionHint(){a.has(this.editor.state.completionActive)&&this.editor.state.completionActive.active()?this.editor.state.completionActive.update():this.editor.showHint({completeSingle:!1,hint:()=>{let e;e=s.isEmpty(this.lastChangedWord.text)?this.completions:this.getFilteredCompletions(this.lastChangedWord.text,this.completions);const t={from:{line:this.lastChangedWord.start.line,ch:this.lastChangedWord.start.ch},to:{line:this.lastChangedWord.end.line,ch:this.lastChangedWord.end.ch+1}};return 0===e.length||1===e.length&&e[0].label===this.lastChangedWord.text?{...t,list:[]}:{...t,list:[...e.map(e=>({text:e.label,render:t=>{const n=a.has(e.kind)?h.completionKindInfo[e.kind]:void 0;new f(e.label,this.lastChangedWord.text.length,n).renderTo(t)}}))]}}})}getEditorContent(){return this.editor.getDoc().getValue().split("\n")}async handleChange(e){const t=d.deepCopy(e),n=this.getEditorContent(),i=n[t.to.line];if(this.lastChangedWord=this.getWordEndingAtPosition(i,t.to,[" ",...this.getLanguageCompletionCharacters(),...this.getLanguageSignatureCharacters()]),this.sendChange(t),!a.has(i))return;const s=i[t.to.ch],o=this.getLanguageCompletionCharacters().includes(s),r="."===s||!o;"complete"!==e.origin&&r&&(a.has(s)?o?(this.completions=[],this.getCompletions(t.to,2,s),this.showCompletionHint()):/\W/.test(s)?this.removeSignatureWidget():this.showCompletionHint():this.removeSignatureWidget(),this.lastEditorContent=n)}getCompletions(e,t,n){this.lspStream.isCompletionSupported()&&(a.has(this.editor.state.completionActive)&&this.editor.state.completionActive.active()&&this.editor.state.completionActive.update(),this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/completion",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch+1},context:{triggerKind:t,triggerCharacter:n}},source:"client"},e=>{a.has(e.result)&&this.handleCompletion(e.result)}))}async sendChange(e){const t=e.text;let n=e.to.ch+1,i=e.to.line;const o=this.lastEditorContent[e.to.line];!a.has(o)||n>o.length?(n=0,i++,t[t.length]=""):s.isEmpty(t)||(t[t.length-1]+=o[e.to.ch]);const r=[{range:{start:{line:e.from.line,character:e.from.ch},end:{line:i,character:n}},text:t.join("\n")}],c={textDocument:{uri:this.documentInfo.documentUri,version:this.documentVersion},contentChanges:r};this.documentVersion++,await this.lspStream.send({method:"textDocument/didChange",params:c,source:"client"})}getLanguageCompletionCharacters(){let e=[];return this.lspStream.serverCapabilities.forEach(t=>{var n;(null===(n=t.completionProvider)||void 0===n?void 0:n.triggerCharacters)&&(e=t.completionProvider.triggerCharacters)}),e}getLanguageSignatureCharacters(){let e=[];return this.lspStream.serverCapabilities.forEach(t=>{var n;(null===(n=t.signatureHelpProvider)||void 0===n?void 0:n.triggerCharacters)&&(e=t.signatureHelpProvider.triggerCharacters)}),e}getHoverTooltip(e){let t=!1;const n=this.eslintDiagnostics.concat(this.typescriptDiagnostics);0!==n.length?(n.every(n=>{const i={line:n.range.start.line,character:n.range.start.character},s={line:n.range.end.line,character:n.range.end.character};if(i.line!==s.line&&(s.character=i.character+1),e.line===i.line&&e.ch>=i.character&&e.ch<=s.character&&n.code&&n.source){const o={contents:[{language:n.source,value:n.message},n.code.toString()],range:{start:i,end:s}};return t=!0,0!==o.contents.length&&this.hoverTooltips.push(o),this.getSignatureToolTip(e,n),!1}return!0}),t||this.getSignatureToolTip(e)):this.getSignatureToolTip(e)}getSignatureToolTip(e,t){this.lspStream.isHoverSupported()&&this.lspStream.performLspRequest({id:this.lspStream.lspSequential.next(),method:"textDocument/hover",params:{textDocument:{uri:this.documentInfo.documentUri},position:{line:e.line,character:e.ch}},source:"client"},e=>{if(a.has(e.result)&&0!==e.result.contents.length&&this.hoverTooltips.push(e.result),a.has(t)){let e="";switch(t.severity){case m.Warning:e="diagnostic-doc-warning";break;case m.Information:case m.Hint:e="diagnostic-doc-hint";break;default:e="diagnostic-doc-error"}this.handleHoverTooltip(this.hoverTooltips,e,t.source)}else this.handleHoverTooltip(this.hoverTooltips,"code-doc")})}getDocumentUri(){return this.documentInfo.documentUri}addEditorListeners(){const e=async(e,t)=>{this.handleChange(t)};this.editor.on("change",e),this.editorListeners.change=e;const t=o.debounce(async(e,t)=>{this.handleChangeSlow(t)},this.options.codeCompletionDelay);this.editor.on("change",t),this.editorListeners.debouncedChange=t;const n=o.debounce(e=>this.handleHover(e),this.options.hoverSignatureDelay);this.editor.getWrapperElement().addEventListener("mousemove",n),this.editorListeners.mouseover=n;const i=o.debounce(()=>{this.getDocumentHighlights(this.editor.getDoc().getCursor("start"))},this.options.cursorHighlightDelay),s=this.handleRightClick.bind(this);this.editor.getWrapperElement().addEventListener("contextmenu",s),this.editorListeners.contextmenu=s,this.editor.on("cursorActivity",i),this.editorListeners.cursorActivity=i;const a=this.handleClickOutside.bind(this);document.addEventListener("click",a),this.documentListeners.clickOutside=a}getWordEndingAtPosition(e,t,n){let i=t.ch,s=0;for(;i>=0&&a.has(e);){const t=e[i];n.includes(t)?(s=i+1,i=-1):i--}const o=a.has(e)?e.substring(s,t.ch-i+1):"";return i++,{text:o,start:{line:t.line,ch:s},end:{line:t.line,ch:Math.max(s,t.ch)}}}getFilteredCompletions(e,t){if(s.isEmpty(t))return t;if(/\W+/.test(e))return t;const n=e.toLowerCase();return t.filter(e=>!(!e.filterText||0!==e.filterText.toLowerCase().indexOf(n))||0===e.label.toLowerCase().indexOf(n)).sort((t,n)=>(0===t.label.indexOf(e)?-1:1)+(0===n.label.indexOf(e)?1:-1))}isEventInsideVisible(e){let t=e.target;if(!a.has(t))return!1;let n=!1;for(;t!==document.body&&null!==t;){if(t.classList.contains("CodeMirror-sizer")){n=!0;break}t=t.parentElement}return n}isEventOnCharacter(e){const t=this.editor.coordsChar({left:e.clientX,top:e.clientY},"window"),n=this.editor.getTokenAt(t);return!s.isEmpty(n.string)}handleRightClick(e){if(!this.isEventInsideVisible(e)||!this.isEventOnCharacter(e))return;if(!(this.lspStream.isDefinitionSupported()||this.lspStream.isTypeDefinitionSupported()||this.lspStream.isReferencesSupported()||this.lspStream.isImplementationSupported()))return;e.preventDefault();const t=this.editor.coordsChar({left:e.clientX,top:e.clientY},"window"),n=document.createElement("div");if(n.classList.add("CodeMirror-lsp-context"),this.lspStream.isDefinitionSupported()){const e=document.createElement("div");e.innerText="Go to Definition",e.addEventListener("click",()=>{this.getDefinition(t)}),n.appendChild(e)}if(this.lspStream.isTypeDefinitionSupported()){const e=document.createElement("div");e.innerText="Go to Type Definition",e.addEventListener("click",()=>{this.getTypeDefinition(t)}),n.appendChild(e)}if(this.lspStream.isReferencesSupported()){const e=document.createElement("div");e.innerText="Find all References",e.addEventListener("click",()=>{this.getReferences(t)}),n.appendChild(e)}this.isShowingContextMenu=!0}handleClickOutside(e){if(this.isShowingContextMenu){let t=e.target,n=!1;for(;t!==document.body;){if(t.classList.contains("editor-tooltip hover-tooltip")){n=!0;break}t=t.parentElement}if(n)return;this.removeContextMenu()}}removeContextMenu(){a.has(this.contextMenu)&&(this.isShowingContextMenu=!1,this.contextMenu.destroy(!0))}removeSignatureWidget(){this.signatureWidget&&(this.signatureWidget.clear(),this.signatureWidget=void 0),this.removeContextMenu()}removeHoverMarker(){this.hoverMarker&&(this.hoverMarker.clear(),this.hoverMarker=void 0)}highlightRanges(e){this.highlightMarkers&&this.highlightMarkers.forEach(e=>{e.clear()}),this.highlightMarkers=[],e.length&&e.forEach(e=>{const t={line:e.start.line,ch:e.start.character},n={line:e.end.line,ch:e.end.character};this.highlightMarkers.push(this.editor.getDoc().markText(t,n,{className:"marked"}))})}};class f extends r.HtmlComponent{constructor(e,t,n){super(),this.htmlContent=`\n            <span class="abbreviation" ${a.has(n)&&a.has(n.color)?`style="background-color:${n.color};color:var(--white)"`:""}>${a.has(n)&&a.has(n.abbreviation)?n.abbreviation:""}</span>\n                                        <span class="text label-hint"><b>${e.substring(0,t)}</b>${e.substring(t)}</span>\n            <span class="description">${a.has(n)?n.description:""}</span>\n        `}}},650:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completionKindInfo=void 0;const i=n(212);t.completionKindInfo={[i.CompletionItemKind.Text]:{abbreviation:"t",description:"text"},[i.CompletionItemKind.Method]:{abbreviation:"m",description:"method",color:"var(--blue)"},[i.CompletionItemKind.Function]:{abbreviation:"f",description:"function"},[i.CompletionItemKind.Constructor]:{abbreviation:"c",description:"constructor"},[i.CompletionItemKind.Field]:{abbreviation:"f",description:"field",color:"var(--yellow)"},[i.CompletionItemKind.Variable]:{abbreviation:"v",description:"variable",color:"var(--yellow)"},[i.CompletionItemKind.Class]:{abbreviation:"c",description:"class"},[i.CompletionItemKind.Interface]:{abbreviation:"i",description:"interface"},[i.CompletionItemKind.Module]:{abbreviation:"m",description:"module"},[i.CompletionItemKind.Property]:{abbreviation:"p",description:"property"},[i.CompletionItemKind.Unit]:{abbreviation:"u",description:"unit"},[i.CompletionItemKind.Value]:{abbreviation:"v",description:"value"},[i.CompletionItemKind.Enum]:{abbreviation:"e",description:"enum"},[i.CompletionItemKind.Keyword]:{description:"keyword"},[i.CompletionItemKind.Snippet]:{abbreviation:"s",description:"snippet"},[i.CompletionItemKind.Color]:{abbreviation:"c",description:"color"},[i.CompletionItemKind.File]:{description:"file"},[i.CompletionItemKind.Reference]:{abbreviation:"r",description:"reference"},[i.CompletionItemKind.Folder]:{description:"folder"},[i.CompletionItemKind.EnumMember]:{abbreviation:"e",description:"enum member"},[i.CompletionItemKind.Constant]:{abbreviation:"c",description:"constant"},[i.CompletionItemKind.Struct]:{abbreviation:"s",description:"struct"},[i.CompletionItemKind.Event]:{abbreviation:"e",description:"event"},[i.CompletionItemKind.Operator]:{abbreviation:"o",description:"operator"},[i.CompletionItemKind.TypeParameter]:{abbreviation:"t",description:"type parameter"}}},651:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeDocTooltip=t.GutterTooltip=t.EditorTooltip=void 0;const i=n(3),s=n(0);n(652);class o extends i.HtmlComponent{constructor(e,t,n,i,s){super(),this.htmlContent=e,this.classAttr="editor-tooltip "+t,this.top=n,this.left=i,this.editorTextHeight=s}async afterEveryRender(){let e;await super.afterEveryRender(),e=this.top>this.getRootElement().offsetHeight?this.top-this.getRootElement().offsetHeight:this.top+this.editorTextHeight;const t=this.left;this.getRootElement().style.left=t+"px",this.getRootElement().style.top=e+"px"}}t.EditorTooltip=o;t.GutterTooltip=class extends o{constructor(e,t,n,i,s){let o="";if(1===e.length)o=`\n                <div>\n                    ${e[0]}\n                </div>\n            `;else for(let t=0;t<e.length;t++){const n=t+1===e.length,i=0===t?"padding-bottom: 0.3em":n?"padding-top: 0.3em":"padding: 0.3em 0";o+=`\n                    <div class="${1===e.length||n?"":"hover-divider"}" style="${i}">\n                        ${e[t]}\n                    </div>\n                `}super(`\n            <span class="tooltiptext gutter-tooltiptext" style="margin-left: 20px; margin-top: -10px">\n                ${o}\n            </span>\n        `,t,n,i,s)}};t.CodeDocTooltip=class extends o{constructor(e,t,n,i,o,a){let r="";const c=e.length;for(let t=0;t<c;t++){const n=t+1===c,i=1===e.length||n?"":"hover-divider";if(s.has(a))if(""===e[t].docu)r+=`\n                        <div class="${i} hover-div">\n                           <span class="definition">${e[t].definition}</span>\n                           <br>\n                        </div>\n                    `;else{let n;if("eslint"===a){n=`\n                            <span class="documentation">eslint\n                               (<a href=${"https://eslint.org/docs/rules/"+e[t].docu} target="_blank" >${e[t].docu}</a>)\n                            </span>\n                        `}else"typescript"===a&&(n=`<span class="documentation">ts (${e[t].docu})</span>`);r+=`\n                        <div class="${i} hover-div hover-error">\n                            <span class="definition">${e[t].definition}</span>\n                            <br>\n                            ${n}\n                            <br>\n                        </div>\n                    `}else r+=`\n                    <div class="${i} hover-div">\n                        <span class="definition">${e[t].definition}</span>\n                        <br>\n                        <span class="documentation">${e[t].docu}\n                    </div>\n                `}super(r,t,n,i,o)}}},654:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilledDefaults=void 0,t.getFilledDefaults=function(e){return Object.assign({},{suggestOnTriggerCharacters:!0,acceptSuggestionOnEnter:!0,acceptSuggestionOnTab:!0,acceptSuggestionOnCommitCharacter:!0,selectionHighlight:!0,occurrencesHighlight:!0,codeLens:!0,folding:!0,foldingStrategy:"auto",showFoldingControls:"mouseover",suggest:!0,quickSuggestions:!0,codeCompletionDelay:500,hoverSignatureDelay:100,cursorHighlightDelay:200,enableParameterHints:!0,iconsInSuggestions:!0,formatOnType:!1,formatOnPaste:!1},e)}},660:function(e,t,n){"use strict";var i,s,o,a=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SQLiteReferencesTable=void 0;const l=n(4),d=n(0),h=n(15),p=n(135),u=n(66),m=n(132),f=n(80),v=n(6),b=n(5),y=n(7),g=n(20);n(661);let S=class extends f.Table{constructor(e,t,n){super("table",'<th class="column-header">Name</th>','<th class="column-header">Path</th>','<th class="column-header">Size</th>','<th class="column-header">Actions</th>'),this.tableRows={},this.databaseNames={},this.appId=null,this.userSession=e,this.sqliteService=t,this.editorPanel=n,this.hintRow=this.createHintRow()}async afterEveryRender(){await super.afterEveryRender(),this.appId=await v.UserSession.getInstance().getActiveAppId();const e=this.sqliteService.createSQLiteReferencesUpdateStream();e.onMessage(this.applyUpdate.bind(this)),e.start({appId:this.appId})}createHintRow(){const e=document.createElement("tr"),t=document.createElement("td");return t.className="hint-row",t.colSpan=4,t.innerText="You can manage your SQLite Databases here.",e.appendChild(t),e}async createTableRow(e,t){e.innerHTML="";const n=document.createElement("td");n.innerText=t.name,e.appendChild(n);const i=document.createElement("td");i.innerText=t.path,e.appendChild(i);const s=document.createElement("td");s.innerText=p.formatBytes(t.sizeInBytes,2),e.appendChild(s);const o=await this.createActionElement(t);e.appendChild(o),e.onclick=()=>this.editorPanel.showInQueryEditor(t.name,t.path)}async createActionElement(e){const{path:t,name:n}=e,i=document.createElement("td"),s=new m.DropdownMenu({icon:""+y.Icon.More}),o={uiAction:{icon:""+y.Icon.Delete,text:"Delete",performAction:async()=>{this.sqliteService.deleteSQLiteDatabase({appId:this.appId,path:t,name:""}),this.removeTableRow(this.tableRows[t])}}},a={uiAction:{icon:""+y.Icon.NewFile,text:"Query",performAction:async()=>{this.editorPanel.showInQueryEditor(e.name,e.path)}}};return await s.addEntryGroup(o,a).renderTo(i),i}async applyUpdate(e){await Promise.all(e.map(async e=>{if(d.has(this.tableRows[e.path]))return this.removeTableRow(this.tableRows[e.path]),delete this.tableRows[e.path],void delete this.databaseNames[e.path];const t=document.createElement("tr");await this.createTableRow(t,e),this.tableRows[e.path]=t,this.databaseNames[e.path]=e.name;const n=Object.values(this.databaseNames).sort().indexOf(e.name);this.appendTableRowAtIndex(this.tableRows[e.path],n)})),h.isEmpty(this.tableRows)?this.appendTableRow(this.hintRow):this.removeTableRow(this.hintRow)}};S=a([l.injectable(),c(0,l.inject(b.injectableTypes.UserSession)),c(1,l.inject(b.injectableTypes.SQLiteServiceStub)),c(2,l.inject(b.injectableTypes.EditorPanel)),r("design:paramtypes",["function"==typeof(i=void 0!==v.UserSession&&v.UserSession)?i:Object,"function"==typeof(s=void 0!==u.SQLiteServiceStub&&u.SQLiteServiceStub)?s:Object,"function"==typeof(o=void 0!==g.EditorPanel&&g.EditorPanel)?o:Object])],S),t.SQLiteReferencesTable=S},663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NewSQLiteDatabaseModal=void 0;const i=n(3),s=n(0),o=n(15),a=n(7);n(664);class r extends i.HtmlComponent{constructor(e,t,n){super(),this.htmlContent=`\n        <div class="modal">\n            <div class='close'>${a.Icon.Close}</div>\n            <div class="input-form">\n                <h2>Create a new SQLite Database</h2>  \n                <div class="inner-container">\n                    <div class="input-container">\n                        <label for="name-input">Database Name</label><br>\n                        <input\n                            id="name-input"\n                            readonly type="text"\n                            placeholder="Name your database file"\n                            autocomplete="off"\n                            onfocus="this.removeAttribute('readonly');"\n                        ><br>\n                        <span class="input-error" id="name-input-error">\n                    </div>\n                    <div class="input-container">\n                        <label for="path-input">Parent Directory (Optional)</label><br>\n                        <input\n                            id="path-input"\n                            readonly type="text"\n                            placeholder="Path to Parent Directory"\n                            autocomplete="off"\n                            onfocus="this.removeAttribute('readonly');"\n                        ><br>\n                        <span class="input-error" id="path-input-error">\n                    </div>\n                    <div class="info-container">\n                        Database File Path: <span id="path-field"></span><br>\n                        Environment Variable:  <span id="env-var-field"></span>\n                    </div>\n                    <div class="button-container">\n                        <button class="button-medium button-secondary button-cancel">Cancel</button>\n                        <button class="button-medium button-primary button-continue" disabled>Continue</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,this.classAttr="new-sqlite-database-modal",this.sqliteReferencePaths=[],this.sqliteService=t,this.userSession=e,this.appService=n}async destroy(e){s.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),s.has(this.clickListener)&&document.removeEventListener("click",this.clickListener),await super.destroy(e)}async afterEveryRender(){await super.afterEveryRender(),this.findInScope(".close").addEventListener("click",()=>this.destroy(!0)),this.findInScope(".button-cancel").addEventListener("click",()=>this.destroy(!0)),this.findInScope(".modal").addEventListener("click",e=>e.stopPropagation()),this.continueButton=this.findInScope(".button-continue"),this.continueButton.addEventListener("click",async()=>{const e=await this.userSession.getActiveAppId(),t=this.envVarField.textContent,n=this.pathField.textContent;await this.appService.updateEnvironmentVariables({appId:e,name:t,value:n}),await this.sqliteService.createSQLiteDatabase({appId:e,path:n,name:this.nameInputElement.value}),this.destroy(!0)}),this.keyUpListener=e=>{"Enter"===e.key?this.continueButton.click():"Escape"===e.key&&this.destroy()},document.addEventListener("keyup",this.keyUpListener);const e=await this.userSession.getActiveAppId(),t=(await this.sqliteService.listSQLiteDatabaseReferences({appId:e})).getValue();this.sqliteReferencePaths=t.map(e=>e.path),this.pathField=this.findInScope("#path-field"),this.envVarField=this.findInScope("#env-var-field"),this.parentDirectoryInputElement=this.findInScope("#path-input"),this.parentDirectoryInputElement.oninput=this.updateTextFields.bind(this),this.nameInputElement=this.findInScope("#name-input"),this.nameInputElement.oninput=this.updateTextFields.bind(this),this.nameInputElement.select(),this.clickListener=e=>{e.stopPropagation(),this.destroy(!0)},document.addEventListener("click",this.clickListener)}updateTextFields(){const e=this.nameInputElement.value,t=this.parentDirectoryInputElement.value;this.pathField.textContent=""===t?e+".db":`${t}/${e}.db`,this.envVarField.textContent="SQLITE_"+e.toUpperCase(),this.updateContinueButton()}updateContinueButton(){this.checkName()&&this.checkPath()&&(this.nameInputElement.setCustomValidity(""),this.parentDirectoryInputElement.setCustomValidity(""),this.continueButton.disabled=o.isEmpty(this.nameInputElement.value))}checkName(){const e=this.findInScope("#name-input-error");if(this.nameInputElement.value.includes("/")){const t="/ is not a valid symbol";return this.nameInputElement.setCustomValidity(t),e.innerText=t,e.hidden=!1,this.continueButton.disabled=!0,!1}return e.innerText="",e.hidden=!0,!0}checkPath(){const e=this.findInScope("#path-input-error");if(this.sqliteReferencePaths.includes(this.pathField.textContent)){const t="You already have a database file at this location.";return this.parentDirectoryInputElement.setCustomValidity(t),e.innerText=t,e.hidden=!1,this.continueButton.disabled=!0,!1}return e.innerText="",e.hidden=!0,!0}}t.NewSQLiteDatabaseModal=r},680:function(e,t,n){"use strict";var i,s=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.OfflineBanner=void 0;const a=n(4),r=n(3),c=n(154);n(681);let l=class extends r.HtmlComponent{constructor(...e){super(),this.htmlContent="<p>You're offline. Trying to reconnect...</p>",this.classAttr="offline-banner hidden",this.connectionPromises=[],e.forEach(e=>e.onclose=()=>{this.show(),this.connectionPromises.push(e.resolveWhenConnected()),Promise.all(this.connectionPromises).then(this.hide.bind(this))})}};l=s([a.injectable(),o("design:paramtypes",["function"==typeof(i=void 0!==c.ReconnectingWebSocket&&c.ReconnectingWebSocket)?i:Object])],l),t.OfflineBanner=l},684:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileNode=void 0;const i=n(685),s=n(7),o=n(220);class a extends o.AbstractNode{constructor(e,t,n,o){var a;super(!1,e,o),this.invokeOnNextRenderQueue=[],this.setFileId(t),this.editorPanel=n,this.setIcon(null!==(a=s.fileIcons[i.fileEnding(this.path)])&&void 0!==a?a:s.fileIcons.file),this.htmlContent=`\n            <div class="entry" draggable="true">\n                <div class="icon"></div>\n                <span class="name">${this.name}</span>\n                <span class="description"></span>\n            </div>`}toggleSelect(e){if(!this.isRendered())return void this.invokeAfterNextRender(this.toggleSelect.bind(this));!this.isSelected()&&e&&this.openParentDirectories();const t=this.findInScope(".entry").classList;this.isSelected()?t.remove("selected"):t.add("selected")}async afterEveryRender(){await super.afterEveryRender();this.findInScope(".entry").style.paddingLeft=this.getIndentInPixels(),this.getRootElement().addEventListener("click",()=>{this.editorPanel.showInFileEditor(this.name,this.path)}),this.invokeOnNextRenderQueue.length>0&&(this.invokeOnNextRenderQueue.forEach(e=>e()),this.invokeOnNextRenderQueue=[])}invokeAfterNextRender(e){this.invokeOnNextRenderQueue.push(e)}isSelected(){return this.findInScope(".entry").classList.contains("selected")}}t.FileNode=a},688:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectoryNode=void 0;const i=n(0),s=n(70),o=n(122),a=n(689),r=n(7),c=n(6),l=n(220),d=n(48);class h extends l.AbstractNode{constructor(e,t,n,i=!1){super(!0,e,t),this.isRendered_=!1,this.children=[],this._isOpen=!1,this.htmlContent=`\n            <div class="entry folder" draggable="true">\n                <div class="toggle">${r.Icon.ExpandTree2}</div>\n                <div class="icon"></div>\n                <span class="name">${this.name}</span>\n                <span class="description"></span>\n            </div>\n            <div class="children-container"></div>\n        `,this._isOpen=i,this.ideService=n,this.classAttr=i?"tree-node":"tree-node collapsed"}getChildrenRecursively(){var e,t;return null!==(t=null===(e=this.children)||void 0===e?void 0:e.flatMap(e=>[e,...e.isDirectory()?e.getChildrenRecursively():[]]))&&void 0!==t?t:[]}insertChild(e){e.setParentDirectory(this);let t=!1;return this.children=a.sortedInsert(e,this.children,(n,i)=>n.isDirectory()&&i.isFile()||n.isDirectory()===i.isDirectory()&&n.name.toLowerCase()<i.name.toLowerCase()?(t=!0,this.isRendered()&&i.rendered().then(()=>e.renderTo(i,s.RenderLocation.Before)),-1):1),!t&&i.has(this.childrenContainer)&&e.renderTo(this.childrenContainer),this}unrefChild(e){return this.children.splice(this.children.indexOf(e)),this}open(){return this._isOpen=!0,this.renderOpenOrClosedState()}close(){return this._isOpen=!1,this.renderOpenOrClosedState()}isRendered(){return this.isRendered_}async destroy(){await super.destroy(),this.isRendered_=!1}unrefAllChildren(){return this.children=[],this}get isOpen(){return this._isOpen}async afterEveryRenderSync(){this.folderElement=this.findInScope(".folder"),this.folderElement.addEventListener("click",()=>this._isOpen?this.close():this.open()),this.folderElement.style.paddingLeft=this.getIndentInPixels(),this.renderOpenOrClosedState(),this.childrenContainer=this.findInScope(".children-container");for(const e of this.children)await e.renderTo(this.childrenContainer);this.isRendered_=!0,this.setUpDropZone(this.getRootElement())}renderOpenOrClosedState(){return this._isOpen?(this.isRendered()&&this.getRootElement().classList.remove("collapsed"),this.setIcon(h.openIcon)):(this.isRendered()&&this.getRootElement().classList.add("collapsed"),this.setIcon(h.closedIcon))}hasDroppableContent(e){return 1===e.items.length&&e.items[0].type===l.PATH_DATA_TRANSFER_TYPE}getFileNodePath(e){return new Promise(t=>{if(!this.hasDroppableContent(e))return t(null);e.items[0].getAsString(t)})}setUpDropZone(e){let t=null;e.addEventListener("dragenter",e=>{e.preventDefault(),i.has(e.dataTransfer)&&(e.dataTransfer.effectAllowed="copyMove")}),e.addEventListener("dragleave",()=>{e.classList.remove("drop"),t=null}),e.addEventListener("dragover",async n=>{i.has(n.dataTransfer)&&this.hasDroppableContent(n.dataTransfer)&&(n.preventDefault(),n.stopPropagation(),n.dataTransfer.dropEffect="move",e.classList.contains("drop")&&!this.isOpen&&i.has(t)&&n.timeStamp-t>h.THRESHOLD_TO_OPEN_PARENT_DIRECTORY?this.open():e.classList.contains("drop")||(e.classList.add("drop"),t=n.timeStamp))}),e.addEventListener("drop",async t=>{if(!e.classList.contains("drop")||!i.has(t.dataTransfer))return;t.preventDefault(),t.stopPropagation(),e.classList.remove("drop");const n=await this.getFileNodePath(t.dataTransfer);if(i.has(n)&&!this.path.startsWith(n)){const e=`${this.path}${this.path?"/":""}${o.fileName(n)}`;e!==n&&this.ideService.moveFile({appId:await c.UserSession.getInstance().getActiveAppId(),path:n,newPath:e}).then(d.alertIfError)}})}}t.DirectoryNode=h,h.openIcon=r.fileIcons["folder-open"],h.closedIcon=r.fileIcons.folder,h.THRESHOLD_TO_OPEN_PARENT_DIRECTORY=500},69:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InfrastructureComponent=void 0;const i=n(3),s=n(10);class o extends i.HtmlComponent{constructor(e,t,n){super(),this.router=e,this.routes=t,this.router.onUrlChange(()=>n.showInfrastructureComponent(this),s.path(this.getRoute()))}show(){super.show(),this.router.setUrl(this.getRoute(),!0)}hide(){super.hide(),this.router.setUrl(this.routes.default)}async destroy(e){this.router.setUrl(this.routes.default),await super.destroy(e)}}t.InfrastructureComponent=o},692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DomainsTable=void 0;const i=n(0),s=n(80),o=n(81);class a extends s.Table{constructor(){super("domains-table",'<th class="name-column">Name</th>','<th class="status-column">Status</th>','<th class="port-mapping">Destination Port</th>')}bindDomainInfoStream(e){e.onMessage(async e=>{this.hideLoadingAnimation(),this.removeAllTableRows();for(const t of e)this.appendDomainInfoRow(t)})}appendDomainInfoRow(e){this.appendTableRow(this.createTableRow(e))}onOpenDomainDetail(e){this.openDomainDetailListener=e}async afterEveryRenderSync(){await super.afterEveryRenderSync(),this.showLoadingAnimation()}createTableRow(e){const t=document.createElement("tr");t.className="domain-row";const n=document.createElement("td"),i=document.createElement("a");i.innerText=e.name,i.onclick=()=>this.openDomainDetail(e),n.appendChild(i),t.appendChild(n);const s=document.createElement("td");s.innerText=o.getDomainStatusString(e),t.appendChild(s);const a=document.createElement("td");return a.innerText="TCP 80",t.appendChild(a),t}openDomainDetail(e){i.has(this.openDomainDetailListener)&&this.openDomainDetailListener(e)}}t.DomainsTable=a},693:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomainDetailView=void 0;const c=n(4),l=n(3),d=n(0),h=n(28),p=n(6),u=n(7),m=n(5),f=n(81);n(694);let v=class extends l.HtmlComponent{constructor(e,t){super(),this.htmlContent=`\n        <div class="input-form">\n            <h1 class="domain-name-heading"></h1>\n            <div class="inner-container">\n                <div class="input-container">\n                    <label for="status-label">Status</label>\n                    <span id="status-label"></span>\n                </div>\n                <div class="input-container">\n                    <label>Domain</label>\n                    <a target="_blank" class="domain-name-link"></a>\n                </div>\n                <div class="input-container">\n                    <label>Destination port</label>\n                    <span class="destination-port-label">80</span>\n                </div>\n                <div class="input-container input-container-dns">\n                    <label for="dns-input-a">DNS</label>\n                    <input style="max-width:50rem" id="dns-input-a" type="text" readonly><br>\n                    <p>\n                        Add the above A record to your DNS configuration\n                    </p>\n                    <label for="dns-input-txt"></label>\n                    <input style="max-width:50rem" class="full-width" id="dns-input-txt" type="text" readonly><br>\n                    <p>\n                        To verify ownership of your domain,\n                        add the above key to a TXT record within your DNS configuration\n                    </p>\n                </div>\n                <div class="input-container">\n                    <label>Verification status</label>\n                    <button class="button button-verify verification-error">\n                        <span class="verification-result"></span>\n                        <div class="retry-div">\n                            ${u.Icon.Reload}\n                        </div>\n                    </button>\n                </div>\n                <div class="input-container">\n                    <label>Certificate</label>\n                    <div class="certificate-verification-container">\n                        <span class="certificate-status"></span>\n                        <div class="spinner"></div>\n                    </div><br>\n                    <p class="certificate-reason">\n                    </p>\n                </div>\n            </div>\n        </div>\n        <div class="button-row">\n            <div class="button-container">\n                <button class="button button-medium button-secondary" id="button-cancel">Cancel</button>\n            </div>\n            <div class="button-container">\n                <button class="button button-medium" id="button-delete">Delete</button>\n            </div>\n        </div>\n    `,this.classAttr="domain-detail-view",this.initialDomainInfoSet=!0,this.hide(),this.workspaceService=e,this.userSession=t}onDelete(e){this.onDeleteListener=e}onCancel(e){this.onCancelListener=e}setDomainInfo(e){this.domainInfo=e,this.setDomainVerificationStatus(e.domainVerificationStatus),this.findInScope(".domain-name-heading").innerText=e.name,this.findInScope("#status-label").innerText=f.getDomainStatusString(e);const t=this.findInScope(".domain-name-link");t.innerText=e.name,t.setAttribute("href","https://"+e.name),this.findInScope("#dns-input-a").value=e.dnsEntries.a=`${e.name} A ${e.dnsEntries.a}`,this.findInScope("#dns-input-txt").value=`codesphere-verification.${e.name} TXT ${e.dnsEntries.txt}`;const n=this.findInScope(".button-verify");n.onclick=async()=>{n.classList.remove("pulsate-success"),n.classList.remove("pulsate-error"),n.classList.add("verification-in-progress");const t=await this.workspaceService.verifyDomain({appId:await this.userSession.getActiveAppId(),domainName:e.name});if(t.notOk())throw new Error(t.getErrorMessage());this.setDomainVerificationStatus(t.getValue())},e.certificateRequestStatus.issued?(this.findInScope(".certificate-status").innerText="issued",this.findInScope(".certificate-reason").innerText="",this.findInScope(".certificate-verification-container .spinner").classList.add("hidden")):e.domainVerificationStatus.verified?(this.findInScope(".certificate-status").innerText="pending",this.findInScope(".certificate-reason").innerText=e.certificateRequestStatus.reason,this.findInScope(".certificate-verification-container .spinner").classList.remove("hidden")):(this.findInScope(".certificate-status").innerText="waiting for domain verification",this.findInScope(".certificate-verification-container .spinner").classList.add("hidden")),this.findInScope("#button-delete").onclick=()=>{d.has(this.onDeleteListener)&&this.onDeleteListener(this.domainInfo)},this.findInScope("#button-cancel").onclick=()=>{d.has(this.onCancelListener)&&this.onCancelListener()},this.initialDomainInfoSet=!1}setDomainVerificationStatus(e){const t=this.findInScope(".button-verify");t.classList.remove("verification-in-progress"),e.verified?(this.findInScope(".verification-result").innerText="verified",t.classList.remove("verification-error"),this.initialDomainInfoSet||t.classList.add("pulsate-success")):(this.findInScope(".verification-result").innerText=e.reason,t.classList.add("verification-error"),t.classList.add("pulsate-error"))}};v=o([c.injectable(),r(0,c.inject(m.injectableTypes.WorkspaceServiceStub)),r(1,c.inject(m.injectableTypes.UserSession)),a("design:paramtypes",["function"==typeof(i=void 0!==h.WorkspaceServiceStub&&h.WorkspaceServiceStub)?i:Object,"function"==typeof(s=void 0!==p.UserSession&&p.UserSession)?s:Object])],v),t.DomainDetailView=v},7:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getIconFromFileName=t.fileIcons=t.Icon=void 0;const r=n(55),c=a(n(360)),l=a(n(361)),d=a(n(362)),h=a(n(363)),p=a(n(364)),u=a(n(365)),m=a(n(366)),f=a(n(367)),v=a(n(368)),b=a(n(369)),y=a(n(370)),g=a(n(371)),S=a(n(372)),w=a(n(373)),C=a(n(374)),I=a(n(375)),T=a(n(376)),E=a(n(377)),R=a(n(378)),P=a(n(379)),j=a(n(380)),L=a(n(381)),M=a(n(382)),A=a(n(383)),k=a(n(384)),x=a(n(385)),_=a(n(386)),O=a(n(387)),D=a(n(388)),F=a(n(389)),U=a(n(390)),N=a(n(391)),H=a(n(392)),B=a(n(393)),V=a(n(394)),q=a(n(395)),z=a(n(396)),$=a(n(397)),Q=a(n(178)),W=a(n(178)),K=a(n(398)),G=a(n(399)),Y=a(n(400)),Z=a(n(401)),J=a(n(402)),X=a(n(403)),ee=a(n(404)),te=a(n(405)),ne=a(n(406)),ie=a(n(407));!function(e){e[e.HamburgerMenu=c.default]="HamburgerMenu",e[e.Search=l.default]="Search",e[e.Plus=h.default]="Plus",e[e.Close=p.default]="Close",e[e.Settings=u.default]="Settings",e[e.User=m.default]="User",e[e.Apps=f.default]="Apps",e[e.Signout=v.default]="Signout",e[e.Build=b.default]="Build",e[e.ExpandTree2=d.default]="ExpandTree2",e[e.Terminal=y.default]="Terminal",e[e.Minus=g.default]="Minus",e[e.Undo=S.default]="Undo",e[e.Redo=w.default]="Redo",e[e.Replace=C.default]="Replace",e[e.Format=I.default]="Format",e[e.More=T.default]="More",e[e.Delete=E.default]="Delete",e[e.Monitor=R.default]="Monitor",e[e.Share=P.default]="Share",e[e.Billing=j.default]="Billing",e[e.Invite=L.default]="Invite",e[e.Help=M.default]="Help",e[e.Copy=A.default]="Copy",e[e.Checkmark=x.default]="Checkmark",e[e.LeftArrow=_.default]="LeftArrow",e[e.ExternalLink=k.default]="ExternalLink",e[e.Reload=O.default]="Reload",e[e.Facebook=U.default]="Facebook",e[e.FacebookColored=N.default]="FacebookColored",e[e.Google=H.default]="Google",e[e.GoogleColored=B.default]="GoogleColored",e[e.GitHub=V.default]="GitHub",e[e.CodesphereOrbBig=q.default]="CodesphereOrbBig",e[e.Feedback=z.default]="Feedback",e[e.Domains=D.default]="Domains",e[e.Monitoring=F.default]="Monitoring",e[e.Key=K.default]="Key",e[e.Edit=G.default]="Edit",e[e.Eye=Y.default]="Eye",e[e.EyeOff=Z.default]="EyeOff",e[e.CodesphereLogo=X.default]="CodesphereLogo",e[e.CodesphereCircle=te.default]="CodesphereCircle",e[e.Database=J.default]="Database",e[e.NewFile=$.default]="NewFile",e[e.NewFolder=Q.default]="NewFolder",e[e.FolderOpen=W.default]="FolderOpen",e[e.Keybinding=ee.default]="Keybinding",e[e.Run=ne.default]="Run",e[e.Stop=ie.default]="Stop"}(t.Icon||(t.Icon={})),t.fileIcons={c:Promise.resolve().then(()=>o(n(408))),cabal:Promise.resolve().then(()=>o(n(409))),clojure:Promise.resolve().then(()=>o(n(410))),cmake:Promise.resolve().then(()=>o(n(411))),coffee:Promise.resolve().then(()=>o(n(412))),cpp:Promise.resolve().then(()=>o(n(413))),csharp:Promise.resolve().then(()=>o(n(414))),"css.map":Promise.resolve().then(()=>o(n(415))),css:Promise.resolve().then(()=>o(n(416))),dart:Promise.resolve().then(()=>o(n(417))),ts:Promise.resolve().then(()=>o(n(418))),db:Promise.resolve().then(()=>o(n(419))),Dockerfile:Promise.resolve().then(()=>o(n(420))),doc:Promise.resolve().then(()=>o(n(179))),docx:Promise.resolve().then(()=>o(n(179))),ejs:Promise.resolve().then(()=>o(n(421))),eslint:Promise.resolve().then(()=>o(n(422))),exe:Promise.resolve().then(()=>o(n(423))),ico:Promise.resolve().then(()=>o(n(424))),file:Promise.resolve().then(()=>o(n(425))),folder:Promise.resolve().then(()=>o(n(426))),"folder-open":Promise.resolve().then(()=>o(n(427))),ttf:Promise.resolve().then(()=>o(n(180))),woff:Promise.resolve().then(()=>o(n(180))),git:Promise.resolve().then(()=>o(n(428))),gitlab:Promise.resolve().then(()=>o(n(429))),gitpod:Promise.resolve().then(()=>o(n(430))),go:Promise.resolve().then(()=>o(n(431))),gradle:Promise.resolve().then(()=>o(n(432))),groovy:Promise.resolve().then(()=>o(n(433))),grunt:Promise.resolve().then(()=>o(n(434))),h:Promise.resolve().then(()=>o(n(435))),hack:Promise.resolve().then(()=>o(n(436))),haml:Promise.resolve().then(()=>o(n(437))),haskell:Promise.resolve().then(()=>o(n(438))),haxe:Promise.resolve().then(()=>o(n(439))),hcl:Promise.resolve().then(()=>o(n(440))),hcl_light:Promise.resolve().then(()=>o(n(441))),helm:Promise.resolve().then(()=>o(n(442))),heroku:Promise.resolve().then(()=>o(n(443))),hpp:Promise.resolve().then(()=>o(n(444))),html:Promise.resolve().then(()=>o(n(445))),ionic:Promise.resolve().then(()=>o(n(446))),java:Promise.resolve().then(()=>o(n(447))),"js.map":Promise.resolve().then(()=>o(n(448))),js:Promise.resolve().then(()=>o(n(449))),json:Promise.resolve().then(()=>o(n(450))),julia:Promise.resolve().then(()=>o(n(451))),jupyter:Promise.resolve().then(()=>o(n(452))),kotlin:Promise.resolve().then(()=>o(n(453))),laravel:Promise.resolve().then(()=>o(n(454))),less:Promise.resolve().then(()=>o(n(455))),lib:Promise.resolve().then(()=>o(n(456))),lisp:Promise.resolve().then(()=>o(n(457))),lock:Promise.resolve().then(()=>o(n(458))),log:Promise.resolve().then(()=>o(n(459))),lua:Promise.resolve().then(()=>o(n(460))),make:Promise.resolve().then(()=>o(n(461))),pdf:Promise.resolve().then(()=>o(n(462))),perl:Promise.resolve().then(()=>o(n(463))),php:Promise.resolve().then(()=>o(n(464))),ppt:Promise.resolve().then(()=>o(n(181))),pptx:Promise.resolve().then(()=>o(n(181))),pug:Promise.resolve().then(()=>o(n(465))),python:Promise.resolve().then(()=>o(n(182))),py:Promise.resolve().then(()=>o(n(182))),r:Promise.resolve().then(()=>o(n(466))),tsx:Promise.resolve().then(()=>o(n(183))),jsx:Promise.resolve().then(()=>o(n(183))),sass:Promise.resolve().then(()=>o(n(184))),scss:Promise.resolve().then(()=>o(n(184))),scala:Promise.resolve().then(()=>o(n(467))),scheme:Promise.resolve().then(()=>o(n(468))),settings:Promise.resolve().then(()=>o(n(469))),sketch:Promise.resolve().then(()=>o(n(470))),slim:Promise.resolve().then(()=>o(n(471))),sublime:Promise.resolve().then(()=>o(n(472))),svelte:Promise.resolve().then(()=>o(n(473))),svg:Promise.resolve().then(()=>o(n(474))),swift:Promise.resolve().then(()=>o(n(475))),table:Promise.resolve().then(()=>o(n(476))),uml:Promise.resolve().then(()=>o(n(477))),vercel:Promise.resolve().then(()=>o(n(478))),vue:Promise.resolve().then(()=>o(n(479))),wasm:Promise.resolve().then(()=>o(n(480))),word:Promise.resolve().then(()=>o(n(481))),xaml:Promise.resolve().then(()=>o(n(482))),xml:Promise.resolve().then(()=>o(n(483))),yaml:Promise.resolve().then(()=>o(n(484))),yang:Promise.resolve().then(()=>o(n(485))),zig:Promise.resolve().then(()=>o(n(486))),zip:Promise.resolve().then(()=>o(n(487)))},t.getIconFromFileName=function(e){var n;const i=r.last(e.split("."));return(null!==(n=t.fileIcons[i])&&void 0!==n?n:t.fileIcons.file).then(e=>e.default)}},700:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LiveMonitoringChart=void 0;const i=n(3),s=n(0),o=n(701),a=n(224),r=n(95),c=n(37),l=n(6),d=n(137);n(705),n(707);class h extends i.HtmlComponent{constructor(e,t,n){super(),this.chartElementId=`${t}-chart-${r.randomString()}`,this.htmlContent=`<div id="${this.chartElementId}" class="series-chart"></div>`,this.classAttr="live-time-series-chart",this.workspaceService=e,this.intervalBounds=n,this.resource=t,this.errorBanner=new p}async updateSeriesData(e){if(!s.has(this.chart))throw new Error("No Resource Chart instantiated.");this.errorBanner.hide(),this.intervalBounds=e;const t=await this.workspaceService.getAppResourceUtiliziation({appId:await l.UserSession.getInstance().getActiveAppId(),intervalStart:this.intervalBounds.start,intervalEnd:this.intervalBounds.end,resourceType:this.resource});if(t.notOk()){const e=t.getErrorMessage();return this.errorBanner.setErrorMessage(e),this.errorBanner.show(),void this.chart.hideWholeContentExceptTitle()}const n=u(m(t.getValue()));this.chart.updateSeries(n,this.intervalBounds.start*c.milliSecondsInASecond)}setZoomListener(e){return this.zoomListener=e,this}getChart(){if(!s.has(this.chart))throw new Error("Chart can only be retrieved if the element has been rendered.");return this.chart}async destroy(e){this.errorBanner.destroy(e),await super.destroy(e)}async afterEveryRenderSync(){await super.afterEveryRender(),await this.errorBanner.renderTo(this.getRootElement()),this.errorBanner.hide(),this.chart=new d.ResourceChart(this.chartElementId,this.resource),await this.updateSeriesData(this.intervalBounds),s.has(this.zoomListener)&&this.chart.setZoomEventHandler(this.zoomListener)}}t.LiveMonitoringChart=h;class p extends i.HtmlComponent{constructor(){super(),this.htmlContent='<div class="error-message"></div>',this.classAttr="error-banner"}setErrorMessage(e){this.isRendered()&&(this.findInScope(".error-message").innerHTML=e)}}const u=e=>o.fromEntries(a.mapEachProperty(e,(e,t)=>[e,t.map(e=>[1e3*e[0],e[1]])])),m=e=>o.fromEntries(a.mapEachProperty(e,(e,t)=>[e,t.map(e=>[e[0],parseFloat(e[1].toString())])]))},702:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MonitoringTooltip=void 0;const s=i(n(136)),o=n(0),a=n(135),r=n(703),c=n(137),l=n(225);t.MonitoringTooltip=class{constructor(e,t,n){const i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("table");o.innerText=s.default.dateFormat("%Y-%m-%d %H:%M:%S",c.adjustTimestampToTimezone(e)),o.className="resources-tooltip-header",i.className="resources-tooltip",i.appendChild(o),i.appendChild(a),i.appendChild(a),this.resource=t,this.tooltipElement=i,this.metricsTableElement=a,this.minTickInterval=n}addMetricEntry(e){if(!o.has(e.y))return;const t=document.createElement("tr"),n=document.createElement("td"),i=document.createElement("td"),s=document.createElement("span"),d=document.createElement("span");s.innerText="",s.classList.add("tooltip-color-"+e.colorIndex),s.classList.add("resource-tooltip-color-identifier"),d.innerText=e.series.name,n.appendChild(s),n.appendChild(d);let h="";h=l.RESOURCE_MAP[this.resource].format===l.UnitFormat.Bytes?a.formatBytes(e.y):c.formatPercentage(e.y,2,this.minTickInterval),i.innerText=h,i.className="resource-tooltip-metric-value",t.appendChild(n),t.appendChild(i),e.series.name===r.Metrics.Limit?this.metricsTableElement.prepend(t):this.metricsTableElement.appendChild(t)}serialize(){return this.tooltipElement.outerHTML}}},704:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.baseOptions=void 0;t.baseOptions={chart:{type:"line",zoomType:"x",marginLeft:65,styledMode:!0},xAxis:{type:"datetime",crosshair:{snap:!1}},boost:{enabled:!0},credits:{enabled:!1},series:[],time:{getTimezoneOffset:e=>new Date(e).getTimezoneOffset()}}},711:function(e,t,n){"use strict";var i,s,o=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariablesTable=void 0;const c=n(0),l=n(15),d=n(4),h=n(19),p=n(5),u=n(80),m=n(6),f=n(7);n(712);let v=class extends u.Table{constructor(e,t){super("table",'<th class="name-column">Name</th>','<th class="value-column">Value</th>'),this.tableRows={},this.newNameInputElement=null,this.appService=e,this.userSession=t,this.hintRow=this.createHintRow()}async createNewEnvVariable(){if(c.has(this.newNameInputElement))this.newNameInputElement.focus();else{const e=document.createElement("tr");this.editTableRow(e)}}async afterEveryRender(){await super.afterEveryRender();const e=this.appService.createEnvironmentVariablesUpdateStream();e.onMessage(this.applyUpdate.bind(this)),e.start({appId:await m.UserSession.getInstance().getActiveAppId()})}async createTableRow(e,t){e.innerHTML="";const n=document.createElement("td");n.innerText=t.name,e.appendChild(n);const i=document.createElement("td");i.innerText="*****",i.appendChild(this.createEyeIcon(e,i,t)),e.appendChild(i);const s=document.createElement("td");s.appendChild(this.createEditIcon(t));const o=document.createElement("td");o.appendChild(this.createDeleteIcon(e,t)),e.appendChild(s),e.appendChild(o)}createHintRow(){const e=document.createElement("tr"),t=document.createElement("td");return t.className="hint-row",t.colSpan=4,t.innerText="You can store environment variables here.",e.appendChild(t),e}async editTableRow(e,t){e.innerHTML="";const n=document.createElement("td"),i=document.createElement("input"),s=document.createElement("span");s.classList.add("input-error"),i.placeholder="Name",n.appendChild(i),n.appendChild(s);const o=document.createElement("td"),a=document.createElement("input");a.placeholder="Value",a.readOnly=!0,a.onfocus=()=>a.removeAttribute("readonly"),o.appendChild(a),c.has(t)?(i.value=t.name,a.value=t.value):(this.newNameInputElement=i,this.appendTableRow(e));const r=document.createElement("td"),d=this.createCheckmarkIcon(i,s,a,e,t);r.appendChild(d);const h=document.createElement("td"),p=this.createDeleteIcon(e,t);h.appendChild(p),this.addKeyupListener(p,d),e.appendChild(n),e.appendChild(o),e.appendChild(r),e.appendChild(h),l.isEmpty(i.value)?i.focus():a.focus()}revealValue(e,t,n){const i=e.childNodes[1].childNodes[0],s=i.textContent!==t.value;i.textContent=s?t.value:"*****",n.innerHTML=s?""+f.Icon.Eye:""+f.Icon.EyeOff}createEyeIcon(e,t,n){const i=document.createElement("span");return i.innerHTML=""+f.Icon.EyeOff,i.className="icons eye-icon",i.onclick=async()=>{this.revealValue(e,n,i)},e.onmouseleave=()=>{t.innerText===n.value&&i.click()},i}createEditIcon(e){const t=document.createElement("span");return t.innerHTML=""+f.Icon.Edit,t.className="icons edit-icon",t.onclick=async()=>{this.editTableRow(this.tableRows[e.name],e)},t}createCheckmarkIcon(e,t,n,i,s){const o=document.createElement("span");return o.innerHTML=""+f.Icon.Checkmark,o.className="icons",o.onclick=async()=>{c.has(s)&&s.name===e.value&&s.value===n.value?(await this.createTableRow(i,s),this.removeListener()):l.isEmpty(e.value)||l.isEmpty(n.value)?l.isEmpty(e.value)?e.focus():n.focus():!this.tableRows.hasOwnProperty(e.value)||c.has(s)&&s.name===e.value?(t.hidden=!0,i.style.height="null",c.has(s)&&s.name!==e.value&&this.appService.updateEnvironmentVariables({appId:await this.userSession.getActiveAppId(),name:s.name,value:""}),c.has(s)||(this.removeTableRow(i),this.newNameInputElement=null),this.appService.updateEnvironmentVariables({appId:await this.userSession.getActiveAppId(),name:e.value,value:n.value}),this.removeListener()):(e.focus(),i.style.height="6rem",t.innerText=`The name ${e.value} already exists.`,t.hidden=!1)},o}createDeleteIcon(e,t){const n=document.createElement("span");return n.innerHTML=""+f.Icon.Close,n.className="icons",n.onclick=async()=>{c.has(t)?this.appService.updateEnvironmentVariables({appId:await this.userSession.getActiveAppId(),name:t.name,value:""}):(this.newNameInputElement=null,this.removeTableRow(e)),this.removeListener()},n}removeListener(){c.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener)}addKeyupListener(e,t){this.keyUpListener=n=>{"Enter"===n.key&&(n.preventDefault(),t.click()),"Escape"===n.key&&(n.preventDefault(),e.click())},document.addEventListener("keyup",this.keyUpListener)}async applyUpdate(e){await Promise.all(e.map(async e=>{if(""!==e.value){const t=document.createElement("tr");this.removeTableRow(this.tableRows[e.name]),await this.createTableRow(t,e),this.tableRows[e.name]=t;const n=Object.keys(this.tableRows).sort().indexOf(e.name);this.appendTableRowAtIndex(this.tableRows[e.name],n)}else this.removeTableRow(this.tableRows[e.name]),delete this.tableRows[e.name]})),l.isEmpty(this.tableRows)?this.appendTableRow(this.hintRow):this.removeTableRow(this.hintRow)}};v=o([d.injectable(),r(0,d.inject(p.injectableTypes.AppServiceStub)),r(1,d.inject(p.injectableTypes.UserSession)),a("design:paramtypes",["function"==typeof(i=void 0!==h.AppServiceStub&&h.AppServiceStub)?i:Object,"function"==typeof(s=void 0!==m.UserSession&&m.UserSession)?s:Object])],v),t.EnvironmentVariablesTable=v},721:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileContentGroup=void 0;const s=i(n(51)),o=n(3),a=n(7);class r extends o.HtmlComponent{constructor(e,t){super(),this.collapsed=!1,this.fileName=s.default.basename(e),this.filePath=e,this.htmlContent=`\n        <div class="group-description">\n            <div class="arrow down"></div>\n            <div class="icon-file-type"></div>\n            <span class="file-path"> ${e}</span>\n            <div class="counter">${t}</div>\n        </div>\n        <div class="file-content-replies"></div>\n    `}isCollapsed(){return this.collapsed}collapse(){this.collapsed||(this.fileContentReplies.style.display="none",this.arrow.classList.remove("down"),this.arrow.classList.add("right"),this.collapsed=!0)}expand(){this.collapsed&&(this.fileContentReplies.style.display="block",this.arrow.classList.remove("right"),this.arrow.classList.add("down"),this.collapsed=!1)}async afterEveryRender(){await super.afterEveryRender(),this.fileContentReplies=this.findInScope(".file-content-replies"),this.arrow=this.findInScope(".arrow"),this.findInScope(".icon-file-type").innerHTML=await a.getIconFromFileName(this.fileName),this.getRootElement().addEventListener("click",()=>{"none"===this.fileContentReplies.style.display?this.expand():this.collapse()})}}t.FileContentGroup=r},722:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResult=void 0;const s=i(n(51)),o=n(3),a=n(723),r=n(7),c=n(6);class l extends o.HtmlComponent{constructor(e,t,n){super(),this.enterListener=e=>{"Enter"===e.key&&this.active&&this.openFile()},this.fileName=s.default.basename(e),this.filePath=e,this.editor=n,this.active=!1,this.searchString=t}static createFileContentSearchResult(e,t,n){return new h(e,t,n)}static createFileNameSearchResult(e,t,n){return new d(e,t,n)}destroy(e){return document.removeEventListener("keydown",this.enterListener),super.destroy(e)}setActive(e){e?(this.findInScope(".search-result").classList.add("selection"),this.findInScope(".search-result").scrollIntoView({block:"center",behavior:"auto"})):this.findInScope(".search-result").classList.remove("selection"),this.active=e}async afterEveryRender(){this.getRootElement().addEventListener("click",this.openFile.bind(this)),document.addEventListener("keydown",this.enterListener)}fillEmptySpans(e){const t=e.indexOf(this.searchString),[n,i]=this.findAllInScope(".wrapper");n.innerText=e.substring(0,t),i.innerText=e.substring(t+this.searchString.length),this.findInScope(".inline-search-query").innerText=this.searchString}openFile(){this.editor.showInFileEditor(this.fileName,this.filePath),c.UserSession.logActivity(a.openFileFromSearchModal(this.fileName,this.searchString)),this.parent.hide()}}t.SearchResult=l;class d extends l{constructor(e,t,n){super(e.substring(1),t,n),this.htmlContent='\n    <div class="search-result">\n        <div class="file-name-search-result">\n            <div class="icon-file-type"></div>\n            <div class="file-path">\n                <span class="wrapper"></span><span class="inline-search-query"></span><span class="wrapper"></span>\n            </div>\n        </div>\n    </div>'}async afterEveryRender(){super.afterEveryRender(),this.findInScope(".icon-file-type").innerHTML=await r.getIconFromFileName(this.fileName),this.fillEmptySpans(this.filePath)}}class h extends l{constructor(e,t,n){super(e.filePath,t,n),this.lineContent=e.lineContent,this.htmlContent=`\n    <div class="search-result">\n        <div class="file-content-search-result">\n        <p>\n            <span class="line-number">${e.lineNumber}</span>\n            <div class="line-content">\n                <span class="wrapper"></span><span class="inline-search-query"></span><span class="wrapper"></span>\n            </div>\n        </p>\n        </div>\n    </div>`}async afterEveryRender(){await super.afterEveryRender(),this.fillEmptySpans(this.lineContent)}}},735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Illustration=void 0,function(e){e.WebsiteHosting="/ide/assets/img/website-hosting.png",e.CloudDevelopment="/ide/assets/img/cloud-development.png",e.Infrastructure="/ide/assets/img/infrastructure.png"}(t.Illustration||(t.Illustration={}))},747:function(e,t,n){"use strict";var i,s,o,a,r,c,l,d,h,p,u,m,f,v,b,y=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},g=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},S=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MainLayout=void 0;const w=n(4),C=n(3),I=n(10),T=n(0),E=n(16),R=n(5),P=n(197),j=n(56),L=n(20),M=n(232),A=n(140),k=n(230),x=n(233),_=n(11),O=n(6),D=n(139),F=n(79),U=n(120),N=n(123),H=n(134),B=n(217),V=n(125),q=n(49),z=n(748),$=n(218),Q=n(190),W=n(216);let K=class extends C.HtmlComponent{constructor(e,t,n,i,s,o,a,r,c,l,d,h,p,u,m){super(),this.classAttr="main-content",this.navigator=e,this.terminalPanel=t,this.editorPanel=n,this.mainMenu=i,this.userProfileComponent=s,this.hoveringMenu=o,this.emailConfirmationModal=a,this.ideService=d,this.router=h,this.routes=p,this.confirmEmailModal=r,this.confirmEmailModal=r,this.updateEmailConfirmationModal=c,this.passwordResetModal=l,this.userSession=u,this.codeSearchModal=m}async destroy(){T.has(this.keyDownListener)&&document.removeEventListener("keydown",this.keyDownListener),await super.destroy()}async afterEveryRender(){await super.afterEveryRender(),await this.renderSplitPanel(),await this.renderHoveringMenu(),await this.renderModals(),this.userSession.getAuthentication().then(()=>{this.createAndStartUserPreferencesStream(),this.disableControlS(),this.initializeKeydownListener()}),await this.mainMenu.renderTo(this.getRootElement()),this.router.enqueueCurrentRoute()}initializeKeydownListener(){this.keyDownListener=e=>{this.isVisible()&&(e.ctrlKey&&"m"===e.key?this.openNewFileModal():e.ctrlKey&&"b"===e.key?this.openNewDirectoryModal():e.ctrlKey&&e.shiftKey&&"K"===e.key?this.openKeybindingModal():e.ctrlKey&&e.shiftKey&&"H"===e.key?this.openHelpModal():e.ctrlKey&&e.shiftKey&&"S"===e.key&&this.editorPanel.showSettings())},document.addEventListener("keydown",this.keyDownListener)}disableControlS(){window.addEventListener("keydown",e=>{var t;e.ctrlKey&&"s"===e.key&&(e.preventDefault(),null===(t=this.controlSBanner)||void 0===t||t.show(),setTimeout(()=>{var e;return null===(e=this.controlSBanner)||void 0===e?void 0:e.hide()},2e3))})}closeCurrentModal(){const e=document.querySelector(".keybindable"),t=document.querySelector(".search-everywhere-modal");T.has(e)?e.remove():T.has(t)&&t.classList.add("hidden")}isMainMenuVisible(){return this.mainMenu.isVisible()}openNewFileModal(){this.isMainMenuVisible()||(this.closeCurrentModal(),F.showModal(new U.CreateFileModal(this.ideService,"")))}openNewDirectoryModal(){this.isMainMenuVisible()||(this.closeCurrentModal(),F.showModal(new N.CreateDirectoryModal(this.ideService,"")))}openKeybindingModal(){this.isMainMenuVisible()||(this.closeCurrentModal(),F.showModal(new H.KeybindingModal))}openHelpModal(){this.isMainMenuVisible()||(this.closeCurrentModal(),F.showModal(new B.HelpModal))}createAndStartUserPreferencesStream(){const e=this.ideService.createUserPreferencesStream();e.onMessage(async e=>{P.applyTheme(e.theme)}),e.send("start")}async renderModals(){this.controlSBanner=new z.ControlSBanner,await this.controlSBanner.renderTo(this.getRootElement()),await this.emailConfirmationModal.renderTo(this.getRootElement()),await this.confirmEmailModal.renderTo(this.getRootElement()),await this.updateEmailConfirmationModal.renderTo(this.getRootElement()),await this.codeSearchModal.renderTo(this.getRootElement()),this.router.onUrlChange(async()=>{this.passwordResetModal.setRequestId(location.hash.substring(1)),await this.passwordResetModal.renderTo(this.getRootElement())},I.path(this.routes.resetPassword))}async renderHoveringMenu(){this.hoveringMenu.onShowApps(()=>this.mainMenu.navigateToApps()),this.hoveringMenu.onShowProfile(()=>this.mainMenu.navigateToProfile()),this.hoveringMenu.onShowBilling(()=>this.mainMenu.showBilling()),this.userProfileComponent.onProfileUpdated(()=>this.hoveringMenu.syncAvatar()),await this.hoveringMenu.renderTo(this.getRootElement())}async renderSplitPanel(){await new Q.SplitPanel(this.navigator,new Q.SplitPanel(this.editorPanel,this.terminalPanel,"vertical",75),"horizontal",15).renderTo(this.getRootElement())}};K=y([w.injectable(),S(0,w.inject(R.injectableTypes.NavigatorComponent)),S(1,w.inject(R.injectableTypes.TerminalPanel)),S(2,w.inject(R.injectableTypes.EditorPanel)),S(3,w.inject(R.injectableTypes.MainMenu)),S(4,w.inject(R.injectableTypes.UserProfileComponent)),S(5,w.inject(R.injectableTypes.HoveringMenu)),S(6,w.inject(R.injectableTypes.EmailConfirmationModal)),S(7,w.inject(R.injectableTypes.ConfirmEmailModal)),S(8,w.inject(R.injectableTypes.UpdateEmailConfirmationModal)),S(9,w.inject(R.injectableTypes.PerformPasswordResetModal)),S(10,w.inject(R.injectableTypes.IdeServiceStub)),S(11,w.inject(R.injectableTypes.Router)),S(12,w.inject(R.injectableTypes.Routes)),S(13,w.inject(R.injectableTypes.UserSession)),S(14,w.inject(R.injectableTypes.CodeSearchModal)),g("design:paramtypes",["function"==typeof(i=void 0!==$.NavigatorComponent&&$.NavigatorComponent)?i:Object,"function"==typeof(s=void 0!==j.TerminalPanel&&j.TerminalPanel)?s:Object,"function"==typeof(o=void 0!==L.EditorPanel&&L.EditorPanel)?o:Object,"function"==typeof(a=void 0!==q.MainMenu&&q.MainMenu)?a:Object,"function"==typeof(r=void 0!==V.UserProfileComponent&&V.UserProfileComponent)?r:Object,"function"==typeof(c=void 0!==W.HoveringMenu&&W.HoveringMenu)?c:Object,"function"==typeof(l=void 0!==M.EmailConfirmationModal&&M.EmailConfirmationModal)?l:Object,"function"==typeof(d=void 0!==A.ConfirmEmailModal&&A.ConfirmEmailModal)?d:Object,"function"==typeof(h=void 0!==k.UpdateEmailConfirmationModal&&k.UpdateEmailConfirmationModal)?h:Object,"function"==typeof(p=void 0!==x.PerformPasswordResetModal&&x.PerformPasswordResetModal)?p:Object,"function"==typeof(u=void 0!==E.IdeServiceStub&&E.IdeServiceStub)?u:Object,"function"==typeof(m=void 0!==I.Router&&I.Router)?m:Object,"function"==typeof(f=void 0!==_.Routes&&_.Routes)?f:Object,"function"==typeof(v=void 0!==O.UserSession&&O.UserSession)?v:Object,"function"==typeof(b=void 0!==D.CodeSearchModal&&D.CodeSearchModal)?b:Object])],K),t.MainLayout=K},748:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlSBanner=void 0;const o=n(4),a=n(3);n(749);let r=class extends a.HtmlComponent{constructor(){super(),this.htmlContent="<p>Codesphere saves automatically</p>",this.classAttr="ctrls-banner hidden",window.addEventListener("keypress",e=>!(115==e.which&&e.ctrlKey||19==e.which)||(this.show(),setTimeout(()=>this.hide(),2e3),e.preventDefault(),!1))}};r=i([o.injectable(),s("design:paramtypes",[])],r),t.ControlSBanner=r},751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enableGoogleAnalytics=void 0,t.enableGoogleAnalytics=()=>{window["ga-disable-"+GA_ID]=!1}},79:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showModal=void 0,t.showModal=async e=>{setTimeout(()=>e.renderTo(".main-content"),0)}},80:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Table=void 0;const i=n(3),s=n(0),o=n(130);n(586);class a extends i.HtmlComponent{constructor(e,...t){super(),this.htmlContent=`\n            <table>\n                <thead>\n                    <tr>\n                        ${t.join("\n")}\n                    </tr>\n                </thead>\n                <tbody class="table-body"></tbody>\n            </table>\n        `,this.classAttr="codesphere-table "+(s.has(e)?e:"")}showLoadingAnimation(){if(this.findAllInScope("#loading-animation-row").length>0)return;const e=this.findInScope(".table-body"),t=document.createElement("div");t.className="loading-animation",t.innerHTML=""+o.Animation.Ripple;const n=document.createElement("td");n.id="loading-animation-row",n.colSpan=4,n.appendChild(t),e.appendChild(n)}hideLoadingAnimation(){const e=this.findAllInScope("#loading-animation-row");if(0===e.length)return;this.findInScope(".table-body").removeChild(e[0])}prependTableRow(e){const t=this.findInScope(".table-body");t.insertBefore(e,t.firstChild)}appendTableRow(e){this.findInScope(".table-body").appendChild(e)}appendTableRowAtIndex(e,t){const n=this.findInScope(".table-body");n.insertBefore(e,n.children[t])}removeTableRow(e){const t=this.findInScope(".table-body");t.contains(e)&&t.removeChild(e)}removeAllTableRows(){this.findInScope(".table-body").innerHTML=""}}t.Table=a},81:function(e,t,n){"use strict";var i,s,o,a,r,c=this&&this.__decorate||function(e,t,n,i){var s,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainStatusString=t.DomainInfrastructureComponent=void 0;const h=n(4),p=n(0),u=n(97),m=n(12),f=n(10),v=n(28),b=n(11),y=n(5),g=n(6),S=n(69),w=n(20),C=n(7),I=n(692),T=n(693);n(696);let E=class extends S.InfrastructureComponent{constructor(e,t,n,i,s){super(e,t,s),this.htmlContent='\n        <div class="top-row">\n            <h1>\n                <span class="title">Domains</span>\n                <span class="separator hidden">/</span>\n                <span class="second-path-item hidden"></span>\n            </h1>\n            <div class="button-container">\n                <button class="button-medium button-light" id="new-domain-button">\n                    New domain +\n                </button>\n            </div>\n        </div>\n        <div class="table"></div>\n        <div class="creation-form hidden">\n            <div class="input-form">\n                <h1>Enter Details</h1>\n                <div class="inner-container">\n                    <div class="input-container">\n                        <label for="domain-name">Domain name</label><br>\n                        <input id="domain-name" placeholder="www.example.com" type="text"><br>\n                        <span class="input-error" id="domain-name-input-error">\n                        </span>\n                    </div>\n                    <div class="button-container">\n                        <button class="button-medium button-secondary" id="button-cancel">Cancel</button>\n                        <button class="button-medium button-primary" id="button-continue" disabled="">\n                            Continue\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="domain-detail"></div>\n    ',this.classAttr="domain-infrastructure-component",this.latestDomainInfos=[],this.workspaceService=n,this.userSession=i}async destroy(e){var t;p.has(this.keyUpListener)&&document.removeEventListener("keyup",this.keyUpListener),null===(t=this.domainInfoStream)||void 0===t||t.complete(m.okReply()),await super.destroy(e)}getRoute(){return this.routes.infrastructureDomains}getName(){return"Domains"}getIcon(){return C.Icon.Domains}async afterEveryRender(){await super.afterEveryRender(),this.domainsTable=await(new I.DomainsTable).renderTo(this.findInScope(".table")),this.domainsTable.onOpenDomainDetail(async e=>this.showDomainDetails(e)),this.domainDetailView=await new T.DomainDetailView(this.workspaceService,this.userSession).renderTo(this.findInScope(".domain-detail")),this.domainDetailView.onDelete(async e=>{await this.workspaceService.deleteDomain({appId:await this.userSession.getActiveAppId(),domainName:e.name}),this.showTable()}),this.domainDetailView.onCancel(()=>this.showTable());const e=this.userSession.getActiveAppIdIfSet();p.has(e)&&(this.domainInfoStream=this.workspaceService.createDomainInfoStream(),this.bindDomainInfoStream(),this.domainInfoStream.start({appId:e})),this.userSession.onActiveAppIdChange(e=>{p.has(this.domainInfoStream)&&this.domainInfoStream.complete(m.okReply()),p.has(e)&&(this.domainInfoStream=this.workspaceService.createDomainInfoStream(),this.bindDomainInfoStream(),this.domainInfoStream.start({appId:e}))}),this.findInScope(".title").onclick=()=>this.showTable(),this.findInScope("#new-domain-button").addEventListener("click",()=>{this.findInScope(".top-row .separator").classList.remove("hidden");const e=this.findInScope(".top-row .second-path-item");e.classList.remove("hidden"),e.innerText="New",this.findInScope(".top-row .button-container").classList.add("hidden"),this.findInScope(".table").classList.add("hidden"),this.findInScope(".creation-form").classList.remove("hidden"),t.focus()}),this.findInScope(".creation-form #button-cancel").addEventListener("click",()=>{this.showTable()});const t=this.findInScope("#domain-name");t.oninput=async()=>{const e=t.value;if(e.length>0){const i=!this.latestDomainInfos.some(t=>u.equal(t.name,e)),s=this.findInScope("#domain-name-input-error");if(!i){const i=`The domain ${e} already exists.`;return t.setCustomValidity(i),s.innerText=i,s.hidden=!1,void(n.disabled=!0)}t.setCustomValidity(""),s.innerText="",s.hidden=!0}n.disabled=0===e.length};const n=this.findInScope("#button-continue");n.onclick=async()=>{var e;await this.workspaceService.createDomain({appId:await this.userSession.getActiveAppId(),domainName:t.value}),null===(e=this.domainsTable)||void 0===e||e.appendDomainInfoRow({appId:await this.userSession.getActiveAppId(),name:t.value,certificateRequestStatus:{issued:!1,reason:"Status unkown"},dnsEntries:{a:"loading...",txt:"loading..."},domainVerificationStatus:{verified:!1,reason:"loading..."}}),this.showTable(),t.value=""},this.keyUpListener=e=>{this.isVisible()&&"Enter"===e.key&&(n.disabled||(e.preventDefault(),n.click()))},document.addEventListener("keyup",this.keyUpListener)}showTable(){this.findInScope(".top-row .separator").classList.add("hidden"),this.findInScope(".top-row .second-path-item").classList.add("hidden"),this.findInScope(".top-row .button-container").classList.remove("hidden"),this.findInScope(".table").classList.remove("hidden"),this.findInScope(".creation-form").classList.add("hidden"),this.domainDetailView.hide(),this.activeDetailViewDomainName=void 0}showDomainDetails(e){this.findInScope(".top-row .separator").classList.remove("hidden");const t=this.findInScope(".top-row .second-path-item");t.classList.remove("hidden"),t.innerText=e.name,this.findInScope(".top-row .button-container").classList.add("hidden"),this.findInScope(".table").classList.add("hidden"),this.findInScope(".creation-form").classList.add("hidden"),this.domainDetailView.setDomainInfo(e),this.domainDetailView.show(),this.activeDetailViewDomainName=e.name}bindDomainInfoStream(){this.domainsTable.bindDomainInfoStream(this.domainInfoStream),this.domainInfoStream.onMessage(async e=>{var t;if(this.latestDomainInfos=e,p.has(this.activeDetailViewDomainName)){const n=e.find(e=>u.equal(e.name,this.activeDetailViewDomainName));p.has(n)&&(null===(t=this.domainDetailView)||void 0===t||t.setDomainInfo(n))}})}};E=c([h.injectable(),d(0,h.inject(y.injectableTypes.Router)),d(1,h.inject(y.injectableTypes.Routes)),d(2,h.inject(y.injectableTypes.WorkspaceServiceStub)),d(3,h.inject(y.injectableTypes.UserSession)),d(4,h.inject(y.injectableTypes.EditorPanel)),l("design:paramtypes",["function"==typeof(i=void 0!==f.Router&&f.Router)?i:Object,"function"==typeof(s=void 0!==b.Routes&&b.Routes)?s:Object,"function"==typeof(o=void 0!==v.WorkspaceServiceStub&&v.WorkspaceServiceStub)?o:Object,"function"==typeof(a=void 0!==g.UserSession&&g.UserSession)?a:Object,"function"==typeof(r=void 0!==w.EditorPanel&&w.EditorPanel)?r:Object])],E),t.DomainInfrastructureComponent=E,t.getDomainStatusString=e=>e.domainVerificationStatus.verified?e.certificateRequestStatus.issued?"ready":"certificate pending":"unverified"},96:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TabBarButton=t.TabLayout=void 0;const s=n(3),o=n(0),a=n(15),r=n(97),c=n(65),l=i(n(765)),d=n(91),h=n(7);n(488);class p extends s.HtmlComponent{constructor(e,t,n=!1,i,s=!0,a){super(),this.renderedComponents=[],this.classAttr="tab-layout",this.tabs={},this.sequential=new d.Sequential(1),this.tabChangeListeners=[],this.htmlContent=`\n<div class="bar">\n    <div class="tabs ${n?"hidden":""}"></div>\n    ${o.has(t)?`\n        <div class="plus">\n            ${h.Icon.Plus}\n        </div>\n    `:""}\n</div>\n<div class="content">\n    <div class="empty-space-hint"></div>\n</div>\n`,this.tabGenerator=t,this.hideSingleTab=n,this.emptySpaceHint=i,this.enableScrolling=s,this.firstVisibleTabName=a,e.map(e=>this.newTabReference(e)).forEach(e=>this.tabs[e.id]=e)}async destroy(e){o.has(this.keyDownListener)&&document.removeEventListener("keydown",this.keyDownListener),await super.destroy()}addTabChangeListener(e){this.tabChangeListeners.push(e)}getSelectedTab(){const e=this.renderedComponents.find(e=>e.tab.component.isVisible());if(o.has(e))return e}async showTabByName(e){const t=c.values(this.tabs).find(t=>t.name===e);return!!o.has(t)&&(await this.showTab(t),!0)}async afterEveryRenderSync(){await super.afterEveryRenderSync(),o.has(this.emptySpaceHint)&&await this.emptySpaceHint.renderTo(this.findInScope(".empty-space-hint")),this.enableScrolling&&l.default.init(this.findInScope(".content"));for(const e of c.values(this.tabs))await this.internalAddTab(e,!1);o.has(this.firstVisibleTabName)&&await this.showTabByName(this.firstVisibleTabName),o.has(this.tabGenerator)&&this.findInScope(".plus").addEventListener("click",async()=>{if(o.has(this.tabGenerator)){const e=await this.tabGenerator();o.has(e)&&await this.internalAddTab(this.newTabReference(e),!0)}}),this.keyDownListener=e=>{this.isVisible()&&(e.ctrlKey&&"q"===e.key?this.closeSelectedTab():e.ctrlKey&&"ArrowLeft"===e.key?this.switchToLeftTab():e.ctrlKey&&"ArrowRight"===e.key&&this.switchToRightTab())},document.addEventListener("keydown",this.keyDownListener)}async addTab(e,t){this.removeUnwantedElements(e);const n=this.newTabReference(e);return await this.internalAddTab(n,t),n}closeAllTabs(){this.renderedComponents.forEach(e=>this.closeTab(e))}async closeTab({tab:e,tabBarButton:t}){await e.component.destroy();const n=t.hasClass("selected");if(t.destroy(!0).then(()=>this.updateTabButtonVisibility()),this.renderedComponents=this.renderedComponents.filter(n=>!r.equal(n,{tab:e,tabBarButton:t})),this.renderedComponents.length>0&&n){const{tab:e,tabBarButton:t}=this.renderedComponents[this.renderedComponents.length-1];t.addClass("selected"),e.component.show()}delete this.tabs[e.id],this.tabChangeListeners.forEach(e=>e(c.values(this.tabs))),this.isEmpty()&&this.findInScope(".empty-space-hint").classList.remove("hidden")}isEmpty(){return 0===this.renderedComponents.length}async showTab(e){this.removeUnwantedElements(e);const t=this.renderedComponents.find(t=>t.tab.id===e.id).tabBarButton;this.renderedComponents.forEach(({tab:e,tabBarButton:t})=>{e.component.hide(),t.removeClass("selected")}),t.addClass("selected"),e.component.show()}removeUnwantedElements(e){var t;"infrastructure-menu"!==e.component.classAttr&&"file-tree"!==e.component.classAttr&&(null===(t=document.querySelector(".editor-tooltip"))||void 0===t||t.remove())}newTabReference(e){return Object.assign({id:this.sequential.next()},e)}isEditorTab(e){return!["infrastructure-menu","file-tree","terminal"].includes(e.tab.component.classAttr)}closeSelectedTab(){const e=this.getSelectedTab();o.has(e)&&this.isEditorTab(e)&&this.closeTab(e)}switchToLeftTab(){const e=this.getSelectedTab();if(!o.has(e)||!this.isEditorTab(e))return;const t=Object.keys(this.tabs),n=t.indexOf(e.tab.id.toString()),i=t[n-1];t.includes(i)&&this.showTab(this.tabs[parseInt(i)])}switchToRightTab(){const e=this.getSelectedTab();if(!o.has(e)||!this.isEditorTab(e))return;const t=Object.keys(this.tabs),n=t.indexOf(e.tab.id.toString()),i=t[n+1];t.includes(i)&&this.showTab(this.tabs[parseInt(i)])}async internalAddTab(e,t){this.findInScope(".empty-space-hint").classList.add("hidden");const n=await new u(e.name,t).renderTo(this.findInScope(".tabs"));let i;n.onSelect(()=>{this.showTab(e)}),n.onClose(()=>{this.closeTab({tab:e,tabBarButton:n})}),i=this.enableScrolling?".content .scroll-content":".content",await e.component.renderTo(this.findInScope(i)),e.component.hide(),t?(this.renderedComponents.forEach(({tab:e,tabBarButton:t})=>{t.removeClass("selected"),e.component.hide()}),n.addClass("selected"),e.component.show()):o.has(this.firstVisibleTabName)||a.isEmpty(this.renderedComponents)&&(n.addClass("selected"),e.component.show()),this.renderedComponents.push({tab:e,tabBarButton:n}),await this.updateTabButtonVisibility(),o.has(this.tabs[e.id])||(this.tabs[e.id]=e,this.tabChangeListeners.forEach(e=>e(c.values(this.tabs))))}async updateTabButtonVisibility(){this.hideSingleTab&&(a.isEmpty(this.renderedComponents)||1===this.renderedComponents.length)?this.findInScope(".tabs").classList.add("hidden"):this.findInScope(".tabs").classList.remove("hidden")}}t.TabLayout=p;class u extends s.HtmlComponent{constructor(e,t){super(),this.htmlContent=`\n            <span class="name">${e}</span>\n            ${t?`\n                <div class='close'>\n                    ${h.Icon.Close}\n                </div>\n            `:""}\n        `,this.classAttr="tab-button "+(t?"closable-tab-button":"permanent-tab-button"),this.closable=t}hasClass(e){return this.getRootElement().classList.contains(e)}addClass(e){this.getRootElement().classList.add(e)}removeClass(e){this.getRootElement().classList.remove(e)}onSelect(e){this.getRootElement().addEventListener("click",e)}onClose(e){this.closable&&this.findInScope(".close").addEventListener("click",t=>{t.stopPropagation(),e()})}rename(e){this.findInScope(".name").innerHTML=e}}t.TabBarButton=u}});
//# sourceMappingURL=cacheme-main-5f1bef502613fc6a52ef.js.map